 AS V1.42 Beta [Bld 246] - Source File emuz80mon_RevB05.asm - Page 1 - 9/2/2023 2:46:31


       1/       0 :                     	page	0
       2/       0 :                     	cpu	z80
       3/       0 :                     ;;; 
       4/       0 :                     ;;; Universal Monitor for Zilog Z80
       5/       0 :                     ;;;   Copyright (C) 2019,2020,2021 Haruo Asano
       6/       0 :                     ;;;
       7/       0 :                     
       8/       0 :                     ;;; 2022.10.10 It was added functions by A.honda
       9/       0 :                     ;;; Rev.B01	add trace command
      10/       0 :                     ;;; Rev.B02	add disassemble commnand
      11/       0 :                     ;;; Rev.B03	add assemble command and PaloAltoTinyBASIC
      12/       0 :                     ;;;                and GAME80 interpreter and GAME80 compiler
      13/       0 :                     ;;; Rev.B03_1	The monitor corresponded to the SuperMEZ80
      14/       0 :                     ;;; Rev.B04	The monitor corresponded to UART XON/XOFF
      15/       0 :                     ;;; Rev.B05	add VTL
      16/       0 :                     
      17/       0 :                     
      18/       0 :                     ;;; Constants
      19/       0 : =0DH                CR	EQU	0DH
      20/       0 : =0AH                LF	EQU	0AH
      21/       0 : =8H                 BS	EQU	08H
      22/       0 : =7FH                DEL	EQU	7FH
      23/       0 : =1BH                ESC	equ	1BH
      24/       0 : =28H                BUFLEN	equ	40
      25/       0 : =7H                 NUMLEN	equ	7
      26/       0 : =8H                 F_bitSize	equ	8
      27/       0 : =4H                 NO_UPPER	equ	00000100b
      28/       0 : =2H                 NO_LF		equ	00000010b
      29/       0 : =1H                 NO_CR		equ	00000001b
      30/       0 :                     
      31/       0 :                     
      32/       0 :                     ;;;
      33/       0 :                     ;;; Memory switch
      34/       0 :                     ;;;
      35/       0 :                     
      36/       0 : =0H                 SuperMEZ80 = 0
      37/       0 : =0H                 SMEZ80Full = 0
      38/       0 : =1H                 RAM12K = 1
      39/       0 : =0H                 RAM8K = 0
      40/       0 : =1H                 BACKDOOR = 1
      41/       0 :                     
      42/       0 : =>FALSE             	IF	SuperMEZ80
      43/       0 :                     UARTDR	EQU	00H	; UART DATA I/O REGISTOR
      44/       0 :                     UARTCR	EQU	01H	; UART CONTROL I/O REGISTOR
      45/       0 :                     WORK_B	equ	0FF00H	; work area EF00-EFFF
      46/       0 :                     STACKM	equ	0FF00H	; monitor stack
      47/       0 :                     STACK	equ	0FEC0H	; user stack
      48/       0 :                     ROM_B	equ	0000H	; program base address
      49/       0 :                     RAM_E	equ	0FFFFH	; RAM END address
      50/       0 :                     ENTRY	EQU	0040H		; Entry point
      51/       0 :                     
      52/       0 :                     	IF SMEZ80Full = 0
      53/       0 :                     RAM_B		equ	ENTRY	; work area base address
      54/       0 :                     MON_SEG		equ	0d000h
      55/       0 :                     SV_ROM		equ	60h	; SAVE addiress for monitor code at POWER ON
      56/       0 :                     	ELSE
      57/       0 :                     RAM_B	equ	8000H	;EMUZ80_Q84 RAM base address
      58/       0 : [52]                	ENDIF
      59/       0 :                     
      60/       0 : [42]                	ENDIF
      61/       0 :                     
      62/       0 : =>TRUE              	IF	RAM12K
      63/       0 :                     ;; ROM48K RAM12K for PIC18F47Q84
      64/       0 : =0FF00H             UARTDR	EQU	0FF00H	; UART DATA REGISTOR
      65/       0 : =0FF01H             UARTCR	EQU	0FF01H	; UART CONTROL REGISTOR
      66/       0 : =0EF00H             WORK_B	equ	0EF00H	; work area EF00-EFFF
      67/       0 : =0EF00H             STACKM	equ	0EF00H	; monitor stack
      68/       0 : =0EEC0H             STACK	equ	0EEC0H	; user stack
      69/       0 : =0H                 ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      70/       0 : =0C000H             RAM_B	equ	0C000H	;EMUZ80_Q84 RAM base address
      71/       0 : =0EFFFH             RAM_E	equ	0EFFFH	;EMUZ80_Q84 RAM END address
      72/       0 : =0F000H             IO_B	equ	0F000H	;EMUZ80_Q84 I/O base address
      73/       0 : =40H                ENTRY	EQU	0040H		; Entry point
      74/       0 :                     
      75/       0 : =0F800H             TIM0_CTL0	equ	0F800H	; timer0 control0 register
      76/       0 : =0F801H             TIM0_CTL1	equ	0F801H	; timer0 control1 register
      77/       0 : =0F810H             TIMER0_CNTL	equ	0F810H	; timer0 16bit counter LSB
      78/       0 : =0F811H             TIMER0_CNTH	equ	0F811H	; timer0 16bit counter MSB
      79/       0 : =0F820H             TIMER0_SCTL	equ	0F820H	; timer0 seconds counter LSB
      80/       0 : =0F821H             TIMER0_SCTH	equ	0F821H	; timer0 seconds counter MSB
      81/       0 : =87E1H              TIMER0_INITC	equ	87e1h	; timer adjust count number
      82/       0 : [62]                	ENDIF
      83/       0 :                     
      84/       0 : =>FALSE             	IF	RAM8K
      85/       0 :                     ; ORIGINAL MEMORY MAP for PIC18F47Q84
      86/       0 :                     UARTDR	EQU	0E000H	; UART DATA REGISTOR
      87/       0 :                     UARTCR	EQU	0E001H	; UART CONTROL REGISTOR
      88/       0 :                     WORK_B	equ	9F00H	; work area 9F00-9FFF
      89/       0 :                     STACKM	equ	9F00H	; monitor stack
      90/       0 :                     STACK	equ	9EC0H	; user stack
      91/       0 :                     ROM_B	equ	0000H	;EMUZ80_Q84 ROM base address
      92/       0 :                     RAM_B	equ	8000H	;EMUZ80_Q84 RAM base address
      93/       0 :                     RAM_E	equ	9FFFH	;EMUZ80_Q84 RAM END address
      94/       0 :                     IO_B	equ	0E000H	;EMUZ80_Q84 I/O base address
      95/       0 :                     ENTRY	EQU	0040H		; Entry point
      96/       0 : [84]                	ENDIF
      97/       0 :                     
      98/       0 : =>TRUE              	IF	SuperMEZ80 = 0
      99/       0 : =3000H              RAM_SIZ		EQU	(RAM_E + 1) - RAM_B
     100/       0 : [98]                	ENDIF
     101/       0 :                     
     102/       0 : =2F00H              BASIC_TOP	equ	2F00H
     103/       0 : =2F00H              BASIC_CST	equ	2F00H	; basic cold start
     104/       0 : =2F03H              BASIC_WST	equ	2F03H	; basic warm start
     105/       0 :                     
     106/       0 : =4C00H              PATB_TOP	equ	4C00H
     107/       0 : =4C00H              PATB_CST	equ	4C00H	; PATB cold start
     108/       0 : =4C03H              PATB_WST	equ	4C03H	; PATB warm start
     109/       0 :                     
     110/       0 : =5400H              GM80_CST	equ	5400H	; GAME80 cold start
     111/       0 : =5403H              GM80_WST	equ	5403H	; GAME80 warm start
     112/       0 :                     
     113/       0 : =7500H              VTL_CST		equ	7500H	; VTL cold start
     114/       0 : =7503H              VTL_WST		equ	7503H	; VTL warm start
     115/       0 :                     
     116/       0 :                     ;;; 
     117/       0 :                     ;;; ROM area
     118/       0 :                     ;;;
     119/       0 :                     start:
     120/       0 :                     
     121/       0 :                     	ORG	ROM_B	; (RST 00H)
     122/       0 :                     
     123/       0 :                     E_CSTART:
     124/       0 : C3 40 00            	JP	cold_st
     125/       3 :                     
     126/       3 :                     E_WSTART:
     127/       3 : C3 87 27            	JP	API01
     128/       6 :                     
     129/       6 : 00 00               	db	0008H - $ dup(00H)
     130/       8 :                     ;	ORG	0008H	; (RST 08H)
     131/       8 : =>TRUE              	IF	BACKDOOR
     132/       8 : C3 43 00            	JP	RST08H
     133/       B : =>FALSE             	ELSE
     134/       B :                     	JP	CONOUT
     135/       B : [131]               	ENDIF
     136/       B :                     
     137/       B : 00 00 00 00 00      	db	0010H - $ dup(00H)
     138/      10 :                     ;	ORG	0010H	; (RST 10H)
     139/      10 : =>TRUE              	IF	BACKDOOR
     140/      10 : C3 4B 00            	JP	RST10H
     141/      13 : =>FALSE             	ELSE
     142/      13 :                     	JP	CONIN
     143/      13 : [139]               	ENDIF
     144/      13 :                     
     145/      13 : 00 00 00 00 00      	db	0018H - $ dup(00H)	; nop
     146/      18 :                     ;	ORG	0018H	; (RST 18H)
     147/      18 : =>TRUE              	IF	BACKDOOR
     148/      18 : C3 53 00            	JP	RST18H
     149/      1B : =>FALSE             	ELSE
     150/      1B :                     	jp	CONST
     151/      1B : [147]               	ENDIF
     152/      1B :                     
     153/      1B : 00 00 00 00 00      	db	0020H - $ dup(00H)	; nop
     154/      20 :                     ;	ORG	0020H	; (RST 20H)
     155/      20 : =>TRUE              	IF	BACKDOOR
     156/      20 : C3 5B 00            	JP	RST20H
     157/      23 : =>FALSE             	ELSE
     158/      23 :                     	RET
     159/      23 : [155]               	ENDIF
     160/      23 :                     
     161/      23 : 00 00 00 00 00      	db	0028H - $ dup(00H)	; nop
     162/      28 :                     ;	ORG	0028H	; (RST 28H)
     163/      28 : =>TRUE              	IF	BACKDOOR
     164/      28 : C9                  	RET
     165/      29 : =>FALSE             	ELSE
     166/      29 :                     	RET
     167/      29 : [163]               	ENDIF
     168/      29 :                     
     169/      29 : 00 00 00 00 00 00   	db	0030H - $ dup(00H)	; nop
               2F : 00                
     170/      30 :                     ;	ORG	0030H
     171/      30 : =>TRUE              	IF	BACKDOOR
     172/      30 : C3 6B 00            	JP	RST30H
     173/      33 : =>FALSE             	ELSE
     174/      33 :                     	JP	RST30H_IN
     175/      33 : [171]               	ENDIF
     176/      33 :                     
     177/      33 : 00 00 00 00 00      	db	0038H - $ dup(00H)	; nop
     178/      38 :                     ;	ORG	0038H
     179/      38 : =>TRUE              	IF	BACKDOOR
     180/      38 : C3 73 00            	JP	RST38H;
     181/      3B : =>FALSE             	ELSE
     182/      3B :                     	JP	RST38H_IN
     183/      3B : [179]               	ENDIF
     184/      3B :                     
     185/      3B : 00 00 00 00 00      	db	ENTRY - $ dup(00H)
     186/      40 :                     	;	ORG	ENTRY
     187/      40 :                     
     188/      40 :                     	;;
     189/      40 :                     	;; Entry point
     190/      40 :                     	;;
     191/      40 :                     
     192/      40 : =>FALSE             	if (SuperMEZ80=1) && (SMEZ80Full=0)
     193/      40 :                     
     194/      40 :                     	;; LOADER START
     195/      40 :                     cold_st:
     196/      40 :                     	ld	hl, CSTART
     197/      40 :                     	ld	(1), hl		; set new COLD START
     198/      40 :                     
     199/      40 :                     	ld	de, MON_SEG
     200/      40 :                     	ld	hl, SV_ROM
     201/      40 :                     	ld	bc, end_mon - MON_SEG
     202/      40 :                     	ldir
     203/      40 :                     	jp	CSTART
     204/      40 :                     
     205/      40 :                     	db	SV_ROM - $ dup(0ffh)
     206/      40 :                     
     207/      40 :                     	org	MON_SEG
     208/      40 :                     
     209/      40 : =>TRUE              	else
     210/      40 :                     cold_st:
     211/      40 : [192]               	endif
     212/      40 :                     
     213/      40 : C3 7E 00            	jp	CSTART
     214/      43 :                     
     215/      43 : =>TRUE              	IF	BACKDOOR
     216/      43 :                     ;;;
     217/      43 :                     ;;; RST 08H Handler
     218/      43 :                     ;;;
     219/      43 :                     RST08H:
     220/      43 :                     
     221/      43 : 22 0E EF            	ld	(save_hl), hl	; save hl
     222/      46 : 2A 00 EF            	ld	hl, (stealRST08)
     223/      49 : 18 2E               	jr	jmp_rst
     224/      4B :                     
     225/      4B :                     ;;;
     226/      4B :                     ;;; RST 10H Handler
     227/      4B :                     ;;;
     228/      4B :                     RST10H:
     229/      4B :                     
     230/      4B : 22 0E EF            	ld	(save_hl), hl	; save hl
     231/      4E : 2A 02 EF            	ld	hl, (stealRST10)
     232/      51 : 18 26               	jr	jmp_rst
     233/      53 :                     
     234/      53 :                     ;;;
     235/      53 :                     ;;; RST 18H Handler
     236/      53 :                     ;;;
     237/      53 :                     RST18H:
     238/      53 :                     
     239/      53 : 22 0E EF            	ld	(save_hl), hl	; save hl
     240/      56 : 2A 04 EF            	ld	hl, (stealRST18)
     241/      59 : 18 1E               	jr	jmp_rst
     242/      5B :                     
     243/      5B :                     ;;;
     244/      5B :                     ;;; RST 20H Handler
     245/      5B :                     ;;;
     246/      5B :                     RST20H:
     247/      5B :                     
     248/      5B : 22 0E EF            	ld	(save_hl), hl	; save hl
     249/      5E : 2A 06 EF            	ld	hl, (stealRST20)
     250/      61 : 18 16               	jr	jmp_rst
     251/      63 :                     
     252/      63 :                     ;;;
     253/      63 :                     ;;; RST 28H Handler
     254/      63 :                     ;;;
     255/      63 :                     RST28H:
     256/      63 :                     
     257/      63 : 22 0E EF            	ld	(save_hl), hl	; save hl
     258/      66 : 2A 08 EF            	ld	hl, (stealRST28)
     259/      69 : 18 0E               	jr	jmp_rst
     260/      6B :                     
     261/      6B :                     ;;;
     262/      6B :                     ;;; RST 30H Handler
     263/      6B :                     ;;;
     264/      6B :                     RST30H:
     265/      6B :                     
     266/      6B : 22 0E EF            	ld	(save_hl), hl	; save hl
     267/      6E : 2A 0A EF            	ld	hl, (stealRST30)
     268/      71 : 18 06               	jr	jmp_rst
     269/      73 :                     
     270/      73 :                     ;;;
     271/      73 :                     ;;; RST 38H Handler
     272/      73 :                     ;;;
     273/      73 :                     RST38H:
     274/      73 :                     
     275/      73 : 22 0E EF            	ld	(save_hl), hl	; save hl
     276/      76 : 2A 0C EF            	ld	hl, (stealRST38)
     277/      79 :                     jmp_rst:
     278/      79 : E5                  	push	hl		; set jump address
     279/      7A : 2A 0E EF            	ld	hl, (save_hl)	; restore hl
     280/      7D :                     RST20H_IN:
     281/      7D :                     RST28H_IN:
     282/      7D : C9                  	ret			; jump (stealRST38)
     283/      7E : [215]               	ENDIF
     284/      7E :                     
     285/      7E :                     ;;;
     286/      7E :                     ;;; Universal Monitor Z80 Cold start
     287/      7E :                     ;;;
     288/      7E :                     
     289/      7E :                     CSTART:
     290/      7E : F3                  	DI
     291/      7F : 31 00 EF            	LD	SP,STACKM	; monitor stask defines STACKM
     292/      82 :                     
     293/      82 : 21 00 C0            	LD	HL,RAM_B
     294/      85 : 22 10 EF            	LD	(DSADDR),HL
     295/      88 : 22 17 EF            	LD	(SADDR),HL
     296/      8B : 22 15 EF            	LD	(GADDR),HL
     297/      8E : 22 64 EF            	ld	(asm_adr),HL
     298/      91 : 22 66 EF            	ld	(tasm_adr),HL
     299/      94 : 3E 49               	LD	A,'I'
     300/      96 : 32 19 EF            	LD	(HEXMOD),A
     301/      99 :                     	
     302/      99 : =>TRUE              	IF	BACKDOOR
     303/      99 :                     	; init back door RST XXH entory point
     304/      99 : 21 E5 2E            	ld	hl, CONOUT		; RST 08H : CONOUT
     305/      9C : 22 00 EF            	ld	(stealRST08), hl
     306/      9F : 21 D4 2E            	ld	hl, CONIN
     307/      A2 : 22 02 EF            	ld	(stealRST10), hl	; RST 10H : CONIN
     308/      A5 : 21 DF 2E            	ld	hl, CONST
     309/      A8 : 22 04 EF            	ld	(stealRST18), hl	; RST 18H : CONST
     310/      AB : 21 7D 00            	ld	hl, RST20H_IN
     311/      AE : 22 06 EF            	ld	(stealRST20), hl
     312/      B1 : 21 7D 00            	ld	hl, RST28H_IN
     313/      B4 : 22 08 EF            	ld	(stealRST28), hl
     314/      B7 : 21 3E 27            	ld	hl, RST30H_IN
     315/      BA : 22 0A EF            	ld	(stealRST30), hl
     316/      BD : 21 CB 27            	ld	hl, RST38H_IN
     317/      C0 : 22 0C EF            	ld	(stealRST38), hl
     318/      C3 : [302]               	ENDIF
     319/      C3 :                     
     320/      C3 :                     	;; Initialize register value
     321/      C3 : AF                  	XOR	A
     322/      C4 : 21 1C EF            	LD	HL,REG_B
     323/      C7 : 06 1A               	LD	B,REG_E-REG_B
     324/      C9 :                     IR0:
     325/      C9 : 77                  	LD	(HL),A
     326/      CA : 23                  	INC	HL
     327/      CB : 10 FC               	DJNZ	IR0
     328/      CD :                     
     329/      CD : 21 C0 EE            	LD	HL,STACK		; user stack define STACK
     330/      D0 : 22 30 EF            	LD	(REGSP),HL
     331/      D3 : 21 00 C0            	ld	hl, RAM_B
     332/      D6 : 22 32 EF            	ld	(REGPC), HL		; set program counter
     333/      D9 :                     
     334/      D9 : 06 08               	ld	b, F_bitSize
     335/      DB : 3E 2E               	ld	a, '.'
     336/      DD : 21 79 EF            	ld	hl, F_bit
     337/      E0 :                     ir00:
     338/      E0 : 77                  	ld	(hl), a
     339/      E1 : 23                  	inc	hl
     340/      E2 : 10 FC               	djnz	ir00		; init F_bit string
     341/      E4 : AF                  	xor	a
     342/      E5 : 77                  	ld	(hl), a		; delimiter
     343/      E6 :                     
     344/      E6 :                     ; init dbg work area
     345/      E6 :                     
     346/      E6 : 06 14               	LD	B, dbg_wend - dbg_wtop
     347/      E8 : 21 50 EF            	ld	hl,dbg_wtop	
     348/      EB : AF                  	XOR	A
     349/      EC :                     
     350/      EC :                     dbg_wini:
     351/      EC : 77                  	ld	(hl), a
     352/      ED : 23                  	inc	hl
     353/      EE : 10 FC               	DJNZ	dbg_wini
     354/      F0 :                     
     355/      F0 : 3E 49               	ld	a, 'I'
     356/      F2 : 32 4A EF            	ld	(TM_mode), a	; default call_in mode
     357/      F5 : 3E 4E               	ld	a, 'N'
     358/      F7 : 32 49 EF            	ld	(TP_mode), a	; default display reg mode
     359/      FA : 2E 00               	ld	l, 0
     360/      FC : 65                  	ld	h, l
     361/      FD : 22 4B EF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     362/     100 : AF                  	xor	a
     363/     101 : 32 4F EF            	ld	(fever_t), a	; clear flag trace forever
     364/     104 :                     	; init bp, tp, gstop address & opcode
     365/     104 : 21 00 C0            	ld	hl, RAM_B
     366/     107 : 22 52 EF            	ld	(tpt1_adr), hl
     367/     10A : 22 56 EF            	ld	(tpt2_adr), hl
     368/     10D : 22 5A EF            	ld	(bpt1_adr), hl
     369/     110 : 22 5E EF            	ld	(bpt2_adr), hl
     370/     113 : 22 62 EF            	ld	(tmpb_adr), hl
     371/     116 : 7E                  	ld	a, (hl)
     372/     117 : 32 51 EF            	ld	(tpt1_op), a
     373/     11A : 32 55 EF            	ld	(tpt2_op), a
     374/     11D : 32 59 EF            	ld	(bpt1_op), a
     375/     120 : 32 5D EF            	ld	(bpt2_op), a
     376/     123 : 32 61 EF            	ld	(tmpb_op), a
     377/     126 :                     	
     378/     126 :                     ;; Opening message
     379/     126 :                     
     380/     126 : 21 3D 2C            	LD	HL,OPNMSG
     381/     129 : CD 02 26            	CALL	STROUT
     382/     12C :                     ;	EI
     383/     12C :                     
     384/     12C :                     WSTART:
     385/     12C : AF                  	xor	a
     386/     12D : 32 82 EF            	ld	(ky_flg), a	; clear skip LF flag
     387/     130 :                     
     388/     130 : 21 7A 2C            	LD	HL,PROMPT
     389/     133 : CD 02 26            	CALL	STROUT
     390/     136 : CD 62 26            	CALL	GETLIN
     391/     139 : CD EC 26            	CALL	SKIPSP
     392/     13C : B7                  	OR	A
     393/     13D : 28 ED               	JR	Z, WSTART
     394/     13F :                     
     395/     13F : FE 41               	CP	'A'
     396/     141 : CA 01 1A            	JP	Z, line_asm
     397/     144 : FE 44               	CP	'D'
     398/     146 : CA 5E 07            	JP	Z, DUMP
     399/     149 : FE 47               	CP	'G'
     400/     14B : CA 46 14            	JP	Z, GO
     401/     14E : FE 53               	CP	'S'
     402/     150 : CA 0D 15            	JP	Z, SETM
     403/     153 :                     
     404/     153 : FE 4C               	CP	'L'
     405/     155 : CA 83 15            	JP	Z, LOADH
     406/     158 : FE 50               	CP	'P'
     407/     15A : CA 85 16            	JP	Z, SAVEH
     408/     15D :                     
     409/     15D : FE 52               	CP	'R'
     410/     15F : CA 5D 17            	JP	Z, REG
     411/     162 :                     
     412/     162 : =>TRUE              	if (SuperMEZ80=0) || (SMEZ80Full=1)
     413/     162 : FE 23               	cp	'#'
     414/     164 : CA 85 01            	jp	Z, Launcher
     415/     167 : [412]               	endif
     416/     167 :                     
     417/     167 : FE 42               	cp	'B'
     418/     169 : CA 20 03            	jp	z, brk_cmd	; break point command
     419/     16C :                     	
     420/     16C : FE 54               	cp	'T'
     421/     16E : CA D5 03            	jp	z, trace_cmd	; trace point command
     422/     171 :                     
     423/     171 : FE 3F               	cp	'?'
     424/     173 : 28 08               	jr	z, command_hlp	; command help message
     425/     175 :                     
     426/     175 :                     ERR:
     427/     175 : 21 97 2C            	LD	HL,ERRMSG
     428/     178 : CD 02 26            	CALL	STROUT
     429/     17B : 18 AF               	JR	WSTART
     430/     17D :                     
     431/     17D :                     ;;
     432/     17D :                     ;; command help
     433/     17D :                     ;;
     434/     17D :                     command_hlp:
     435/     17D :                     
     436/     17D : 21 5A 2A            	LD	HL, cmd_hlp
     437/     180 : CD 02 26            	CALL	STROUT
     438/     183 : 18 A7               	JR	WSTART
     439/     185 :                     
     440/     185 : =>TRUE              	if (SuperMEZ80=0) || (SMEZ80Full=1)
     441/     185 :                     ;;
     442/     185 :                     ;; Launch appended program
     443/     185 :                     ;;
     444/     185 :                     Launcher:
     445/     185 : 23                  	INC	HL
     446/     186 : CD EC 26            	CALL	SKIPSP		; A <- next char
     447/     189 : B7                  	OR	A
     448/     18A : 28 E9               	JR	Z,ERR
     449/     18C :                     
     450/     18C :                     	; check L or number
     451/     18C :                     	
     452/     18C : FE 4C               	cp	'L'
     453/     18E : 28 25               	JR	Z,LST_PRG	; list append program
     454/     190 :                     
     455/     190 :                     	; check number
     456/     190 :                     
     457/     190 : CD BB 02            	call	GET_NUM		; return BC : number
     458/     193 : 38 E0               	JR	C, ERR
     459/     195 :                     
     460/     195 :                     	; check number
     461/     195 : 79                  	LD	A, C
     462/     196 : FE 11               	CP	(lanch1 - ApendTBL)/2 +1	; a < 17 ?
     463/     198 : D2 75 01            	JP	NC, ERR
     464/     19B : B7                  	OR	A				; check '0'
     465/     19C : CA 75 01            	JP	Z, ERR
     466/     19F :                     
     467/     19F :                     	; A <- append program No.
     468/     19F :                     
     469/     19F : 3D                  	DEC	A	; 0 <= A <= 0FH
     470/     1A0 : 17                  	RLA		; A = A * 2
     471/     1A1 : 16 00               	LD	D, 0
     472/     1A3 : 5F                  	LD	E, A
     473/     1A4 : 21 D3 01            	LD	HL, ApendTBL
     474/     1A7 : 19                  	ADD	HL, DE	; get lanch address point
     475/     1A8 : 5E                  	LD	E, (HL)
     476/     1A9 : 23                  	INC	HL
     477/     1AA : 56                  	LD	D, (HL)	; DE : JUMP POINT
     478/     1AB :                     
     479/     1AB :                     	; Jump to append program
     480/     1AB :                     	
     481/     1AB : EB                  	EX	DE, HL
     482/     1AC : 5E                  	LD	E, (HL)
     483/     1AD : 23                  	INC	HL
     484/     1AE : 56                  	LD	D, (HL)	; DE : jump address
     485/     1AF : 7A                  	LD	A, D
     486/     1B0 : B3                  	OR	E	; address check
     487/     1B1 : 28 C2               	JR	Z,ERR	; jump address NULL
     488/     1B3 : EB                  	EX	DE, HL
     489/     1B4 : E9                  	JP	(HL)	; lanch append program
     490/     1B5 :                     	
     491/     1B5 :                     	; List out append program
     492/     1B5 :                     LST_PRG:
     493/     1B5 :                     	; get address to DE
     494/     1B5 : 21 D3 01            	LD	HL, ApendTBL
     495/     1B8 :                     
     496/     1B8 :                     LST_PRG1:
     497/     1B8 : 5E                  	LD	E, (HL)
     498/     1B9 : 23                  	INC	HL
     499/     1BA : 56                  	LD	D, (HL)
     500/     1BB : 23                  	INC	HL
     501/     1BC :                     
     502/     1BC : D5                  	PUSH	DE
     503/     1BD : DD E1               	POP	IX	; IX <-DE
     504/     1BF : DD 7E 00            	LD	A, (IX+0)
     505/     1C2 : DD B6 01            	OR	(IX+1)
     506/     1C5 : 28 09               	JR	Z, LST_END
     507/     1C7 : 13                  	INC	DE
     508/     1C8 : 13                  	INC	DE	; get string address
     509/     1C9 :                     	
     510/     1C9 : EB                  	EX	DE, HL
     511/     1CA : CD 02 26            	CALL	STROUT
     512/     1CD : EB                  	EX	DE, HL
     513/     1CE : 18 E8               	JR	LST_PRG1
     514/     1D0 :                     
     515/     1D0 :                     LST_END:
     516/     1D0 : C3 2C 01            	JP	WSTART
     517/     1D3 :                     	
     518/     1D3 :                     ; Append program launch table
     519/     1D3 :                     ;
     520/     1D3 :                     ApendTBL:
     521/     1D3 : F3 01               	dw	lanch1
     522/     1D5 : 07 02               	dw	lanch2
     523/     1D7 : 1D 02               	dw	lanch3
     524/     1D9 : 3F 02               	dw	lanch4
     525/     1DB : 63 02               	dw	lanch5
     526/     1DD : 77 02               	dw	lanch6
     527/     1DF : 8D 02               	dw	lanch7
     528/     1E1 : 9E 02               	dw	lanch8
     529/     1E3 : B1 02               	dw	lanch9
     530/     1E5 : B1 02               	dw	lanch10
     531/     1E7 : B1 02               	dw	lanch11
     532/     1E9 : B1 02               	dw	lanch12
     533/     1EB : B1 02               	dw	lanch13
     534/     1ED : B1 02               	dw	lanch14
     535/     1EF : B1 02               	dw	lanch15
     536/     1F1 : B1 02               	dw	lanch16
     537/     1F3 :                     	
     538/     1F3 :                     lanch1:
     539/     1F3 : 00 2F               	dw	BASIC_CST
     540/     1F5 : 31 2E 20 47 42 41   	DB	"1. GBASIC Start",CR,LF,00H
              1FB : 53 49 43 20 53 74 
              201 : 61 72 74 0D 0A 00 
     541/     207 :                     lanch2:
     542/     207 : 03 2F               	dw	BASIC_WST
     543/     209 : 32 2E 20 47 42 41   	DB	"2. GBASIC Restart",CR,LF,00H
              20F : 53 49 43 20 52 65 
              215 : 73 74 61 72 74 0D 
              21B : 0A 00             
     544/     21D :                     
     545/     21D :                     lanch3:
     546/     21D : 00 4C               	dw	PATB_CST
     547/     21F : 33 2E 20 50 61 6C   	DB	"3. Palo Alto Tiny BASIC Start",CR,LF,00H
              225 : 6F 20 41 6C 74 6F 
              22B : 20 54 69 6E 79 20 
              231 : 42 41 53 49 43 20 
              237 : 53 74 61 72 74 0D 
              23D : 0A 00             
     548/     23F :                     		
     549/     23F :                     lanch4:
     550/     23F : 03 4C               	dw	PATB_WST
     551/     241 : 34 2E 20 50 61 6C   	DB	"4. Palo Alto Tiny BASIC Restart",CR,LF,00H
              247 : 6F 20 41 6C 74 6F 
              24D : 20 54 69 6E 79 20 
              253 : 42 41 53 49 43 20 
              259 : 52 65 73 74 61 72 
              25F : 74 0D 0A 00       
     552/     263 :                     
     553/     263 :                     lanch5:
     554/     263 : 00 54               	dw	GM80_CST
     555/     265 : 35 2E 20 47 41 4D   	DB	"5. GAME80 Start",CR,LF,00H
              26B : 45 38 30 20 53 74 
              271 : 61 72 74 0D 0A 00 
     556/     277 :                     		
     557/     277 :                     lanch6:
     558/     277 : 03 54               	dw	GM80_WST
     559/     279 : 36 2E 20 47 41 4D   	DB	"6. GAME80 Restart",CR,LF,00H
              27F : 45 38 30 20 52 65 
              285 : 73 74 61 72 74 0D 
              28B : 0A 00             
     560/     28D :                     
     561/     28D :                     lanch7:
     562/     28D : 00 75               	dw	VTL_CST
     563/     28F : 37 2E 20 56 54 4C   	DB	"7. VTL Start",CR,LF,00H
              295 : 20 53 74 61 72 74 
              29B : 0D 0A 00          
     564/     29E :                     		
     565/     29E :                     lanch8:
     566/     29E : 03 75               	dw	VTL_WST
     567/     2A0 : 38 2E 20 56 54 4C   	DB	"8. VTL Restart",CR,LF,00H
              2A6 : 20 52 65 73 74 61 
              2AC : 72 74 0D 0A 00    
     568/     2B1 :                     
     569/     2B1 :                     lanch9:
     570/     2B1 :                     lanch10:
     571/     2B1 :                     lanch11:
     572/     2B1 :                     lanch12:
     573/     2B1 :                     lanch13:
     574/     2B1 :                     lanch14:
     575/     2B1 :                     lanch15:
     576/     2B1 :                     lanch16:
     577/     2B1 : 00 00               	dw	0
     578/     2B3 : [440]               	endif
     579/     2B3 :                     
     580/     2B3 :                     GET_dNUM:
     581/     2B3 : D5                  	push	de
     582/     2B4 : E5                  	push	hl
     583/     2B5 : CD BB 02            	call	GET_NUM
     584/     2B8 : E1                  	pop	hl
     585/     2B9 : D1                  	pop	de
     586/     2BA : C9                  	ret
     587/     2BB :                     
     588/     2BB :                     	; get number
     589/     2BB :                     	; input HL : string buffer
     590/     2BB :                     	;
     591/     2BB :                     	; Return
     592/     2BB :                     	; CF =1 : Error
     593/     2BB :                     	; BC: Calculation result
     594/     2BB :                     
     595/     2BB :                     GET_NUM:
     596/     2BB : AF                  	XOR	A		; Initialize C
     597/     2BC : 47                  	LD	B, A
     598/     2BD : 4F                  	LD	C, A		; clear BC
     599/     2BE :                     	
     600/     2BE :                     GET_NUM0:
     601/     2BE : CD EC 26            	CALL	SKIPSP		; A <- next char
     602/     2C1 : B7                  	OR	A
     603/     2C2 : C8                  	RET	Z		; ZF=1, ok! buffer end
     604/     2C3 :                     
     605/     2C3 : CD DD 02            	CALL	GET_BI
     606/     2C6 : D8                  	RET	C
     607/     2C7 :                     
     608/     2C7 : F5                  	push	af
     609/     2C8 : 08                  	EX	AF, AF'		;'AF <> AF: save A
     610/     2C9 : F1                  	pop	af
     611/     2CA : CD EC 02            	CALL	MUL_10		; BC = BC * 10
     612/     2CD : D8                  	RET	C		; overflow error
     613/     2CE : 08                  	EX	AF, AF'		;'AF <> AF: restor A
     614/     2CF :                     
     615/     2CF : E5                  	push	hl
     616/     2D0 : 16 00               	ld	d, 0
     617/     2D2 : 5F                  	ld	e, a
     618/     2D3 :                     
     619/     2D3 : 60                  	ld	h, b
     620/     2D4 : 69                  	ld	l, c
     621/     2D5 : 19                  	add	hl, de
     622/     2D6 : 44                  	ld	b, h
     623/     2D7 : 4D                  	ld	c, l		; result: BC = BC * 10 + A
     624/     2D8 : E1                  	pop	hl
     625/     2D9 : D8                  	RET	C		; overflow error
     626/     2DA :                     				; result: BC = BC * 10 + A
     627/     2DA : 23                  	INC	HL
     628/     2DB : 18 E1               	JR	GET_NUM0
     629/     2DD :                     ;
     630/     2DD :                     ; Make binary to A
     631/     2DD :                     ; ERROR if CF=1
     632/     2DD :                     ;
     633/     2DD :                     GET_BI:
     634/     2DD : B7                  	OR	A
     635/     2DE : 28 0A               	JR	Z, UP_BI
     636/     2E0 : FE 30               	CP	'0'
     637/     2E2 : D8                  	RET	C
     638/     2E3 :                     	
     639/     2E3 : FE 3A               	CP	'9'+1	; ASCII':'
     640/     2E5 : 30 03               	JR	NC, UP_BI
     641/     2E7 : D6 30               	SUB	'0'	; Make binary to A
     642/     2E9 : C9                  	RET
     643/     2EA :                     
     644/     2EA :                     UP_BI:
     645/     2EA : 37                  	SCF		; Set CF
     646/     2EB : C9                  	RET
     647/     2EC :                     
     648/     2EC :                     ;
     649/     2EC :                     ; multiply by 10
     650/     2EC :                     ; BC = BC * 10
     651/     2EC :                     MUL_10:
     652/     2EC : E5                  	push	hl
     653/     2ED :                     
     654/     2ED : C5                  	push	bc
     655/     2EE : CB 21               	SLA	C
     656/     2F0 : CB 10               	RL	B		; 2BC
     657/     2F2 : CB 21               	SLA	C
     658/     2F4 : CB 10               	RL	B		; 4BC
     659/     2F6 : E1                  	pop	hl		; hl = bc
     660/     2F7 : 09                  	add	hl, bc
     661/     2F8 : E5                  	push	hl
     662/     2F9 : C1                  	pop	bc		; 5BC
     663/     2FA : CB 21               	SLA	C
     664/     2FC : CB 10               	RL	B		; 10BC
     665/     2FE :                     
     666/     2FE : E1                  	pop	hl
     667/     2FF : C9                  	RET			; result : BC = BC * 10
     668/     300 :                     ;
     669/     300 :                     ; list break point
     670/     300 :                     ;
     671/     300 :                     b_list:
     672/     300 : 3A 58 EF            	ld	a, (bpt1_f)
     673/     303 : B7                  	or	a
     674/     304 : 28 08               	jr	z, b_list1
     675/     306 :                     
     676/     306 : 2A 5A EF            	ld	hl, (bpt1_adr)
     677/     309 : 3E 31               	ld	a, '1'
     678/     30B : CD BB 03            	call	b_msg_out
     679/     30E :                     
     680/     30E :                     b_list1:
     681/     30E : 3A 5C EF            	ld	a, (bpt2_f)
     682/     311 : B7                  	or	a
     683/     312 : CA 2C 01            	jp	z, WSTART
     684/     315 :                     
     685/     315 : 2A 5E EF            	ld	hl, (bpt2_adr)
     686/     318 : 3E 32               	ld	a, '2'
     687/     31A : CD BB 03            	call	b_msg_out
     688/     31D : C3 2C 01            	JP	WSTART
     689/     320 :                     
     690/     320 :                     
     691/     320 :                     ;;; 
     692/     320 :                     ;;; break point command
     693/     320 :                     ;;; 
     694/     320 :                     brk_cmd:
     695/     320 : 23                  	INC	HL
     696/     321 : CD EC 26            	CALL	SKIPSP		; A <- next char
     697/     324 : B7                  	OR	A
     698/     325 : 28 D9               	JR	Z,b_list	; only type "B"
     699/     327 :                     
     700/     327 : 01 58 EF            	ld	bc, bpt1_f
     701/     32A : FE 31               	cp	'1'
     702/     32C : 28 0E               	jr	z, set_bp1
     703/     32E :                     
     704/     32E : 01 5C EF            	ld	bc, bpt2_f
     705/     331 : FE 32               	cp	'2'
     706/     333 : 28 07               	jr	z, set_bp1
     707/     335 :                     
     708/     335 : FE 43               	cp	'C'	;clear?
     709/     337 : 28 3E               	jr	z, bp_clr
     710/     339 : C3 75 01            	jp	ERR
     711/     33C :                     
     712/     33C :                     set_bp1:
     713/     33C : 08                  	EX	AF, AF'		;'
     714/     33D :                     
     715/     33D : 23                  	INC	HL
     716/     33E : CD EC 26            	CALL	SKIPSP		; A <- next char
     717/     341 : B7                  	OR	A
     718/     342 : 28 5A               	JR	Z, bp_LOT 	;; No address input -> list out
     719/     344 : FE 2C               	cp	','
     720/     346 : C2 75 01            	jp	nz, ERR
     721/     349 :                     
     722/     349 : 23                  	INC	HL
     723/     34A : CD EC 26            	CALL	SKIPSP
     724/     34D : C5                  	push	bc
     725/     34E : CD FC 26            	CALL	RDHEX		; 1st arg.
     726/     351 : E1                  	pop	hl		; hl <- bc
     727/     352 : DA 75 01            	jp	c, ERR
     728/     355 :                     
     729/     355 : CD 5E 03            	call	setbpadr
     730/     358 : DA 75 01            	jp	c, ERR
     731/     35B : C3 2C 01            	JP	WSTART
     732/     35E :                     
     733/     35E :                     
     734/     35E :                     ; hl : point of bp flag( bpt1_f or bpt2_f)
     735/     35E :                     ; de : break point address
     736/     35E :                     
     737/     35E :                     ; check ram area, and set berak point
     738/     35E :                     ; 
     739/     35E :                     setbpadr:
     740/     35E :                     
     741/     35E : =>TRUE              	IF SuperMEZ80 = 0
     742/     35E : 7A                  	ld	a, d
     743/     35F : FE C0               	cp	RAM_B >> 8	; a - 0C0H
     744/     361 : DA 75 03            	jp	c, chkERR	; ROM area
     745/     364 : FE F0               	cp	IO_B >> 8	; a - 0F0H
     746/     366 : D2 75 03            	jp	nc, chkERR	; I/O area
     747/     369 : [741]               	ENDIF
     748/     369 :                     
     749/     369 : 3E 01               	ld	a,1
     750/     36B : 77                  	ld	(hl), a	; set flag
     751/     36C : 23                  	inc	hl
     752/     36D : 1A                  	ld	a, (de)		; get opcode
     753/     36E : 77                  	ld	(hl), a		; save opcode
     754/     36F : 23                  	inc	hl
     755/     370 : 73                  	ld	(hl), e ; set break point low address
     756/     371 : 23                  	inc	hl
     757/     372 : 72                  	ld	(hl), d ; set break point high address
     758/     373 : B7                  	or	a	; reset carry
     759/     374 : C9                  	ret
     760/     375 :                     
     761/     375 :                     chkERR:
     762/     375 : 37                  	scf	;set carry
     763/     376 : C9                  	ret
     764/     377 :                     
     765/     377 :                     ; clear break point
     766/     377 :                     
     767/     377 :                     bp_clr:
     768/     377 : 23                  	INC	HL
     769/     378 : CD EC 26            	CALL	SKIPSP		; A <- next char
     770/     37B : B7                  	OR	A
     771/     37C : 28 14               	JR	Z,b_aclr	; all clear
     772/     37E :                     
     773/     37E : 01 58 EF            	ld	bc, bpt1_f
     774/     381 : FE 31               	cp	'1'
     775/     383 : 28 08               	jr	z, bp_clr1
     776/     385 :                     
     777/     385 : 01 5C EF            	ld	bc, bpt2_f
     778/     388 : FE 32               	cp	'2'
     779/     38A : C2 75 01            	jp	nz, ERR
     780/     38D :                     
     781/     38D :                     bp_clr1:
     782/     38D : AF                  	xor	a
     783/     38E : 02                  	ld	(bc), a
     784/     38F : C3 2C 01            	JP	WSTART
     785/     392 :                     
     786/     392 :                     b_aclr:
     787/     392 : AF                  	xor	a
     788/     393 : 01 58 EF            	ld	bc, bpt1_f
     789/     396 : 02                  	ld	(bc), a
     790/     397 : 01 5C EF            	ld	bc, bpt2_f
     791/     39A : 02                  	ld	(bc), a
     792/     39B : C3 2C 01            	JP	WSTART
     793/     39E :                     
     794/     39E :                     ; when no address input. list out BP
     795/     39E :                     ;
     796/     39E :                     ; bc : break pointer buffer offset
     797/     39E :                     bp_LOT:
     798/     39E : 0A                  	ld	a, (bc)		; set break point?
     799/     39F : B7                  	or	a
     800/     3A0 : CA 2C 01            	jp	z, WSTART	; no break point setting
     801/     3A3 :                     
     802/     3A3 : 08                  	EX	AF, AF'		;'
     803/     3A4 : 2A 5A EF            	ld	hl, (bpt1_adr)
     804/     3A7 : FE 31               	cp	'1'
     805/     3A9 : 28 03               	jr	z, l_b2
     806/     3AB : 2A 5E EF            	ld	hl, (bpt2_adr)
     807/     3AE :                     l_b2:
     808/     3AE : CD BB 03            	call	b_msg_out
     809/     3B1 : C3 2C 01            	JP	WSTART
     810/     3B4 :                     
     811/     3B4 : 42 50 28 00         bp_msg1:	db	"BP(",00H
     812/     3B8 : 29 3A 00            bp_msg2:	db	"):",00H
     813/     3BB :                     
     814/     3BB :                     b_msg_out:
     815/     3BB : E5                  	push	hl
     816/     3BC : F5                  	push	af
     817/     3BD : 21 B4 03            	ld	hl, bp_msg1
     818/     3C0 : CD 02 26            	call	STROUT
     819/     3C3 : F1                  	pop	af
     820/     3C4 : CD E5 2E            	call	CONOUT
     821/     3C7 : 21 B8 03            	ld	hl, bp_msg2
     822/     3CA : CD 02 26            	call	STROUT
     823/     3CD : E1                  	pop	hl
     824/     3CE : CD 0B 26            	call	HEXOUT4
     825/     3D1 : CD 4B 26            	call	CRLF	
     826/     3D4 : C9                  	ret
     827/     3D5 :                     
     828/     3D5 :                     ;;; 
     829/     3D5 :                     ;;; trace command
     830/     3D5 :                     ;;; 
     831/     3D5 :                     trace_cmd:
     832/     3D5 :                     
     833/     3D5 :                     ; T[address][,step”]
     834/     3D5 :                     ; TP[ON | OFF]
     835/     3D5 :                     ; TM[I | S]
     836/     3D5 :                     
     837/     3D5 :                     ; init steps
     838/     3D5 : E5                  	push	hl
     839/     3D6 : 2E 00               	ld	l, 0
     840/     3D8 : 26 00               	ld	h, 0
     841/     3DA : 22 4B EF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     842/     3DD : 2A 32 EF            	ld	hl,(REGPC)
     843/     3E0 : 22 4D EF            	ld	(tmpT), hl	; init temp address
     844/     3E3 : AF                  	xor	a
     845/     3E4 : 32 4F EF            	ld	(fever_t), a	; clear flag trace forever
     846/     3E7 :                     
     847/     3E7 : E1                  	pop	hl
     848/     3E8 : 23                  	inc	hl
     849/     3E9 : CD EC 26            	CALL	SKIPSP
     850/     3EC : CD FC 26            	CALL	RDHEX		; 1st arg.
     851/     3EF : D2 9B 04            	jp	nc, tadr_chk
     852/     3F2 : CD EC 26            	CALL	SKIPSP
     853/     3F5 : 7E                  	ld	a, (hl)
     854/     3F6 : B7                  	or	a
     855/     3F7 : CA C4 04            	Jp	z, t_op1	; only 1 step trace, check opcode
     856/     3FA : FE 2C               	cp	','
     857/     3FC : CA AC 04            	jp	z, stp_chk	; steps check
     858/     3FF :                     
     859/     3FF : FE 50               	cp	'P'
     860/     401 : 28 4E               	jr	z, tp_cmd
     861/     403 : FE 4D               	cp	'M'
     862/     405 : C2 75 01            	jp	nz, ERR
     863/     408 :                     	
     864/     408 :                     	; tm_cmd
     865/     408 :                     	
     866/     408 : 23                  	inc	hl
     867/     409 : CD EC 26            	CALL	SKIPSP		; A <- next char
     868/     40C :                     dip_TM:
     869/     40C : 21 43 04            	ld	hl, tm_msg_i
     870/     40F : FE 49               	cp	'I'
     871/     411 : 28 10               	jr	z, set_TM
     872/     413 : 21 49 04            	ld	hl, tm_msg_s
     873/     416 : FE 53               	cp	'S'
     874/     418 : 28 09               	jr	z, set_TM
     875/     41A : B7                  	or	a
     876/     41B : C2 75 01            	jp	nz, ERR
     877/     41E :                     
     878/     41E :                     ;display T mode
     879/     41E : 3A 4A EF            	ld	a, (TM_mode)
     880/     421 : 18 E9               	jr	dip_TM
     881/     423 :                     
     882/     423 :                     ;set TM mode and display
     883/     423 :                     set_TM:
     884/     423 : 32 4A EF            	ld	(TM_mode),a
     885/     426 : E5                  	push	hl
     886/     427 : 21 34 04            	ld	hl, tm_msg_0
     887/     42A : CD 02 26            	call	STROUT
     888/     42D : E1                  	pop	hl
     889/     42E : CD 02 26            	call	STROUT
     890/     431 : C3 2C 01            	jp	WSTART
     891/     434 :                     
     892/     434 :                     tm_msg_0:
     893/     434 : 54 4D 20 6D 6F 64   	db	"TM mode:<CALL ", 00h
              43A : 65 3A 3C 43 41 4C 
              440 : 4C 20 00          
     894/     443 :                     tm_msg_i:
     895/     443 : 49 4E 3E 0D 0A 00   	db	"IN>", CR, LF, 00h
     896/     449 :                     tm_msg_s:
     897/     449 : 53 4B 49 50 3E 0D   	db	"SKIP>", CR, LF, 00h
              44F : 0A 00             
     898/     451 :                     	
     899/     451 :                     	
     900/     451 :                     	; tp_cmd
     901/     451 :                     tp_cmd:	
     902/     451 : 23                  	inc	hl
     903/     452 : CD EC 26            	CALL	SKIPSP		; A <- next char
     904/     455 : B7                  	or	a
     905/     456 : 20 05               	jr	nz, tp_n1
     906/     458 : 3A 49 EF            	ld	a, (TP_mode)
     907/     45B : 18 09               	jr	tp_n2
     908/     45D :                     	
     909/     45D :                     tp_n1:
     910/     45D : FE 4F               	cp	'O'
     911/     45F : C2 75 01            	jp	nz, ERR
     912/     462 : 23                  	inc	hl
     913/     463 : CD EC 26            	CALL	SKIPSP		; A <- next char
     914/     466 :                     
     915/     466 :                     tp_n2:
     916/     466 : 21 90 04            	ld	hl, tp_msg_on
     917/     469 : FE 4E               	cp	'N'
     918/     46B : 28 08               	jr	z, tp_md_on
     919/     46D :                     
     920/     46D : 21 95 04            	ld	hl, tp_msg_off
     921/     470 : FE 46               	cp	'F'
     922/     472 : C2 75 01            	jp	nz, ERR
     923/     475 :                     
     924/     475 :                     tp_md_on:
     925/     475 :                     	; set trace mode and display mode
     926/     475 : 32 49 EF            	ld	(TP_mode), a
     927/     478 : E5                  	push	hl
     928/     479 : 21 86 04            	ld	hl, tp_msg_0
     929/     47C : CD 02 26            	call	STROUT
     930/     47F : E1                  	pop	hl
     931/     480 : CD 02 26            	call	STROUT
     932/     483 : C3 2C 01            	jp	WSTART
     933/     486 :                     	
     934/     486 :                     tp_msg_0:
     935/     486 : 54 50 20 6D 6F 64   	db	"TP mode: ", 00h
              48C : 65 3A 20 00       
     936/     490 :                     tp_msg_on:
     937/     490 : 4F 4E 0D 0A 00      	db	"ON", CR, LF, 00h
     938/     495 :                     tp_msg_off:
     939/     495 : 4F 46 46 0D 0A 00   	db	"OFF", CR, LF, 00h
     940/     49B :                     
     941/     49B :                     tadr_chk:
     942/     49B : ED 53 4D EF         	ld	(tmpT), de	; set start address
     943/     49F : CD EC 26            	CALL	SKIPSP		; A <- next char
     944/     4A2 : B7                  	or	a
     945/     4A3 : 28 1F               	jr	z, t_op1	; 1step trace
     946/     4A5 : FE 2C               	cp	','
     947/     4A7 : 28 03               	jr	z, stp_chk
     948/     4A9 : C3 75 01            	jp	ERR
     949/     4AC :                     
     950/     4AC :                     stp_chk:
     951/     4AC : 23                  	inc	hl
     952/     4AD : CD EC 26            	CALL	SKIPSP		; A <- next char
     953/     4B0 : B7                  	or	a
     954/     4B1 : CA 75 01            	jp	z, ERR
     955/     4B4 : FE 2D               	cp	'-'
     956/     4B6 : 28 11               	jr	z, chk_fevre
     957/     4B8 :                     
     958/     4B8 :                     ; check steps
     959/     4B8 :                     
     960/     4B8 : CD BB 02            	call	GET_NUM		; get steps to BC
     961/     4BB : DA 75 01            	JP	C, ERR		; number error
     962/     4BE :                     
     963/     4BE :                     t_op11:
     964/     4BE : ED 43 4B EF         	ld	(TC_cnt), bc	; set trace step counter
     965/     4C2 : 18 1B               	jr	t_op_chk
     966/     4C4 :                     
     967/     4C4 :                     t_op1:
     968/     4C4 : 01 01 00            	ld	bc, 1
     969/     4C7 : 18 F5               	jr	t_op11
     970/     4C9 :                     
     971/     4C9 :                     chk_fevre:
     972/     4C9 : 23                  	inc	hl
     973/     4CA : CD EC 26            	CALL	SKIPSP		; A <- next char
     974/     4CD : FE 31               	cp	'1'
     975/     4CF : C2 75 01            	jp	nz, ERR
     976/     4D2 : 23                  	inc	hl
     977/     4D3 : CD EC 26            	CALL	SKIPSP		; A <- next char
     978/     4D6 : B7                  	or	a
     979/     4D7 : C2 75 01            	jp	nz, ERR		; not "-1" then error
     980/     4DA : 3E 01               	ld	a, 1
     981/     4DC : 32 4F EF            	ld	(fever_t), a	; set flag trace forever
     982/     4DF :                     
     983/     4DF :                     t_op_chk:
     984/     4DF : 2A 4D EF            	ld	hl, (tmpT)	; get PC address
     985/     4E2 : 7E                  	ld	a, (hl)		; get opcode
     986/     4E3 :                     	
     987/     4E3 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     988/     4E3 :                     ;;;
     989/     4E3 :                     ;;; branch opecode check
     990/     4E3 :                     ;;;
     991/     4E3 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     992/     4E3 :                     
     993/     4E3 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     994/     4E3 :                     ; 2 insertion Trace code(TC) 
     995/     4E3 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     996/     4E3 :                     INSTC2:
     997/     4E3 :                     	; check 1 byte machine code: branch (RET CC)
     998/     4E3 :                     
     999/     4E3 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    1000/     4E6 : 21 7C 06            	ld	hl, RETCC_TBLS
    1001/     4E9 : ED B1               	cpir
    1002/     4EB : 20 13               	jr	nz, next_bc1	; not RET CC
    1003/     4ED :                     
    1004/     4ED :                     	; RET CC
    1005/     4ED :                     	; trace operation:
    1006/     4ED :                     	;   1. ea = *REGSP; *ea = TC;
    1007/     4ED :                     	;   2. ea = *REGPC; *(ea+1) = TC;
    1008/     4ED :                     
    1009/     4ED :                     	; 1
    1010/     4ED : 0E 01               	ld	c, 1		; first TC point
    1011/     4EF : CD 45 06            	call	insBRK_sp
    1012/     4F2 : DA 04 06            	jp	c, err_trace_seq
    1013/     4F5 :                     	
    1014/     4F5 :                     	; 2
    1015/     4F5 : 0E 02               	ld	c, 2		; second TC point
    1016/     4F7 : CD 25 06            	call	insBRK_1op
    1017/     4FA : DA 04 06            	jp	c, err_trace_seq
    1018/     4FD :                     
    1019/     4FD : C3 01 06            	jp	END_INS_TC
    1020/     500 :                     
    1021/     500 :                     	; check 2 byte machine code: branch (JR CC, Relative Value)
    1022/     500 :                     next_bc1:
    1023/     500 :                     
    1024/     500 : 01 05 00            	ld	bc, JRCC_TBLE - JRCC_TBLS
    1025/     503 : 21 84 06            	ld	hl, JRCC_TBLS
    1026/     506 : ED B1               	cpir
    1027/     508 : 20 19               	jr	nz, next_bc2	; not JR CC
    1028/     50A :                     
    1029/     50A :                     	; JR CC, nn
    1030/     50A :                     	; trace operation:
    1031/     50A :                     	;   1. ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1032/     50A :                     	;   2. ea = *REGPC; *(ea+2) = TC;
    1033/     50A :                     
    1034/     50A :                     	; 1
    1035/     50A : 0E 01               	ld	c, 1		; first TC point
    1036/     50C : 2A 4D EF            	ld	hl, (tmpT)
    1037/     50F : CD 18 06            	call	Rel_adr_c
    1038/     512 : CD 52 06            	call	inadr_chk_and_wrt
    1039/     515 : DA 04 06            	jp	c, err_trace_seq
    1040/     518 :                     
    1041/     518 :                     	; 2
    1042/     518 : 0E 02               	ld	c, 2		; second TC point
    1043/     51A : CD 2A 06            	call	insBRK_2op
    1044/     51D : DA 04 06            	jp	c, err_trace_seq
    1045/     520 :                     
    1046/     520 : C3 01 06            	jp	END_INS_TC
    1047/     523 :                     
    1048/     523 :                     	; check 3 byte machine code: branch JP CC, nnnn 16bit literal)
    1049/     523 :                     
    1050/     523 :                     next_bc2:
    1051/     523 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    1052/     526 : 21 89 06            	ld	hl, JPCC_TBLS
    1053/     529 : ED B1               	cpir
    1054/     52B : 20 04               	jr	nz, next_bc21		; not JP CCC
    1055/     52D :                     
    1056/     52D :                     	; JP CC, nnnn
    1057/     52D :                     	; trace operation:
    1058/     52D :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1059/     52D :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1060/     52D :                     
    1061/     52D : 0E 01               	ld	c, 1		; first TC point
    1062/     52F : 18 13               	jr	next_bc222
    1063/     531 :                     
    1064/     531 :                     	; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    1065/     531 :                     
    1066/     531 :                     next_bc21:
    1067/     531 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    1068/     534 : 21 91 06            	ld	hl, CLCC_TBLS
    1069/     537 : ED B1               	cpir
    1070/     539 : 20 1A               	jr	nz, INSTC1		; not CALL CCC
    1071/     53B :                     
    1072/     53B :                     	; CALL CC, nnnn
    1073/     53B :                     	; trace operation:
    1074/     53B :                     	; TM_mode = 'I'
    1075/     53B :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1076/     53B :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1077/     53B :                     	;
    1078/     53B :                     	; TM_mode = 'S'
    1079/     53B :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1080/     53B :                     
    1081/     53B : 0E 01               	ld	c, 1		; first TC point
    1082/     53D : 3A 4A EF            	ld	a, (TM_mode)
    1083/     540 : FE 53               	cp	'S'
    1084/     542 : 28 08               	jr	z, next_bc22	; skip insertion 1.
    1085/     544 :                     
    1086/     544 :                     next_bc222:
    1087/     544 :                     	; 1. ea = *REGPC; *((char *)(ea+1)) = TC;
    1088/     544 : CD 39 06            	call	insBRK_brp
    1089/     547 : DA 04 06            	jp	c, err_trace_seq
    1090/     54A :                     	
    1091/     54A :                     next_bc221:
    1092/     54A :                     	; 2. ea = *REGPC; *(ea+3) = TC;
    1093/     54A : 0E 02               	ld	c, 2		; second TC point
    1094/     54C :                     next_bc22:
    1095/     54C : CD 2F 06            	call	insBRK_3op
    1096/     54F : DA 04 06            	jp	c, err_trace_seq
    1097/     552 :                     
    1098/     552 : C3 01 06            	jp	END_INS_TC
    1099/     555 :                     
    1100/     555 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1101/     555 :                     ; 1 insertion Trace code(TC) 
    1102/     555 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1103/     555 :                     INSTC1:
    1104/     555 :                     	; check 1 byte machine code: branch (return)
    1105/     555 : FE C9               	cp	0C9H		; RET ?
    1106/     557 : 20 0B               	jr	nz, next_bc3	; not RET
    1107/     559 :                     
    1108/     559 :                     	; RET
    1109/     559 :                     	; trace operation:
    1110/     559 :                     	;   ea = *REGSP; *ea = TC;
    1111/     559 : 0E 01               	ld	c, 1		; first TC point
    1112/     55B : CD 45 06            	call	insBRK_sp
    1113/     55E : DA 04 06            	jp	c, err_trace_seq
    1114/     561 : C3 01 06            	jp	END_INS_TC
    1115/     564 :                     
    1116/     564 :                     	; check RST p
    1117/     564 :                     next_bc3:
    1118/     564 : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    1119/     567 : 21 99 06            	ld	hl, RST_TBLS
    1120/     56A : ED B1               	cpir
    1121/     56C : 20 0B               	jr	nz, next_bc4		; not RST p
    1122/     56E :                     
    1123/     56E :                     	; RST p
    1124/     56E :                     	; can't trace: skip trace
    1125/     56E :                     	; trace operation:
    1126/     56E :                     	;   ea = *REGPC; *(ea+1) = TC;
    1127/     56E :                     ;	ld	hl, RST_DMSG
    1128/     56E :                     ;	call	STROUT		; message out "DETECT RST OPCODE"
    1129/     56E : 0E 01               	ld	c, 1		; first TC point
    1130/     570 : CD 25 06            	call	insBRK_1op
    1131/     573 : DA 04 06            	jp	c, err_trace_seq
    1132/     576 :                     	
    1133/     576 : C3 01 06            	jp	END_INS_TC
    1134/     579 :                     
    1135/     579 :                     ;RST_DMSG:
    1136/     579 :                     ;	db	"(RST nn) WILL BE SKIPPED. AND TRACE NEXT OPCODE", CR, LF,00
    1137/     579 :                     
    1138/     579 :                     	; check code 0EDH
    1139/     579 :                     next_bc4:
    1140/     579 : FE ED               	cp	0EDH		; CODE 0EDH ?
    1141/     57B : 20 13               	jr	nz, next_bc5	; not 0EDH
    1142/     57D :                     
    1143/     57D : 23                  	inc	hl
    1144/     57E : 7E                  	ld	a, (hl)
    1145/     57F : FE 45               	cp	45H		; RETN?
    1146/     581 : 28 04               	jr	z, next_bc6	; yes, RETN
    1147/     583 : FE 4D               	cp	4DH		; RETI?
    1148/     585 : 20 09               	jr	nz, next_bc5	; not RETN
    1149/     587 :                     
    1150/     587 :                     	; trace operation:
    1151/     587 :                     	;   ea = *REGSP; *ea = TC;
    1152/     587 :                     next_bc6:
    1153/     587 : 0E 01               	ld	c, 1		; first TC point
    1154/     589 : CD 45 06            	call	insBRK_sp
    1155/     58C : 38 76               	jr	c, err_trace_seq
    1156/     58E : 18 71               	jr	END_INS_TC
    1157/     590 :                     
    1158/     590 :                     	; check JP (HL)
    1159/     590 :                     next_bc5:
    1160/     590 : 2A 4D EF            	ld	hl, (tmpT)
    1161/     593 : 7E                  	ld	a, (hl)
    1162/     594 :                     
    1163/     594 : FE E9               	cp	0E9H		; JP (HL) ?
    1164/     596 : 20 0C               	jr	nz, next_bc7	; not JP (HL)
    1165/     598 :                     
    1166/     598 :                     	; JP (HL)
    1167/     598 :                     	; trace operation:
    1168/     598 :                     	;   ea = *REGHL; *ea = TC;
    1169/     598 : 2A 22 EF            	ld	hl, (REGHL)
    1170/     59B :                     djphl:
    1171/     59B : 0E 01               	ld	c, 1		; first TC point
    1172/     59D : CD 52 06            	call	inadr_chk_and_wrt
    1173/     5A0 : 38 62               	jr	c, err_trace_seq
    1174/     5A2 : 18 5D               	jr	END_INS_TC
    1175/     5A4 :                     
    1176/     5A4 :                     	; check JP (IX)
    1177/     5A4 :                     next_bc7:
    1178/     5A4 : FE DD               	cp	0DDH		; 1st OPOCDE 0DDH ?
    1179/     5A6 : 20 0B               	jr	nz, next_bc8	; no 0DDH
    1180/     5A8 : 23                  	inc	hl
    1181/     5A9 : 7E                  	ld	a, (hl)
    1182/     5AA : FE E9               	cp	0E9H		; JP (IX) ?
    1183/     5AC : 20 05               	jr	nz, next_bc8	; not JP (IX)
    1184/     5AE :                     
    1185/     5AE :                     	; JP (IX)
    1186/     5AE :                     	; trace operation:
    1187/     5AE :                     	;   ea = *REGIX; *ea = TC;
    1188/     5AE : 2A 2C EF            	ld	hl, (REGIX)
    1189/     5B1 : 18 E8               	jr	djphl
    1190/     5B3 :                     
    1191/     5B3 :                     	; check JP (IY)
    1192/     5B3 :                     next_bc8:
    1193/     5B3 : 2A 4D EF            	ld	hl, (tmpT)
    1194/     5B6 : 7E                  	ld	a, (hl)
    1195/     5B7 :                     
    1196/     5B7 : FE FD               	cp	0FDH		; 1st OPOCDE 0FDH ?
    1197/     5B9 : 20 0B               	jr	nz, next_bc9	; no 0FDH
    1198/     5BB : 23                  	inc	hl
    1199/     5BC : 7E                  	ld	a, (hl)
    1200/     5BD : FE E9               	cp	0E9H		; JP (IX) ?
    1201/     5BF : 20 05               	jr	nz, next_bc9	; not JP (IX)
    1202/     5C1 :                     
    1203/     5C1 :                     	; JP (IY)
    1204/     5C1 :                     	; trace operation:
    1205/     5C1 :                     	;   ea = *REGIY; *ea = TC;
    1206/     5C1 : 2A 2E EF            	ld	hl, (REGIY)
    1207/     5C4 : 18 D5               	jr	djphl
    1208/     5C6 :                     
    1209/     5C6 :                     	; check JR relative
    1210/     5C6 :                     next_bc9:
    1211/     5C6 : 2A 4D EF            	ld	hl, (tmpT)
    1212/     5C9 : 7E                  	ld	a, (hl)
    1213/     5CA : FE 18               	cp	18H		; JR relative ?
    1214/     5CC : 20 0C               	jr	nz, next_bc10	; not JR relative
    1215/     5CE :                     
    1216/     5CE :                     	; JR Relative
    1217/     5CE :                     	; trace operation:
    1218/     5CE :                     	;   ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1219/     5CE : 0E 01               	ld	c, 1		; first TC point
    1220/     5D0 : CD 18 06            	call	Rel_adr_c
    1221/     5D3 : CD 52 06            	call	inadr_chk_and_wrt
    1222/     5D6 : 38 2C               	jr	c, err_trace_seq
    1223/     5D8 : 18 27               	jr	END_INS_TC
    1224/     5DA :                     
    1225/     5DA :                     	; check JP literal
    1226/     5DA :                     next_bc10:
    1227/     5DA : FE C3               	cp	0C3H		; JP literal ?
    1228/     5DC : 20 09               	jr	nz, next_bc11	; not JP literal
    1229/     5DE :                     
    1230/     5DE :                     	; JP literal
    1231/     5DE :                     	; trace operation:
    1232/     5DE :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1233/     5DE : 0E 01               	ld	c, 1		; first TC point
    1234/     5E0 : CD 39 06            	call	insBRK_brp
    1235/     5E3 : 38 1F               	jr	c, err_trace_seq
    1236/     5E5 : 18 1A               	jr	END_INS_TC
    1237/     5E7 :                     
    1238/     5E7 :                     	; check call literal
    1239/     5E7 :                     next_bc11:
    1240/     5E7 : FE CD               	cp	0CDH		; CALL literal ?
    1241/     5E9 : C2 A1 06            	jp	nz, INS2	; no, check not branch opcode 
    1242/     5EC :                     
    1243/     5EC :                     	; CALL literal
    1244/     5EC :                     	; trace operation:
    1245/     5EC :                     	; TM_mode = 'I'
    1246/     5EC :                     	;   ea = *REGPC; *((short *)(ea+1)) = TC;
    1247/     5EC :                     	; TM_mode = 'S'
    1248/     5EC :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1249/     5EC :                     
    1250/     5EC : 0E 01               	ld	c, 1		; first TC point
    1251/     5EE : 3A 4A EF            	ld	a, (TM_mode)
    1252/     5F1 : FE 53               	cp	'S'
    1253/     5F3 : 28 07               	jr	z, next_bc111	; yes, TM_mode='S'
    1254/     5F5 :                     
    1255/     5F5 :                     	; TM_mode = 'I'
    1256/     5F5 :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1257/     5F5 : CD 39 06            	call	insBRK_brp
    1258/     5F8 : 38 0A               	jr	c, err_trace_seq
    1259/     5FA : 18 05               	jr	END_INS_TC
    1260/     5FC :                     
    1261/     5FC :                     	; TM_mode = 'S'
    1262/     5FC :                     	; ea = *REGPC; *(ea+3) = TC;
    1263/     5FC :                     next_bc111:
    1264/     5FC : CD 2F 06            	call	insBRK_3op
    1265/     5FF : 38 03               	jr	c, err_trace_seq
    1266/     601 :                     
    1267/     601 :                     END_INS_TC:
    1268/     601 : C3 89 14            	jp	G0	; go, trace operation
    1269/     604 :                     
    1270/     604 :                     err_trace_seq:
    1271/     604 : 21 0E 06            	ld	hl, terr_msg
    1272/     607 : CD 02 26            	call	STROUT
    1273/     60A : C3 2C 01            	JP	WSTART
    1274/     60D : FF                  	rst	38h
    1275/     60E :                     ;	
    1276/     60E : 41 64 72 20 45 52   terr_msg:	db	"Adr ERR", CR, LF, 00H
              614 : 52 0D 0A 00       
    1277/     618 :                     
    1278/     618 :                     ;--------------------------------------
    1279/     618 :                     ; 2 byte machine code branch
    1280/     618 :                     ; - 2nd byte is Relative address
    1281/     618 :                     ; - input hl : opecode address
    1282/     618 :                     ; - output hl : target address
    1283/     618 :                     ;--------------------------------------
    1284/     618 :                     Rel_adr_c:
    1285/     618 : 23                  	inc	hl
    1286/     619 : 5E                  	ld	e, (hl)		; e = 2nd operand
    1287/     61A : 23                  	inc	hl		; hl = PC + 2
    1288/     61B : 16 FF               	ld	d, 0ffh
    1289/     61D : CB 7B               	bit	7, e		; test msb bit
    1290/     61F : 20 02               	jr	nz, exp_msb	; 
    1291/     621 : 16 00               	ld	d, 0
    1292/     623 :                     exp_msb:
    1293/     623 : 19                  	add	hl, de
    1294/     624 : C9                  	ret
    1295/     625 :                     
    1296/     625 :                     ;--------------------------------------
    1297/     625 :                     ; 1 byte op code, insert TC
    1298/     625 :                     ; ea = *REGPC; *(ea+1) = TC
    1299/     625 :                     ;--------------------------------------
    1300/     625 :                     insBRK_1op:
    1301/     625 :                     ;	ld	hl, (REGPC)
    1302/     625 : 2A 4D EF            	ld	hl, (tmpT)
    1303/     628 : 18 0A               	jr	ib1
    1304/     62A :                     	
    1305/     62A :                     ;--------------------------------------
    1306/     62A :                     ; 2 byte op code, insert TC
    1307/     62A :                     ; ea = *REGPC; *(ea+2) = TC
    1308/     62A :                     ;--------------------------------------
    1309/     62A :                     insBRK_2op:
    1310/     62A :                     ;	ld	hl, (REGPC)
    1311/     62A : 2A 4D EF            	ld	hl, (tmpT)
    1312/     62D : 18 04               	jr	ib2
    1313/     62F :                     	
    1314/     62F :                     ;--------------------------------------
    1315/     62F :                     ; 3 byte op code, insert TC
    1316/     62F :                     ; ea = *REGPC; *(ea+3) = TC;
    1317/     62F :                     ;--------------------------------------
    1318/     62F :                     insBRK_3op:
    1319/     62F :                     ;	ld	hl, (REGPC)
    1320/     62F : 2A 4D EF            	ld	hl, (tmpT)
    1321/     632 :                     ib3:
    1322/     632 : 23                  	inc	hl
    1323/     633 :                     ib2:
    1324/     633 : 23                  	inc	hl
    1325/     634 :                     ib1:
    1326/     634 : 23                  	inc	hl
    1327/     635 : CD 52 06            	call	inadr_chk_and_wrt
    1328/     638 : C9                  	ret
    1329/     639 :                     
    1330/     639 :                     ;--------------------------------------
    1331/     639 :                     ; 3 byte op code, insert TC in branch point
    1332/     639 :                     ; ea = *REGPC; *((char *)(ea+1)) = TC;
    1333/     639 :                     ;--------------------------------------
    1334/     639 :                     insBRK_brp:
    1335/     639 :                     ;	ld	hl, (REGPC)
    1336/     639 : 2A 4D EF            	ld	hl, (tmpT)
    1337/     63C : 23                  	inc	hl
    1338/     63D : 5E                  	ld	e, (hl)
    1339/     63E : 23                  	inc	hl
    1340/     63F : 56                  	ld	d, (hl)
    1341/     640 : EB                  	ex	de,  hl
    1342/     641 : CD 52 06            	call	inadr_chk_and_wrt
    1343/     644 : C9                  	ret
    1344/     645 :                     
    1345/     645 :                     ;--------------------------------------
    1346/     645 :                     ; insert TC at SP
    1347/     645 :                     ; ea = *REGSP; *ea = TC;
    1348/     645 :                     ;--------------------------------------
    1349/     645 :                     insBRK_sp:
    1350/     645 : ED 5B 30 EF         	ld	de, (REGSP)
    1351/     649 : 1A                  	ld	a, (de)
    1352/     64A : 6F                  	ld	l, a
    1353/     64B : 13                  	inc	de
    1354/     64C : 1A                  	ld	a, (de)
    1355/     64D : 67                  	ld	h, a		; hl = *sp
    1356/     64E : CD 52 06            	call	inadr_chk_and_wrt
    1357/     651 : C9                  	ret
    1358/     652 :                     
    1359/     652 :                     ;--------------------------------------
    1360/     652 :                     ; check (HL) is RAM AREA
    1361/     652 :                     ; insert Trace code at (HL)
    1362/     652 :                     ;--------------------------------------
    1363/     652 :                     inadr_chk_and_wrt:
    1364/     652 :                     
    1365/     652 : =>TRUE              	IF SuperMEZ80 = 0
    1366/     652 : 7C                  	ld	a, h
    1367/     653 : FE C0               	cp	RAM_B >> 8		; 80H
    1368/     655 : 38 23               	jr	c, NO_RAM_AREA
    1369/     657 : FE EF               	cp	RAM_E >> 8		; 8FH
    1370/     659 : 30 1F               	jr	nc, NO_RAM_AREA
    1371/     65B : [1365]              	ENDIF
    1372/     65B :                     	
    1373/     65B : 79                  	ld	a, c
    1374/     65C : FE 01               	cp	1		;first save?
    1375/     65E : 20 0D               	jr	nz, icka1
    1376/     660 : 11 50 EF            	ld	de, tpt1_f
    1377/     663 : 12                  	ld	(de), a		; set trace ON
    1378/     664 : 22 52 EF            	ld	(tpt1_adr), hl
    1379/     667 : 7E                  	ld	a, (hl)		; get opcode
    1380/     668 : 32 51 EF            	ld	(tpt1_op), a	; save opcode
    1381/     66B : 18 0B               	jr	icka_end
    1382/     66D :                     icka1:
    1383/     66D : 11 54 EF            	ld	de, tpt2_f
    1384/     670 : 12                  	ld	(de), a		; set trace ON
    1385/     671 : 22 56 EF            	ld	(tpt2_adr), hl
    1386/     674 : 7E                  	ld	a, (hl)		; get opcode
    1387/     675 : 32 55 EF            	ld	(tpt2_op), a	; save opcode
    1388/     678 :                     icka_end:
    1389/     678 : AF                  	xor	a
    1390/     679 : C9                  	ret
    1391/     67A :                     
    1392/     67A :                     NO_RAM_AREA:
    1393/     67A : 37                  	SCF
    1394/     67B : C9                  	ret
    1395/     67C :                     	
    1396/     67C :                     
    1397/     67C :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1398/     67C :                     ; 2 insertion TC TABLE
    1399/     67C :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1400/     67C :                     ;
    1401/     67C :                     ; 1 byte machine code: branch (RET CC)
    1402/     67C :                     RETCC_TBLS:
    1403/     67C : C0                  	DB	0C0H	; RET	NZ
    1404/     67D : C8                  	DB	0C8H	; RET	Z
    1405/     67E : D0                  	DB	0D0H	; RET	NC
    1406/     67F : D8                  	DB	0D8H	; RET	C
    1407/     680 : E0                  	DB	0E0H	; RET	PO
    1408/     681 : E8                  	DB	0E8H	; RET	PE
    1409/     682 : F0                  	DB	0F0H	; RET	P
    1410/     683 : F8                  	DB	0F8H	; RET	M
    1411/     684 :                     RETCC_TBLE:
    1412/     684 :                     
    1413/     684 :                     ; 2 byte machine code: branch (JR CC, Relative)
    1414/     684 :                     JRCC_TBLS:
    1415/     684 : 10                  	DB	10H	; DJNZ	$
    1416/     685 :                     JRCC_TBLS1:
    1417/     685 : 20                  	DB	20H	; JR	NZ,$
    1418/     686 : 28                  	DB	28H	; JR	Z,$
    1419/     687 : 30                  	DB	30H	; JR	NC,$
    1420/     688 : 38                  	DB	38H	; JR	C,$
    1421/     689 :                     JRCC_TBLE:
    1422/     689 :                     
    1423/     689 :                     ; 3 byte machine code: branch (JP CC, 16bit literal)
    1424/     689 :                     JPCC_TBLS:
    1425/     689 : C2                  	DB	0C2H	; JP	NZ,1234H
    1426/     68A : CA                  	DB	0CAH	; JP	Z,1234H
    1427/     68B : D2                  	DB	0D2H	; JP	NC,1234H
    1428/     68C : DA                  	DB	0DAH	; JP	C,1234H
    1429/     68D : E2                  	DB	0E2H	; JP	PO,1234H
    1430/     68E : EA                  	DB	0EAH	; JP	PE,1234H
    1431/     68F : F2                  	DB	0F2H	; JP	P,1234H
    1432/     690 : FA                  	DB	0FAH	; JP	M,1234H
    1433/     691 :                     JPCC_TBLE:
    1434/     691 :                     
    1435/     691 :                     ; (call 16bit literal)
    1436/     691 :                     CLCC_TBLS:
    1437/     691 : C4                  	DB	0C4H	; CALL	NZ,1234H
    1438/     692 : CC                  	DB	0CCH	; CALL	Z,1234H
    1439/     693 : D4                  	DB	0D4H	; CALL	NC,1234H
    1440/     694 : DC                  	DB	0DCH	; CALL	C,1234H
    1441/     695 : E4                  	DB	0E4H	; CALL	PO,1234H
    1442/     696 : EC                  	DB	0ECH	; CALL	PE,1234H
    1443/     697 : F4                  	DB	0F4H	; CALL	P,1234H
    1444/     698 : FC                  	DB	0FCH	; CALL	M,1234H
    1445/     699 :                     CLCC_TBLE:
    1446/     699 :                     
    1447/     699 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1448/     699 :                     ; 1 insertion TC TABLE
    1449/     699 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1450/     699 :                     
    1451/     699 :                     ; restart
    1452/     699 :                     RST_TBLS:
    1453/     699 : C7                  	DB	0C7H	; RST	00H
    1454/     69A : CF                  	DB	0CFH	; RST	08H
    1455/     69B : D7                  	DB	0D7H	; RST	10H
    1456/     69C : DF                  	DB	0DFH	; RST	18H
    1457/     69D : E7                  	DB	0E7H	; RST	20H
    1458/     69E : EF                  	DB	0EFH	; RST	28H
    1459/     69F : F7                  	DB	0F7H	; RST	30H
    1460/     6A0 : FF                  	DB	0FFH	; RST	38H
    1461/     6A1 :                     RST_TBLE:
    1462/     6A1 :                     
    1463/     6A1 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1464/     6A1 :                     ;;;
    1465/     6A1 :                     ;;; machine code check(except branch)
    1466/     6A1 :                     ;;;
    1467/     6A1 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1468/     6A1 :                     INS2:
    1469/     6A1 :                     
    1470/     6A1 :                     	; 2byte machine code search
    1471/     6A1 : 01 12 00            	ld	bc, TWO_OPTBL_E - TWO_OPTBL
    1472/     6A4 : 21 3A 07            	ld	hl, TWO_OPTBL
    1473/     6A7 : ED B1               	cpir
    1474/     6A9 : CA 15 07            	jp	z, meet_op2
    1475/     6AC :                     
    1476/     6AC :                     	; 3byte machine code search
    1477/     6AC : 01 08 00            	ld	bc, THREE_OPTBL_E - THREE_OPTBL
    1478/     6AF : 21 4C 07            	ld	hl, THREE_OPTBL
    1479/     6B2 : ED B1               	cpir
    1480/     6B4 : CA 20 07            	jp	z, meet_op3
    1481/     6B7 :                     
    1482/     6B7 :                     	; check 0CBH
    1483/     6B7 :                     	
    1484/     6B7 :                     	; readjust hl
    1485/     6B7 : 2A 4D EF            	ld	hl, (tmpT)
    1486/     6BA :                     
    1487/     6BA : FE CB               	cp	0CBH		; opecode 0CBH?
    1488/     6BC : 28 57               	jr	z, meet_op2
    1489/     6BE :                     	
    1490/     6BE :                     	; check 0DDH
    1491/     6BE : FE DD               	cp	0ddh		; opecode 0DDH?
    1492/     6C0 : 28 0A               	jr	z, meet_dd
    1493/     6C2 :                     	
    1494/     6C2 :                     	; check 0EDH
    1495/     6C2 : FE ED               	cp	0edh		; opecode 0EDH?
    1496/     6C4 : 28 28               	jr	z, meet_ed
    1497/     6C6 :                     
    1498/     6C6 :                     	; check 0FDH
    1499/     6C6 : FE FD               	cp	0fdh		; opecode 0FDH?
    1500/     6C8 : 28 02               	jr	z, meet_dd
    1501/     6CA :                     
    1502/     6CA :                     	; 1byte machine code
    1503/     6CA : 18 3E               	jr	meet_op1
    1504/     6CC :                     
    1505/     6CC :                     	; opecode 0DDh
    1506/     6CC :                     meet_dd:
    1507/     6CC : 23                  	inc	hl
    1508/     6CD : 7E                  	ld	a, (hl)	
    1509/     6CE : FE CB               	cp	0cbh		; 2nd 0CBH?
    1510/     6D0 : 28 59               	jr	z, meet_op4
    1511/     6D2 : FE 21               	cp	21h		; 2nd 21H?
    1512/     6D4 : 28 55               	jr	z, meet_op4
    1513/     6D6 : FE 22               	cp	22h		; 2nd 22H?
    1514/     6D8 : 28 51               	jr	z, meet_op4
    1515/     6DA : FE 2A               	cp	2ah		; 2nd 2AH?
    1516/     6DC : 28 4D               	jr	z, meet_op4
    1517/     6DE : FE 36               	cp	36h		; 2nd 36H?
    1518/     6E0 : 28 49               	jr	z, meet_op4
    1519/     6E2 :                     
    1520/     6E2 :                     	; 2nd code search
    1521/     6E2 : 01 0A 00            	ld	bc, DD_2NDTBL_E - DD_2NDTBL
    1522/     6E5 : 21 54 07            	ld	hl, DD_2NDTBL
    1523/     6E8 : ED B1               	cpir
    1524/     6EA : 28 29               	jr	z, meet_op2
    1525/     6EC : 18 32               	jr	meet_op3
    1526/     6EE :                     
    1527/     6EE :                     meet_ed:
    1528/     6EE : 23                  	inc	hl
    1529/     6EF : 7E                  	ld	a, (hl)	
    1530/     6F0 : FE 43               	cp	43h		; 2nd 43H?
    1531/     6F2 : 28 37               	jr	z, meet_op4
    1532/     6F4 : FE 4B               	cp	4bh		; 2nd 4BH?
    1533/     6F6 : 28 33               	jr	z, meet_op4
    1534/     6F8 : FE 53               	cp	53h		; 2nd 53H?
    1535/     6FA : 28 2F               	jr	z, meet_op4
    1536/     6FC : FE 5B               	cp	5bh		; 2nd 5BH?
    1537/     6FE : 28 2B               	jr	z, meet_op4
    1538/     700 : FE 73               	cp	73h		; 2nd 73H?
    1539/     702 : 28 27               	jr	z, meet_op4
    1540/     704 : FE 7B               	cp	7bh		; 2nd 7BH?
    1541/     706 : 28 23               	jr	z, meet_op4
    1542/     708 : 18 0B               	jr	meet_op2
    1543/     70A :                     
    1544/     70A :                     ; 1 machine code
    1545/     70A :                     meet_op1:
    1546/     70A : 0E 01               	ld	c, 1
    1547/     70C : CD 25 06            	call	insBRK_1op
    1548/     70F : DA 04 06            	jp	c, err_trace_seq
    1549/     712 : C3 01 06            	jp	END_INS_TC
    1550/     715 :                     
    1551/     715 :                     ; 2 machine code
    1552/     715 :                     meet_op2:
    1553/     715 : 0E 01               	ld	c, 1
    1554/     717 : CD 2A 06            	call	insBRK_2op
    1555/     71A : DA 04 06            	jp	c, err_trace_seq
    1556/     71D : C3 01 06            	jp	END_INS_TC
    1557/     720 :                     ; 3 machine code
    1558/     720 :                     meet_op3:
    1559/     720 : 0E 01               	ld	c, 1
    1560/     722 : CD 2F 06            	call	insBRK_3op
    1561/     725 : DA 04 06            	jp	c, err_trace_seq
    1562/     728 : C3 01 06            	jp	END_INS_TC
    1563/     72B :                     
    1564/     72B :                     ; 4 machine codee
    1565/     72B :                     meet_op4:
    1566/     72B : 0E 01               	ld	c, 1
    1567/     72D :                     ;	ld	hl, (REGPC)
    1568/     72D : 2A 4D EF            	ld	hl, (tmpT)
    1569/     730 : 23                  	inc	hl
    1570/     731 : CD 32 06            	call	ib3
    1571/     734 : DA 04 06            	jp	c, err_trace_seq
    1572/     737 : C3 01 06            	jp	END_INS_TC
    1573/     73A :                     
    1574/     73A :                     TWO_OPTBL:	; second byte is 8bitliteral[nn]
    1575/     73A :                     ld_r_nn_s:
    1576/     73A : 06                  	DB	06h	; LD	B,nn
    1577/     73B : 0E                  	DB	0Eh	; LD	C,nn
    1578/     73C : 16                  	DB	16h	; LD	D,nn
    1579/     73D : 1E                  	DB	1Eh	; LD	E,nn
    1580/     73E : 26                  	DB	26h	; LD	H,nn
    1581/     73F : 2E                  	DB	2Eh	; LD	L,nn
    1582/     740 : 36                  	DB	36h	; LD	(HL),nn
    1583/     741 : 3E                  	DB	3Eh	; LD	A,nn
    1584/     742 :                     ld_r_nn_e:
    1585/     742 :                     
    1586/     742 :                     log_op_s:
    1587/     742 : C6                  	DB	0C6h	; ADD	A,nn
    1588/     743 : CE                  	DB	0CEh	; ADC	A,nn
    1589/     744 : DE                  	DB	0DEh	; SBC	A,nn
    1590/     745 : D6                  	DB	0D6h	; SUB	nn
    1591/     746 : E6                  	DB	0E6h	; AND	nn
    1592/     747 : EE                  	DB	0EEh	; XOR	nn
    1593/     748 : F6                  	DB	0F6h	; OR	nn
    1594/     749 : FE                  	DB	0FEh	; CP	nn
    1595/     74A : DB                  	DB	0DBh	; IN	A,(nn)
    1596/     74B : D3                  	DB	0D3h	; OUT	(nn),A
    1597/     74C :                     log_op_e:
    1598/     74C :                     TWO_OPTBL_E:
    1599/     74C :                     
    1600/     74C :                     THREE_OPTBL:	; 2nd, 3rd byte is 16bitliteral[nnnn]
    1601/     74C : 01                  	DB	01h	; LD	BC,nnnn
    1602/     74D : 11                  	DB	11h	; LD	DE,nnnn
    1603/     74E : 21                  	DB	21h	; LD	HL,nnnn
    1604/     74F : 31                  	DB	31h	; LD	SP,nnnn
    1605/     750 :                     THREE_OPTBLe
    1606/     750 : 22                  	DB	22h	; LD	(nnnn),HL
    1607/     751 : 32                  	DB	32h	; LD	(nnnn),A
    1608/     752 :                     
    1609/     752 : 2A                  	DB	2Ah	; LD	HL,(nnnn)
    1610/     753 : 3A                  	DB	3Ah	; LD	A,(nnnn)
    1611/     754 :                     THREE_OPTBL_E:
    1612/     754 :                     
    1613/     754 :                     DD_2NDTBL:
    1614/     754 : 09                  	DB	09h	; ADD	IX,BC
    1615/     755 : 19                  	DB	19h	; ADD	IX,DE
    1616/     756 : 29                  	DB	29h	; ADD	IX,IX
    1617/     757 : 39                  	DB	39h	; ADD	IX,SP
    1618/     758 :                     DD_2NDTBL1:
    1619/     758 : 23                  	DB	23h	; INC	IX
    1620/     759 : 2B                  	DB	2Bh	; DEC	IX
    1621/     75A : E5                  	DB	0E5h	; PUSH	IX
    1622/     75B : E1                  	DB	0E1h	; POP	IX
    1623/     75C :                     DD_2NDTBL2:
    1624/     75C : E3                  	DB	0E3h	; EX	(SP),IX
    1625/     75D : F9                  	DB	0F9h	; LD	SP,IX
    1626/     75E :                     DD_2NDTBL_E:
    1627/     75E :                     
    1628/     75E :                     ;;; 
    1629/     75E :                     ;;; Dump memory
    1630/     75E :                     ;;; 
    1631/     75E :                     
    1632/     75E :                     DUMP:
    1633/     75E : 23                  	INC	HL
    1634/     75F : 7E                  	LD	A,(HL)
    1635/     760 : FE 49               	cp	'I'
    1636/     762 : CA 67 08            	JP	Z,disassemble
    1637/     765 : CD EC 26            	CALL	SKIPSP
    1638/     768 : CD FC 26            	CALL	RDHEX		; 1st arg.
    1639/     76B : 38 06               	jr	c, DP0
    1640/     76D :                     	;; 1st arg. found
    1641/     76D : ED 53 10 EF         	LD	(DSADDR),DE
    1642/     771 : 18 10               	jr	dp00
    1643/     773 :                     
    1644/     773 :                     DP0:	;; No arg. chk
    1645/     773 :                     
    1646/     773 : E5                  	push	hl
    1647/     774 : 2A 10 EF            	LD	HL,(DSADDR)
    1648/     777 : 01 80 00            	LD	BC,128
    1649/     77A : 09                  	ADD	HL,BC
    1650/     77B : 22 12 EF            	LD	(DEADDR),HL
    1651/     77E : E1                  	pop	hl
    1652/     77F : 7E                  	LD	A,(HL)
    1653/     780 : B7                  	OR	A
    1654/     781 : 28 2B               	JR	z, DPM_C	; no arg.
    1655/     783 :                     
    1656/     783 :                     dp00:
    1657/     783 : CD EC 26            	CALL	SKIPSP
    1658/     786 : 7E                  	LD	A,(HL)
    1659/     787 : FE 2C               	CP	','
    1660/     789 : 28 0D               	JR	Z,DP1
    1661/     78B : B7                  	OR	A
    1662/     78C : C2 75 01            	JP	NZ,ERR
    1663/     78F :                     
    1664/     78F :                     	;; No 2nd arg.
    1665/     78F :                     
    1666/     78F : 21 80 00            	LD	HL,128
    1667/     792 : 19                  	ADD	HL,DE
    1668/     793 : 22 12 EF            	LD	(DEADDR),HL
    1669/     796 : 18 16               	JR	DPM_C
    1670/     798 :                     
    1671/     798 :                     DP1:
    1672/     798 : 23                  	INC	HL
    1673/     799 : CD EC 26            	CALL	SKIPSP
    1674/     79C : CD FC 26            	CALL	RDHEX
    1675/     79F : DA 75 01            	jp	c, ERR
    1676/     7A2 : CD EC 26            	CALL	SKIPSP
    1677/     7A5 : B7                  	OR	A
    1678/     7A6 : C2 75 01            	jp	nz, ERR
    1679/     7A9 : 13                  	INC	DE
    1680/     7AA : ED 53 12 EF         	LD	(DEADDR),DE
    1681/     7AE :                     DPM_C:
    1682/     7AE : CD B4 07            	CALL	DPM
    1683/     7B1 : C3 2C 01            	JP	WSTART
    1684/     7B4 :                     
    1685/     7B4 :                     	;; DUMP main
    1686/     7B4 :                     DPM:
    1687/     7B4 : 2A 10 EF            	LD	HL,(DSADDR)
    1688/     7B7 : 3E F0               	LD	A,0F0H
    1689/     7B9 : A5                  	AND	L
    1690/     7BA : 6F                  	LD	L,A
    1691/     7BB : AF                  	XOR	A
    1692/     7BC : 32 14 EF            	LD	(DSTATE),A
    1693/     7BF :                     DPM0:
    1694/     7BF : E5                  	PUSH	HL
    1695/     7C0 : CD E1 07            	CALL	DPL
    1696/     7C3 : E1                  	POP	HL
    1697/     7C4 : 01 10 00            	LD	BC,16
    1698/     7C7 : 09                  	ADD	HL,BC
    1699/     7C8 : CD DF 2E            	CALL	CONST
    1700/     7CB : 20 0E               	JR	NZ,DPM1
    1701/     7CD : 3A 14 EF            	LD	A,(DSTATE)
    1702/     7D0 : FE 02               	CP	2
    1703/     7D2 : 38 EB               	JR	C,DPM0
    1704/     7D4 : 2A 12 EF            	LD	HL,(DEADDR)
    1705/     7D7 : 22 10 EF            	LD	(DSADDR),HL
    1706/     7DA : C9                  	RET
    1707/     7DB :                     DPM1:
    1708/     7DB : 22 10 EF            	LD	(DSADDR),HL
    1709/     7DE : C3 D4 2E            	JP	CONIN
    1710/     7E1 :                     
    1711/     7E1 :                     DPL:
    1712/     7E1 :                     	;; DUMP line
    1713/     7E1 : CD 0B 26            	CALL	HEXOUT4
    1714/     7E4 : E5                  	PUSH	HL
    1715/     7E5 : 21 9F 2C            	LD	HL,DSEP0
    1716/     7E8 : CD 02 26            	CALL	STROUT
    1717/     7EB : E1                  	POP	HL
    1718/     7EC : DD 21 8D EF         	LD	IX,INBUF
    1719/     7F0 : 06 10               	LD	B,16
    1720/     7F2 :                     DPL0:
    1721/     7F2 : CD 1B 08            	CALL	DPB
    1722/     7F5 : 10 FB               	DJNZ	DPL0
    1723/     7F7 :                     
    1724/     7F7 : 21 A2 2C            	LD	HL,DSEP1
    1725/     7FA : CD 02 26            	CALL	STROUT
    1726/     7FD :                     
    1727/     7FD : 21 8D EF            	LD	HL,INBUF
    1728/     800 : 06 10               	LD	B,16
    1729/     802 :                     DPL1:
    1730/     802 : 7E                  	LD	A,(HL)
    1731/     803 : 23                  	INC	HL
    1732/     804 : FE 20               	CP	' '
    1733/     806 : 38 09               	JR	C,DPL2
    1734/     808 : FE 7F               	CP	7FH
    1735/     80A : 30 05               	JR	NC,DPL2
    1736/     80C : CD E5 2E            	CALL	CONOUT
    1737/     80F : 18 05               	JR	DPL3
    1738/     811 :                     DPL2:
    1739/     811 : 3E 2E               	LD	A,'.'
    1740/     813 : CD E5 2E            	CALL	CONOUT
    1741/     816 :                     DPL3:
    1742/     816 : 10 EA               	DJNZ	DPL1
    1743/     818 : C3 4B 26            	JP	CRLF
    1744/     81B :                     
    1745/     81B :                     DPB:	; Dump byte
    1746/     81B : 3E 20               	LD	A,' '
    1747/     81D : CD E5 2E            	CALL	CONOUT
    1748/     820 : 3A 14 EF            	LD	A,(DSTATE)
    1749/     823 : B7                  	OR	A
    1750/     824 : 20 20               	JR	NZ,DPB2
    1751/     826 :                     	; Dump state 0
    1752/     826 : 3A 10 EF            	LD	A,(DSADDR)	; Low byte
    1753/     829 : BD                  	CP	L
    1754/     82A : 20 06               	JR	NZ,DPB0
    1755/     82C : 3A 11 EF            	LD	A,(DSADDR+1)	; High byte
    1756/     82F : BC                  	CP	H
    1757/     830 : 28 0F               	JR	Z,DPB1
    1758/     832 :                     DPB0:	; Still 0 or 2
    1759/     832 : 3E 20               	LD	A,' '
    1760/     834 : CD E5 2E            	CALL	CONOUT
    1761/     837 : CD E5 2E            	CALL	CONOUT
    1762/     83A : DD 77 00            	LD	(IX),A
    1763/     83D : 23                  	INC	HL
    1764/     83E : DD 23               	INC	IX
    1765/     840 : C9                  	RET
    1766/     841 :                     DPB1:	; Found start address
    1767/     841 : 3E 01               	LD	A,1
    1768/     843 : 32 14 EF            	LD	(DSTATE),A
    1769/     846 :                     DPB2:
    1770/     846 : 3A 14 EF            	LD	A,(DSTATE)
    1771/     849 : FE 01               	CP	1
    1772/     84B : 20 E5               	JR	NZ,DPB0
    1773/     84D :                     	; Dump state 1
    1774/     84D : 7E                  	LD	A,(HL)
    1775/     84E : DD 77 00            	LD	(IX),A
    1776/     851 : CD 10 26            	CALL	HEXOUT2
    1777/     854 : 23                  	INC	HL
    1778/     855 : DD 23               	INC	IX
    1779/     857 : 3A 12 EF            	LD	A,(DEADDR)	; Low byte
    1780/     85A : BD                  	CP	L
    1781/     85B : C0                  	RET	NZ
    1782/     85C : 3A 13 EF            	LD	A,(DEADDR+1)	; High byte
    1783/     85F : BC                  	CP	H
    1784/     860 : C0                  	RET	NZ
    1785/     861 :                     	; Found end address
    1786/     861 : 3E 02               	LD	A,2
    1787/     863 : 32 14 EF            	LD	(DSTATE),A
    1788/     866 : C9                  	RET
    1789/     867 :                     
    1790/     867 :                     ;;;
    1791/     867 :                     ;;; Disassemble
    1792/     867 :                     ;;; 
    1793/     867 :                     
    1794/     867 :                     
    1795/     867 :                     ; DI[<address>][,s<steps>|<end address>]
    1796/     867 :                     
    1797/     867 :                     disassemble:
    1798/     867 : 23                  	INC	HL
    1799/     868 : CD EC 26            	CALL	SKIPSP
    1800/     86B : CD FC 26            	CALL	RDHEX		; 1st arg.
    1801/     86E : 30 14               	jr	nc, get_DI1
    1802/     870 :                     
    1803/     870 :                     di_nxt:
    1804/     870 :                     	;; No arg. chk
    1805/     870 : CD EC 26            	CALL	SKIPSP
    1806/     873 : 7E                  	LD	A,(HL)
    1807/     874 : B7                  	OR	A
    1808/     875 : 20 13               	jr	NZ, chk_DI1	; ',' check
    1809/     877 :                     
    1810/     877 :                     ; No arg
    1811/     877 : 26 00               	ld	h, 0
    1812/     879 : 2E 0A               	ld	l, 10
    1813/     87B : 7D                  	ld	a, l
    1814/     87C : 32 85 EF            	ld	(dasm_stpf), a	; set step flag
    1815/     87F : 22 83 EF            	ld	(dasm_ed), hl	; set 10 steps
    1816/     882 : 18 33               	jr	DISASM_go
    1817/     884 :                     
    1818/     884 :                     ; 1st arg
    1819/     884 :                     get_DI1:
    1820/     884 : ED 53 86 EF         	ld	(dasm_adr), de	; save start address
    1821/     888 :                     ;	INC	HL
    1822/     888 : 18 E6               	jr	di_nxt
    1823/     88A :                     
    1824/     88A :                     chk_DI1:
    1825/     88A : FE 2C               	cp	','
    1826/     88C : C2 75 01            	jp	nz, ERR
    1827/     88F :                     
    1828/     88F :                     ; check 2nd arg
    1829/     88F :                     
    1830/     88F : 23                  	INC	HL
    1831/     890 : CD EC 26            	CALL	SKIPSP
    1832/     893 : FE 53               	cp	'S'
    1833/     895 : 20 12               	jr	nz, chk_stpDI
    1834/     897 :                     
    1835/     897 :                     ; step arg
    1836/     897 : 3E 01               	ld	a, 1
    1837/     899 : 32 85 EF            	ld	(dasm_stpf), a	; set step flag
    1838/     89C : 23                  	inc	hl
    1839/     89D : CD BB 02            	call	GET_NUM		; get decimal number to binary
    1840/     8A0 : DA 75 01            	jp	c, ERR
    1841/     8A3 : ED 43 83 EF         	ld	(dasm_ed), bc	; set steps
    1842/     8A7 : 18 0E               	jr	DISASM_go
    1843/     8A9 :                     
    1844/     8A9 :                     chk_stpDI:
    1845/     8A9 : CD FC 26            	CALL	RDHEX		; 2nd arg.
    1846/     8AC : DA 75 01            	jp	c, ERR
    1847/     8AF : ED 53 83 EF         	ld	(dasm_ed), de	; set end address
    1848/     8B3 : AF                  	xor	a
    1849/     8B4 : 32 85 EF            	ld	(dasm_stpf), a	; clear step flag
    1850/     8B7 :                     
    1851/     8B7 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1852/     8B7 :                     ; operation Disassemble
    1853/     8B7 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1854/     8B7 :                     
    1855/     8B7 :                     DISASM_go:
    1856/     8B7 : CD DF 2E            	call	CONST
    1857/     8BA : 28 06               	jr	z, dis_go1
    1858/     8BC : CD D4 2E            	call	CONIN		;discard key
    1859/     8BF : C3 2C 01            	jp	WSTART		; exit disasm command
    1860/     8C2 :                     
    1861/     8C2 :                     dis_go1:
    1862/     8C2 :                     	; get opcode
    1863/     8C2 : CD 46 09            	call	dis_analysis
    1864/     8C5 : CD 0B 09            	call	mk_adr_str	; conout address and machine code
    1865/     8C8 :                     				; *dasm_adr is next opcode address
    1866/     8C8 : 21 8D EF            	ld	hl, adr_mc_buf
    1867/     8CB : CD 02 26            	call	STROUT		; conout disassemble strings
    1868/     8CE :                     
    1869/     8CE : 3A 85 EF            	ld	a, (dasm_stpf)
    1870/     8D1 : B7                  	or	a
    1871/     8D2 : 20 0E               	jr	nz, calc_dis_step
    1872/     8D4 :                     	
    1873/     8D4 :                     	; *dasm_adr > *dasm_ed ?, yes, finish
    1874/     8D4 : 2A 83 EF            	ld	hl, (dasm_ed)
    1875/     8D7 : ED 4B 86 EF         	ld	bc, (dasm_adr)
    1876/     8DB : ED 42               	sbc	hl, bc
    1877/     8DD : 30 D8               	jr	nc, DISASM_go
    1878/     8DF : C3 2C 01            	jp	WSTART
    1879/     8E2 :                     
    1880/     8E2 :                     calc_dis_step:
    1881/     8E2 : 2A 83 EF            	ld	hl, (dasm_ed)
    1882/     8E5 : 2B                  	dec	hl
    1883/     8E6 : 22 83 EF            	ld	(dasm_ed), hl
    1884/     8E9 : 7C                  	ld	a, h
    1885/     8EA : B5                  	or	l
    1886/     8EB : 20 CA               	jr	nz, DISASM_go
    1887/     8ED : C3 2C 01            	jp	WSTART
    1888/     8F0 :                     
    1889/     8F0 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1890/     8F0 :                     ; Disassemble and maked strings to user buffer
    1891/     8F0 :                     ; input de : user buffer
    1892/     8F0 :                     ;       hl : disassemble address
    1893/     8F0 :                     ; output de : next MC address
    1894/     8F0 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1895/     8F0 :                     get_disasm_st:
    1896/     8F0 : 22 86 EF            	ld	(dasm_adr), hl
    1897/     8F3 : D5                  	push	de
    1898/     8F4 : CD 46 09            	call	dis_analysis
    1899/     8F7 : CD 0B 09            	call	mk_adr_str	; conout address and machine code
    1900/     8FA : D1                  	pop	de
    1901/     8FB : 21 8D EF            	ld	hl, adr_mc_buf
    1902/     8FE : 01 2A 00            	ld	bc, dasm_be - dasm_bs
    1903/     901 : ED B0               	ldir
    1904/     903 : ED 5B 86 EF         	ld	de, (dasm_adr)
    1905/     907 : 3A 8C EF            	ld	a, (mc_Size)
    1906/     90A : C9                  	ret
    1907/     90B :                     
    1908/     90B :                     ;-------------------------------------------------
    1909/     90B :                     ; Make address and machine code at adr_mc_buf
    1910/     90B :                     ; "XXXX XX XX XX XX " (17bytes)
    1911/     90B :                     ;-------------------------------------------------
    1912/     90B :                     mk_adr_str:
    1913/     90B : 21 8D EF            	ld	hl, adr_mc_buf
    1914/     90E : ED 5B 86 EF         	ld	de, (dasm_adr)
    1915/     912 : CD E6 10            	call	hex4str		; address XXXX
    1916/     915 : CD 76 11            	call	ins_spcR
    1917/     918 : CD 76 11            	call	ins_spcR
    1918/     91B :                     
    1919/     91B : 06 04               	ld	b, 4
    1920/     91D : 3A 8C EF            	ld	a, (mc_Size)
    1921/     920 : 4F                  	ld	c, a
    1922/     921 :                     mas_1:
    1923/     921 : 1A                  	ld	a, (de)
    1924/     922 : 13                  	inc	de
    1925/     923 :                     
    1926/     923 : D5                  	push	de
    1927/     924 : 5F                  	ld	e, a
    1928/     925 : CD EE 10            	call	hex2str		; MC XX
    1929/     928 : CD 76 11            	call	ins_spcR
    1930/     92B : D1                  	pop	de
    1931/     92C :                     
    1932/     92C : 05                  	dec	b
    1933/     92D : 28 0F               	jr	z, mas_3	; end
    1934/     92F : 0D                  	dec	c
    1935/     930 : 20 EF               	jr	nz, mas_1
    1936/     932 :                     
    1937/     932 :                     mas_2:	
    1938/     932 : CD 76 11            	call	ins_spcR
    1939/     935 : CD 76 11            	call	ins_spcR
    1940/     938 : CD 76 11            	call	ins_spcR
    1941/     93B : 05                  	dec	b
    1942/     93C : 20 F4               	jr	nz, mas_2
    1943/     93E :                     mas_3:
    1944/     93E : CD 76 11            	call	ins_spcR
    1945/     941 : ED 53 86 EF         	ld	(dasm_adr), de	; set next analysis address
    1946/     945 : C9                  	ret
    1947/     946 :                     
    1948/     946 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1949/     946 :                     ; dis assemble analysis
    1950/     946 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1951/     946 :                     
    1952/     946 :                     dis_analysis:
    1953/     946 :                     
    1954/     946 :                     	; pre init string buffer
    1955/     946 :                     
    1956/     946 : 3E 01               	ld	a, 1
    1957/     948 : 32 8C EF            	ld	(mc_Size), a
    1958/     94B :                     
    1959/     94B : 11 45 12            	ld	de, LDstr	; insert LD string
    1960/     94E : CD 0A 11            	call	mkopcstr
    1961/     951 :                     
    1962/     951 : 21 A8 EF            	ld	hl, dasm_OprStr
    1963/     954 : CD 36 11            	call	insPostStr	; CR, LF, 00h
    1964/     957 :                     
    1965/     957 : 2A 86 EF            	ld	hl, (dasm_adr)
    1966/     95A : 7E                  	ld	a, (hl)		; get opcode
    1967/     95B :                     
    1968/     95B :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1969/     95B :                     	; analysys 1 byte MC
    1970/     95B :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1971/     95B :                     
    1972/     95B :                     ;  check no operand
    1973/     95B :                     
    1974/     95B : 01 0D 00            	ld	bc, oth_1op_e - oth_1op_s
    1975/     95E : 21 89 11            	ld	hl, oth_1op_s
    1976/     961 : ED B1               	cpir
    1977/     963 : 20 12               	jr	nz, chk_ld
    1978/     965 :                     
    1979/     965 :                     ;  no operand
    1980/     965 :                     
    1981/     965 : 21 98 13            	ld	hl, oth_1op_tbl
    1982/     968 : CD 8C 10            	call	get_strBufpoint
    1983/     96B : C3 0A 11            	jp	mkopcstr
    1984/     96E :                     
    1985/     96E :                     get_r_num:
    1986/     96E : E6 38               	and	38H
    1987/     970 : 0F                  	rrca
    1988/     971 : 0F                  	rrca
    1989/     972 : 0F                  	rrca
    1990/     973 : 4F                  	ld	c, a
    1991/     974 : 06 00               	ld	b, 0		; bc ; register No.
    1992/     976 : C9                  	ret
    1993/     977 :                     ;
    1994/     977 :                     ; LD opecode
    1995/     977 :                     ;
    1996/     977 :                     
    1997/     977 :                     ; check LD "A,(BC)", "A,(DE)", "(BC),A", "(DE),A", "SP,HL"
    1998/     977 :                     
    1999/     977 :                     chk_ld:
    2000/     977 : FE 0A               	cp	0AH	; LD	A,(BC)
    2001/     979 : 28 19               	jr	z, ld_a_kbck
    2002/     97B : FE 1A               	cp	1AH	; LD	A,(DE)
    2003/     97D : 28 23               	jr	z, ld_a_kdek
    2004/     97F : FE 02               	cp	02H	; LD	(BC),A
    2005/     981 : 28 24               	jr	z, ld_kbck_a
    2006/     983 : FE 12               	cp	12H	; LD	(DE),A
    2007/     985 : 28 29               	jr	z, ld_kdek_a
    2008/     987 : FE F9               	cp	0F9H	; LD	SP,HL
    2009/     989 : 20 2A               	jr	nz, chk_ld1
    2010/     98B :                     
    2011/     98B :                     ; LD SP, HL
    2012/     98B : 11 CA 2E            	ld	de, RNSP
    2013/     98E : CD 5D 11            	call	mk_rcs		; "SP, "
    2014/     991 : C3 30 11            	jp	hl_crlf
    2015/     994 :                     	
    2016/     994 :                     ; LD A, (BC)
    2017/     994 :                     ld_a_kbck:
    2018/     994 : 11 89 2E            	ld	de, RNBC
    2019/     997 :                     ld_a_kxxk:
    2020/     997 : D5                  	push	de
    2021/     998 : CD 5A 11            	call	a_colon_sp	; "A, "
    2022/     99B : D1                  	pop	de
    2023/     99C : CD 44 11            	call	mk_krk		; "(BC)", "(DE)"
    2024/     99F : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2025/     9A2 :                     
    2026/     9A2 :                     ; LD A, (DE)
    2027/     9A2 :                     ld_a_kdek:
    2028/     9A2 : 11 90 2E            	ld	de, RNDE
    2029/     9A5 : 18 F0               	jr	ld_a_kxxk
    2030/     9A7 :                     
    2031/     9A7 :                     ; LD (BC), A
    2032/     9A7 :                     ld_kbck_a:
    2033/     9A7 : 11 89 2E            	ld	de, RNBC
    2034/     9AA :                     
    2035/     9AA :                     ld_kxxk_a:
    2036/     9AA : CD 4C 11            	call	mk_krkcs	; "(BC), ", "(DE), "
    2037/     9AD : C3 25 11            	jp	a_crlf		; "A",CR,LF
    2038/     9B0 :                     
    2039/     9B0 :                     ; LD (DE), A
    2040/     9B0 :                     ld_kdek_a:
    2041/     9B0 : 11 90 2E            	ld	de, RNDE
    2042/     9B3 : 18 F5               	jr	ld_kxxk_a
    2043/     9B5 :                     
    2044/     9B5 :                     ; check other 1byte LD MC
    2045/     9B5 :                     
    2046/     9B5 :                     chk_ld1:
    2047/     9B5 : FE 40               	cp	40h
    2048/     9B7 : DA 4D 0A            	jp	c, chk_inc
    2049/     9BA : FE 80               	cp	80h
    2050/     9BC : 30 28               	jr	nc, chk_add
    2051/     9BE : FE 76               	cp	76h	; HALT?
    2052/     9C0 : 20 06               	jr	nz, LD1op
    2053/     9C2 :                     
    2054/     9C2 : 11 48 12            	ld	de, HLTstr	; HALT string
    2055/     9C5 : C3 0A 11            	jp	mkopcstr	; de : next string buffer addr
    2056/     9C8 :                     
    2057/     9C8 :                     ; LD
    2058/     9C8 :                     
    2059/     9C8 :                     LD1op:
    2060/     9C8 : CD 6E 09            	call	get_r_num
    2061/     9CB : CD 89 10            	call	get_rstg_off
    2062/     9CE : 21 A8 EF            	ld	hl, dasm_OprStr
    2063/     9D1 : CD 5D 11            	call	mk_rcs		; "REG, "
    2064/     9D4 :                     
    2065/     9D4 :                     mk_2ndopr:
    2066/     9D4 : ED 5B 86 EF         	ld	de, (dasm_adr)
    2067/     9D8 : 1A                  	ld	a, (de)		; get opcode
    2068/     9D9 : E6 07               	and	07h
    2069/     9DB : 4F                  	ld	c, a
    2070/     9DC : 06 00               	ld	b, 0
    2071/     9DE :                     
    2072/     9DE :                     mk_2ndopr1:
    2073/     9DE : E5                  	push	hl		; save copy buffer
    2074/     9DF : CD 89 10            	call	get_rstg_off
    2075/     9E2 : E1                  	pop	hl		; copy buffer
    2076/     9E3 : C3 33 11            	jp	cpstr_crlf	; "REG",CR,LF
    2077/     9E6 :                     
    2078/     9E6 :                     ; ADD 80H - 87H
    2079/     9E6 :                     ; check ADD code
    2080/     9E6 :                     
    2081/     9E6 :                     chk_add:
    2082/     9E6 : FE 88               	cp	88h
    2083/     9E8 : 30 08               	jr	nc, chk_adc
    2084/     9EA :                     
    2085/     9EA :                     ; ADD
    2086/     9EA : CD 07 11            	call	add_opstr
    2087/     9ED : CD 5A 11            	call	a_colon_sp
    2088/     9F0 : 18 E2               	jr	mk_2ndopr
    2089/     9F2 :                     
    2090/     9F2 :                     ; ADC 88H - 8FH
    2091/     9F2 :                     ; check ADC code
    2092/     9F2 :                     
    2093/     9F2 :                     chk_adc:
    2094/     9F2 : FE 90               	cp	90h
    2095/     9F4 : 30 0B               	jr	nc, chk_sub
    2096/     9F6 :                     
    2097/     9F6 :                     ; ADC
    2098/     9F6 : 11 51 12            	ld	de, ADCstr
    2099/     9F9 : CD 0A 11            	call	mkopcstr
    2100/     9FC : CD 5A 11            	call	a_colon_sp
    2101/     9FF : 18 D3               	jr	mk_2ndopr
    2102/     A01 :                     
    2103/     A01 :                     ; SUB 90H - 97H
    2104/     A01 :                     ; check SUB code
    2105/     A01 :                     
    2106/     A01 :                     chk_sub:
    2107/     A01 : FE 98               	cp	98h
    2108/     A03 : 30 08               	jr	nc, chk_sbc
    2109/     A05 :                     
    2110/     A05 :                     ; SUB
    2111/     A05 : 11 55 12            	ld	de, SUBstr
    2112/     A08 : CD 0A 11            	call	mkopcstr
    2113/     A0B : 18 C7               	jr	mk_2ndopr
    2114/     A0D :                     
    2115/     A0D :                     ; SBC 98H - 9FH
    2116/     A0D :                     ; check SBC code
    2117/     A0D :                     
    2118/     A0D :                     chk_sbc:
    2119/     A0D : FE A0               	cp	0A0h
    2120/     A0F : 30 0B               	jr	nc, chk_and
    2121/     A11 :                     
    2122/     A11 :                     ; SBC
    2123/     A11 : 11 59 12            	ld	de, SBCstr
    2124/     A14 : CD 0A 11            	call	mkopcstr
    2125/     A17 : CD 5A 11            	call	a_colon_sp
    2126/     A1A : 18 B8               	jr	mk_2ndopr
    2127/     A1C :                     
    2128/     A1C :                     ; AND 0A0H - 0A7H
    2129/     A1C :                     ; check AND code
    2130/     A1C :                     
    2131/     A1C :                     chk_and:
    2132/     A1C : FE A8               	cp	0A8h
    2133/     A1E : 30 08               	jr	nc, chk_xor
    2134/     A20 :                     
    2135/     A20 :                     ; AND
    2136/     A20 : 11 5D 12            	ld	de, ANDstr
    2137/     A23 : CD 0A 11            	call	mkopcstr
    2138/     A26 : 18 AC               	jr	mk_2ndopr
    2139/     A28 :                     
    2140/     A28 :                     ; XOR 0A8H - 0AFH
    2141/     A28 :                     ; check XOR code
    2142/     A28 :                     
    2143/     A28 :                     chk_xor:
    2144/     A28 :                     
    2145/     A28 : FE B0               	cp	0B0h
    2146/     A2A : 30 08               	jr	nc, chk_or
    2147/     A2C :                     
    2148/     A2C :                     ; XOR
    2149/     A2C : 11 61 12            	ld	de, XORstr
    2150/     A2F : CD 0A 11            	call	mkopcstr
    2151/     A32 : 18 A0               	jr	mk_2ndopr
    2152/     A34 :                     
    2153/     A34 :                     ; OR 0B0H - 0B7H
    2154/     A34 :                     ; check OR code
    2155/     A34 :                     
    2156/     A34 :                     chk_or:
    2157/     A34 : FE B8               	cp	0B8h
    2158/     A36 : 30 08               	jr	nc, chk_cp
    2159/     A38 :                     
    2160/     A38 :                     ; OR
    2161/     A38 : 11 65 12            	ld	de, ORstr
    2162/     A3B : CD 0A 11            	call	mkopcstr
    2163/     A3E : 18 94               	jr	mk_2ndopr
    2164/     A40 :                     
    2165/     A40 :                     ; CP 0B8H - 0BFH
    2166/     A40 :                     ; check CP code
    2167/     A40 :                     
    2168/     A40 :                     chk_cp:
    2169/     A40 : FE C0               	cp	0C0h
    2170/     A42 : D2 C9 0A            	jp	nc, chk_pop_rp
    2171/     A45 :                     
    2172/     A45 :                     ; CP
    2173/     A45 : 11 68 12            	ld	de, CPstr
    2174/     A48 : CD 0A 11            	call	mkopcstr
    2175/     A4B : 18 87               	jr	mk_2ndopr
    2176/     A4D :                     
    2177/     A4D :                     ;check INC
    2178/     A4D :                     
    2179/     A4D :                     chk_inc:
    2180/     A4D : 01 08 00            	ld	bc, INC_OPCDTBLE - INC_OPCDTBLS
    2181/     A50 : 21 96 11            	ld	hl, INC_OPCDTBLS
    2182/     A53 : ED B1               	cpir
    2183/     A55 : 20 0E               	jr	nz, chk_dec
    2184/     A57 :                     
    2185/     A57 :                     ; INC
    2186/     A57 : F5                  	push	af
    2187/     A58 : 11 6B 12            	ld	de, INCstr
    2188/     A5B : CD 0A 11            	call	mkopcstr
    2189/     A5E : F1                  	pop	af
    2190/     A5F :                     
    2191/     A5F :                     inc_dec:
    2192/     A5F : CD 6E 09            	call	get_r_num
    2193/     A62 : C3 DE 09            	jp	mk_2ndopr1
    2194/     A65 :                     
    2195/     A65 :                     ;check dec
    2196/     A65 :                     
    2197/     A65 :                     chk_dec:
    2198/     A65 : 01 08 00            	ld	bc, DEC_OPCDTBLE - DEC_OPCDTBLS
    2199/     A68 : 21 9E 11            	ld	hl, DEC_OPCDTBLS
    2200/     A6B : ED B1               	cpir
    2201/     A6D : 20 0A               	jr	nz, chk_inc_rp
    2202/     A6F :                     
    2203/     A6F :                     ; DEC
    2204/     A6F : F5                  	push	af
    2205/     A70 : 11 6F 12            	ld	de, DECstr
    2206/     A73 : CD 0A 11            	call	mkopcstr
    2207/     A76 : F1                  	pop	af
    2208/     A77 : 18 E6               	jr	inc_dec
    2209/     A79 :                     
    2210/     A79 :                     ; check inc rp
    2211/     A79 :                     
    2212/     A79 :                     chk_inc_rp:
    2213/     A79 : 01 04 00            	ld	bc, inc_rp_e - inc_rp_s
    2214/     A7C : 21 A6 11            	ld	hl, inc_rp_s
    2215/     A7F : ED B1               	cpir
    2216/     A81 : 20 0F               	jr	nz, chk_dec_rp
    2217/     A83 :                     
    2218/     A83 :                     ; INC rp
    2219/     A83 : 11 6B 12            	ld	de, INCstr
    2220/     A86 : CD 0A 11            	call	mkopcstr
    2221/     A89 :                     
    2222/     A89 : 21 88 13            	ld	hl, INC_DEC_ADDrp
    2223/     A8C : CD 80 10            	call	mk_str
    2224/     A8F : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2225/     A92 :                     
    2226/     A92 :                     ; check dec rp
    2227/     A92 :                     
    2228/     A92 :                     chk_dec_rp:
    2229/     A92 : 01 04 00            	ld	bc, dec_rp_e - dec_rp_s
    2230/     A95 : 21 AA 11            	ld	hl, dec_rp_s
    2231/     A98 : ED B1               	cpir
    2232/     A9A : 20 0F               	jr	nz, chk_add_rp
    2233/     A9C :                     
    2234/     A9C :                     ; dec rp
    2235/     A9C : 11 6F 12            	ld	de, DECstr
    2236/     A9F : CD 0A 11            	call	mkopcstr
    2237/     AA2 :                     
    2238/     AA2 : 21 88 13            	ld	hl, INC_DEC_ADDrp
    2239/     AA5 : CD 80 10            	call	mk_str
    2240/     AA8 : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2241/     AAB :                     
    2242/     AAB :                     ;check ADD HL, rp
    2243/     AAB :                     
    2244/     AAB :                     chk_add_rp:
    2245/     AAB : 01 04 00            	ld	bc, add_rp_e - add_rp_s
    2246/     AAE : 21 AE 11            	ld	hl, add_rp_s
    2247/     AB1 : ED B1               	cpir
    2248/     AB3 : 20 46               	jr	nz, chk_ex
    2249/     AB5 :                     
    2250/     AB5 :                     ; add hl, rp
    2251/     AB5 :                     
    2252/     AB5 : CD 07 11            	call	add_opstr
    2253/     AB8 :                     
    2254/     AB8 : 11 97 2E            	ld	de, RNHL
    2255/     ABB : CD 5D 11            	call	mk_rcs		; "HL, "
    2256/     ABE :                     
    2257/     ABE : E5                  	push	hl
    2258/     ABF : 21 88 13            	ld	hl, INC_DEC_ADDrp
    2259/     AC2 : CD 8C 10            	call	get_strBufpoint
    2260/     AC5 : E1                  	pop	hl
    2261/     AC6 : C3 33 11            	jp	cpstr_crlf	; CR, LF, 00h
    2262/     AC9 :                     
    2263/     AC9 :                     ; check POP rp
    2264/     AC9 :                     
    2265/     AC9 :                     chk_pop_rp:
    2266/     AC9 : 01 04 00            	ld	bc, pop_rp_e - pop_rp_s
    2267/     ACC : 21 B2 11            	ld	hl, pop_rp_s
    2268/     ACF : ED B1               	cpir
    2269/     AD1 : 20 0F               	jr	nz, chk_push_rp
    2270/     AD3 :                     
    2271/     AD3 :                     ; POP RP
    2272/     AD3 :                     
    2273/     AD3 : 11 73 12            	ld	de, POPstr
    2274/     AD6 : CD 0A 11            	call	mkopcstr
    2275/     AD9 :                     
    2276/     AD9 : 21 90 13            	ld	hl, POP_PUSHrp
    2277/     ADC : CD 80 10            	call	mk_str
    2278/     ADF : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2279/     AE2 :                     
    2280/     AE2 :                     ; check PUSH rp
    2281/     AE2 :                     
    2282/     AE2 :                     chk_push_rp:
    2283/     AE2 : 01 04 00            	ld	bc, push_rp_e - push_rp_s
    2284/     AE5 : 21 B6 11            	ld	hl, push_rp_s
    2285/     AE8 : ED B1               	cpir
    2286/     AEA : 20 0F               	jr	nz, chk_ex
    2287/     AEC :                     
    2288/     AEC :                     ; PUSH RP
    2289/     AEC :                     
    2290/     AEC : 11 77 12            	ld	de, PUSHstr
    2291/     AEF : CD 0A 11            	call	mkopcstr
    2292/     AF2 :                     
    2293/     AF2 : 21 90 13            	ld	hl, POP_PUSHrp
    2294/     AF5 : CD 80 10            	call	mk_str
    2295/     AF8 : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2296/     AFB :                     
    2297/     AFB :                     ; check EX XX, XX
    2298/     AFB :                     
    2299/     AFB :                     chk_ex:
    2300/     AFB : FE 08               	cp	08H		; EX	AF,AF'
    2301/     AFD : 28 17               	jr	z, ex_af_af
    2302/     AFF : FE E3               	cp	0E3H		; EX	(SP),HL
    2303/     B01 : 28 21               	jr	z, dex_sp_hl
    2304/     B03 : FE EB               	cp	0EBH		; EX	DE,HL
    2305/     B05 : 20 25               	jr	nz, chk_1mc_bnh
    2306/     B07 :                     
    2307/     B07 :                     ; EX DE, HL
    2308/     B07 : 11 90 2E            	ld	de, RNDE
    2309/     B0A : CD 5D 11            	call	mk_rcs
    2310/     B0D :                     
    2311/     B0D :                     ins_hl_opr:
    2312/     B0D : CD 30 11            	call	hl_crlf
    2313/     B10 :                     
    2314/     B10 :                     ins_ex_opc:
    2315/     B10 : 11 7C 12            	ld	de, EXstr
    2316/     B13 : C3 0A 11            	jp	mkopcstr
    2317/     B16 :                     
    2318/     B16 :                     ; EX AF,AF'
    2319/     B16 :                     ex_af_af:
    2320/     B16 : 11 26 12            	ld	de, RNAF
    2321/     B19 : CD 5D 11            	call	mk_rcs
    2322/     B1C : 11 29 12            	ld	de, RNAFX
    2323/     B1F : CD 33 11            	call	cpstr_crlf
    2324/     B22 : 18 EC               	jr ins_ex_opc
    2325/     B24 :                     
    2326/     B24 :                     ; EX (SP),HL
    2327/     B24 :                     dex_sp_hl:
    2328/     B24 : 11 CA 2E            	ld	de, RNSP
    2329/     B27 : CD 4C 11            	call	mk_krkcs
    2330/     B2A : 18 E1               	jr	ins_hl_opr
    2331/     B2C :                     
    2332/     B2C :                     ; check other one MC code
    2333/     B2C :                     
    2334/     B2C :                     chk_1mc_bnh:
    2335/     B2C :                     
    2336/     B2C :                     ; check JP (HL)
    2337/     B2C :                     
    2338/     B2C : FE E9               	cp	0E9H		; JP (HL) ?
    2339/     B2E : 20 0F               	jr	nz, chk_ret
    2340/     B30 :                     
    2341/     B30 :                     ; JP (HL)
    2342/     B30 : 11 31 12            	ld	de, JPstr
    2343/     B33 : CD 0A 11            	call	mkopcstr	; "JP "
    2344/     B36 :                     
    2345/     B36 : 11 97 2E            	ld	de, RNHL
    2346/     B39 : CD 41 11            	call	mk_krk_1
    2347/     B3C : C3 36 11            	jp	insPostStr
    2348/     B3F :                     
    2349/     B3F :                     ; check RET CC
    2350/     B3F :                     chk_ret:
    2351/     B3F : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    2352/     B42 : 21 7C 06            	ld	hl, RETCC_TBLS
    2353/     B45 : ED B1               	cpir
    2354/     B47 : 20 0F               	jr	nz, chk_rst
    2355/     B49 :                     
    2356/     B49 :                     ; RET CC
    2357/     B49 :                     ; BC : 7 >= BC >= 0
    2358/     B49 :                     
    2359/     B49 :                     	; make opcode string
    2360/     B49 : 11 2D 12            	ld	de, RETstr
    2361/     B4C : CD 0A 11            	call	mkopcstr
    2362/     B4F :                     
    2363/     B4F :                     	; make operand string
    2364/     B4F :                     
    2365/     B4F : 21 70 13            	ld	hl, CC_opr	; string base
    2366/     B52 : CD 80 10            	call	mk_str
    2367/     B55 : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2368/     B58 :                     
    2369/     B58 :                     ; check RST p
    2370/     B58 :                     
    2371/     B58 :                     chk_rst:
    2372/     B58 : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    2373/     B5B : 21 99 06            	ld	hl, RST_TBLS
    2374/     B5E : ED B1               	cpir
    2375/     B60 : 20 17               	jr	nz, chk_2MC		; 2bytes MC
    2376/     B62 :                     
    2377/     B62 :                     ; RST p
    2378/     B62 :                     
    2379/     B62 : 11 41 12            	ld	de, RSTstr
    2380/     B65 : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2381/     B68 :                     
    2382/     B68 :                     ; 0 <= BC <= 7
    2383/     B68 :                     ; 7: 00H  (0000 0 111 : 00 000 000)
    2384/     B68 :                     ; 6: 08H  (0000 0 110 : 00 001 000)
    2385/     B68 :                     ; 5: 10H  (0000 0 101 : 00 010 000)
    2386/     B68 :                     ; 4: 18H  (0000 0 100 : 00 011 000)
    2387/     B68 :                     ; 3: 20H  (0000 0 011 : 00 100 000)
    2388/     B68 :                     ; 2: 28H  (0000 0 010 : 00 101 000)
    2389/     B68 :                     ; 1: 30H  (0000 0 001 : 00 110 000)
    2390/     B68 :                     ; 0: 38H  (0000 0 000 : 00 111 000)
    2391/     B68 :                     ;
    2392/     B68 : 79                  	ld	a, c
    2393/     B69 : 2F                  	cpl		; not a
    2394/     B6A : CB 27               	sla	a
    2395/     B6C : CB 27               	sla	a
    2396/     B6E : CB 27               	sla	a
    2397/     B70 : E6 38               	and	38H	; a = RST No.
    2398/     B72 :                     
    2399/     B72 : 5F                  	ld	e, a
    2400/     B73 : 21 A8 EF            	ld	hl, dasm_OprStr
    2401/     B76 : C3 95 10            	jp	mk_n2crlf	; "nnH", CR, LF
    2402/     B79 :                     
    2403/     B79 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2404/     B79 :                     	; analysys 2 byte MC
    2405/     B79 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2406/     B79 :                     
    2407/     B79 :                     chk_2MC:
    2408/     B79 :                     
    2409/     B79 : F5                  	push	af
    2410/     B7A : 3E 02               	ld	a, 2
    2411/     B7C : 32 8C EF            	ld	(mc_Size), a
    2412/     B7F : F1                  	pop	af
    2413/     B80 :                     
    2414/     B80 :                     ; check LD r, nn
    2415/     B80 :                     
    2416/     B80 : 01 08 00            	ld	bc, ld_r_nn_e - ld_r_nn_s
    2417/     B83 : 21 3A 07            	ld	hl, ld_r_nn_s
    2418/     B86 : ED B1               	cpir
    2419/     B88 : 20 16               	jr	nz, chk_logop2
    2420/     B8A :                     
    2421/     B8A :                     ; LD r, nn
    2422/     B8A :                     
    2423/     B8A : CD 6E 09            	call	get_r_num
    2424/     B8D : CD 89 10            	call	get_rstg_off
    2425/     B90 : CD 5D 11            	call	mk_rcs		; "REG, "
    2426/     B93 :                     
    2427/     B93 : ED 5B 86 EF         	ld	de, (dasm_adr)
    2428/     B97 : 13                  	inc	de
    2429/     B98 : 1A                  	ld	a, (de)		; get nn
    2430/     B99 : 5F                  	ld	e, a
    2431/     B9A : CD D8 10            	call	hex2str_asm	; "nnH"
    2432/     B9D : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2433/     BA0 :                     
    2434/     BA0 :                     ; check logical operation with 8 bit literal
    2435/     BA0 :                     
    2436/     BA0 :                     chk_logop2:
    2437/     BA0 :                     
    2438/     BA0 : 01 0A 00            	ld	bc, log_op_e - log_op_s
    2439/     BA3 : 21 42 07            	ld	hl, log_op_s
    2440/     BA6 : ED B1               	cpir
    2441/     BA8 : C2 F4 0B            	jp	nz, chk_djnz
    2442/     BAB :                     
    2443/     BAB :                     ; logical operation with 8 bit literal
    2444/     BAB :                     
    2445/     BAB :                     
    2446/     BAB : C5                  	push	bc
    2447/     BAC : 21 B2 13            	ld	hl, logop2str
    2448/     BAF : CD 8C 10            	call	get_strBufpoint
    2449/     BB2 : CD 0A 11            	call	mkopcstr		; make op code string
    2450/     BB5 : C1                  	pop	bc
    2451/     BB6 : 79                  	ld	a, c
    2452/     BB7 :                     
    2453/     BB7 : FE 01               	cp	1
    2454/     BB9 : 28 14               	jr	z, acs_kn2k	; insert "A, (nn)"
    2455/     BBB : B7                  	or	a
    2456/     BBC : 28 1A               	jr	z, ins_kn2k	; insert "(nn), A"
    2457/     BBE : FE 07               	cp	7
    2458/     BC0 : 38 03               	jr	c, ins_n2crlf	; insert  "nnH"
    2459/     BC2 :                     
    2460/     BC2 :                     ; insert "A, "
    2461/     BC2 :                     
    2462/     BC2 : CD 5A 11            	call	a_colon_sp
    2463/     BC5 :                     
    2464/     BC5 :                     ; "nn"
    2465/     BC5 :                     ins_n2crlf:
    2466/     BC5 : ED 5B 86 EF         	ld	de, (dasm_adr)
    2467/     BC9 : 13                  	inc	de
    2468/     BCA : 1A                  	ld	a, (de)
    2469/     BCB : 5F                  	ld	e, a		; get nn
    2470/     BCC : C3 95 10            	jp	mk_n2crlf	; "nnH", CR, LF
    2471/     BCF :                     
    2472/     BCF :                     acs_kn2k:
    2473/     BCF : CD 5A 11            	call	a_colon_sp	; "A, "
    2474/     BD2 : CD E4 0B            	call	kn2k		; "(nnH)"
    2475/     BD5 : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2476/     BD8 :                     
    2477/     BD8 :                     ; "(nn), A"
    2478/     BD8 :                     ins_kn2k:
    2479/     BD8 : 21 A8 EF            	ld	hl, dasm_OprStr	;operand str buffer
    2480/     BDB : CD E4 0B            	call	kn2k		; "(nnH)"
    2481/     BDE : CD 82 11            	call	ins_kmR		; " ,"
    2482/     BE1 : C3 25 11            	jp	a_crlf		; "A", CR, LF, 00h
    2483/     BE4 :                     
    2484/     BE4 :                     ; "(nnH)"
    2485/     BE4 :                     kn2k:
    2486/     BE4 : CD 6D 11            	call	ins_kakkoL	; "("
    2487/     BE7 : ED 5B 86 EF         	ld	de, (dasm_adr)
    2488/     BEB : 13                  	inc	de
    2489/     BEC : 1A                  	ld	a, (de)		; get nn
    2490/     BED : 5F                  	ld	e, a		; e: nn
    2491/     BEE : CD D8 10            	call	hex2str_asm	; hex strings
    2492/     BF1 : C3 71 11            	jp	ins_kakkoR	; ")"
    2493/     BF4 :                     
    2494/     BF4 :                     
    2495/     BF4 :                     ; check DJNZ nn
    2496/     BF4 :                     chk_djnz:
    2497/     BF4 : FE 10               	cp	10H
    2498/     BF6 : 20 05               	jr	nz, chk_jrnn
    2499/     BF8 :                     
    2500/     BF8 :                     ; check DJNZ nn
    2501/     BF8 : 11 37 12            	ld	de, DJNZstr
    2502/     BFB : 18 07               	jr	jr_n4crlf
    2503/     BFD :                     
    2504/     BFD :                     ; check jr nn
    2505/     BFD :                     chk_jrnn:
    2506/     BFD : FE 18               	cp	18H
    2507/     BFF : 20 0C               	jr	nz, chk_jrcc	; not JR relative
    2508/     C01 :                     
    2509/     C01 :                     ; JR Relative
    2510/     C01 : 11 34 12            	ld	de, JRstr
    2511/     C04 :                     jr_n4crlf:
    2512/     C04 : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2513/     C07 : 21 A8 EF            	ld	hl, dasm_OprStr
    2514/     C0A : C3 B9 10            	jp	mkRel_str	; "nnnnH",cr,lf : nnnn : branch address
    2515/     C0D :                     
    2516/     C0D :                     ; JR CC, nn
    2517/     C0D :                     
    2518/     C0D :                     chk_jrcc:
    2519/     C0D : 01 04 00            	ld	bc, JRCC_TBLE - JRCC_TBLS1
    2520/     C10 : 21 85 06            	ld	hl, JRCC_TBLS1
    2521/     C13 : ED B1               	cpir
    2522/     C15 : 20 12               	jr	nz, chk_3MC	; no, check 3 bnytes MC
    2523/     C17 :                     
    2524/     C17 :                     ; JR CC, nn(Relative Value)
    2525/     C17 :                     
    2526/     C17 : 11 34 12            	ld	de, JRstr
    2527/     C1A : CD 0A 11            	call	mkopcstr
    2528/     C1D : 21 80 13            	ld	hl, JRCC_opr1	; string base
    2529/     C20 : CD 80 10            	call	mk_str		; "NZ", "Z", "NC", "C"
    2530/     C23 : CD 82 11            	call	ins_kmR		; ", "
    2531/     C26 : C3 B9 10            	jp	mkRel_str	; "nnnnH", cr, lf
    2532/     C29 :                     
    2533/     C29 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2534/     C29 :                     	; analysys 3 byte MC
    2535/     C29 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2536/     C29 :                     
    2537/     C29 :                     chk_3MC:
    2538/     C29 : F5                  	push	af
    2539/     C2A : 3E 03               	ld	a, 3
    2540/     C2C : 32 8C EF            	ld	(mc_Size), a
    2541/     C2F : F1                  	pop	af
    2542/     C30 :                     
    2543/     C30 : 01 04 00            	ld	bc, THREE_OPTBLe - THREE_OPTBL
    2544/     C33 : 21 4C 07            	ld	hl, THREE_OPTBL
    2545/     C36 : ED B1               	cpir
    2546/     C38 : C2 4A 0C            	jp	nz, chk_ld16
    2547/     C3B :                     
    2548/     C3B :                     ; LD rp, nnnn
    2549/     C3B :                     
    2550/     C3B : 21 C6 13            	ld	hl, logop3str
    2551/     C3E : CD 8C 10            	call	get_strBufpoint
    2552/     C41 : CD 5D 11            	call	mk_rcs		; "Reg, "
    2553/     C44 :                     
    2554/     C44 :                     get_n4crlf:
    2555/     C44 : CD 72 0C            	call	get_n4
    2556/     C47 : C3 9B 10            	jp	mk_n4crlf	; "nnnnH", CR, LF, 00h
    2557/     C4A :                     
    2558/     C4A :                     ; LD 16bit literal
    2559/     C4A :                     chk_ld16:
    2560/     C4A : FE 22               	cp	22h
    2561/     C4C : 28 12               	jr	z, ins_kkhl	; "(nnnnH), HL"
    2562/     C4E : FE 32               	cp	32h
    2563/     C50 : 28 14               	jr	z, ins_kka	; "(nnnnH), A"
    2564/     C52 : FE 2A               	cp	2ah
    2565/     C54 : 28 26               	jr	z, ins_hlkk	; "HL, (nnnnH)"
    2566/     C56 : FE 3A               	cp	3ah
    2567/     C58 : C2 8B 0C            	jp	nz, chk_jpn4	; check jp n4
    2568/     C5B :                     
    2569/     C5B :                     ; "A, (nnnnH)"
    2570/     C5B : CD 5A 11            	call	a_colon_sp	; "A, "
    2571/     C5E : 18 22               	jr	kn4kcrlf
    2572/     C60 :                     
    2573/     C60 :                     ; "(nnnnH), HL"
    2574/     C60 :                     ins_kkhl:
    2575/     C60 : CD 6C 0C            	call	kn4hk
    2576/     C63 : C3 30 11            	jp	hl_crlf		; "HL",cr,lf
    2577/     C66 :                     
    2578/     C66 :                     ; "(nnnnH), A"
    2579/     C66 :                     ins_kka:
    2580/     C66 : CD 6C 0C            	call	kn4hk
    2581/     C69 : C3 25 11            	jp	a_crlf		; "A",cr,lf
    2582/     C6C :                     
    2583/     C6C :                     kn4hk:
    2584/     C6C : CD 72 0C            	call	get_n4
    2585/     C6F : C3 A1 10            	jp	ins_kn4kcs	; "(nnnnH), "
    2586/     C72 :                     
    2587/     C72 :                     get_n4:
    2588/     C72 : E5                  	push	hl
    2589/     C73 : 2A 86 EF            	ld	hl, (dasm_adr)
    2590/     C76 : 23                  	inc	hl
    2591/     C77 : 5E                  	ld	e, (hl)
    2592/     C78 : 23                  	inc	hl
    2593/     C79 : 56                  	ld	d, (hl)
    2594/     C7A : E1                  	pop	hl
    2595/     C7B : C9                  	ret
    2596/     C7C :                     
    2597/     C7C :                     ; "HL, (nnnnH)"
    2598/     C7C :                     ins_hlkk:
    2599/     C7C : 11 97 2E            	ld	de, RNHL
    2600/     C7F : CD 5D 11            	call	mk_rcs		; "HL ,"
    2601/     C82 :                     
    2602/     C82 :                     kn4kcrlf:
    2603/     C82 : CD 72 0C            	call	get_n4
    2604/     C85 : CD B0 10            	call	mk_kn4k		; "(nnnnH)"
    2605/     C88 : C3 36 11            	jp	insPostStr	; cr, lf
    2606/     C8B :                     
    2607/     C8B :                     ; check JP literal
    2608/     C8B :                     
    2609/     C8B :                     chk_jpn4:
    2610/     C8B : FE C3               	cp	0C3H		; JP literal ?
    2611/     C8D : 20 08               	jr	nz, chk_calln4	; not JP literal
    2612/     C8F :                     
    2613/     C8F :                     ; "JP nnnnH"
    2614/     C8F :                     
    2615/     C8F : 11 31 12            	ld	de, JPstr
    2616/     C92 : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2617/     C95 : 18 AD               	jr	get_n4crlf
    2618/     C97 :                     
    2619/     C97 :                     ; check call literal
    2620/     C97 :                     
    2621/     C97 :                     chk_calln4:
    2622/     C97 : FE CD               	cp	0CDH		; CALL literal ?
    2623/     C99 : 20 08               	jr	nz, chk_jpcc
    2624/     C9B :                     
    2625/     C9B :                     ; "CALL nnnnH",cr,lf
    2626/     C9B :                     
    2627/     C9B : 11 3C 12            	ld	de, CALLstr
    2628/     C9E : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2629/     CA1 : 18 A1               	jr	get_n4crlf
    2630/     CA3 :                     
    2631/     CA3 :                     
    2632/     CA3 :                     ; check 3 byte machine code: branch JP CC, nnnn
    2633/     CA3 :                     
    2634/     CA3 :                     chk_jpcc:
    2635/     CA3 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    2636/     CA6 : 21 89 06            	ld	hl, JPCC_TBLS
    2637/     CA9 : ED B1               	cpir
    2638/     CAB : 20 11               	jr	nz, chk_calcc
    2639/     CAD :                     
    2640/     CAD :                     ; JP CC, nnnn
    2641/     CAD :                     ; BC : 7 >= BC >= 0
    2642/     CAD :                     
    2643/     CAD : 11 31 12            	ld	de, JPstr
    2644/     CB0 :                     
    2645/     CB0 :                     CC_NNNN:
    2646/     CB0 : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2647/     CB3 :                     
    2648/     CB3 : 21 70 13            	ld	hl, CC_opr	; string base
    2649/     CB6 : CD 80 10            	call	mk_str		; de: point (string end) + 1
    2650/     CB9 : CD 82 11            	call	ins_kmR		; " ,"
    2651/     CBC : 18 86               	jr	get_n4crlf	; "nnnnh", cr,lf
    2652/     CBE :                     
    2653/     CBE :                     
    2654/     CBE :                     ; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    2655/     CBE :                     
    2656/     CBE :                     chk_calcc:
    2657/     CBE : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    2658/     CC1 : 21 91 06            	ld	hl, CLCC_TBLS
    2659/     CC4 : ED B1               	cpir
    2660/     CC6 : 20 05               	jr	nz, chk_0CBH
    2661/     CC8 :                     
    2662/     CC8 :                     ; CALL CC, nnnn
    2663/     CC8 :                     ; BC : 7 >= BC >= 0 CALLstr
    2664/     CC8 :                     
    2665/     CC8 : 11 3C 12            	ld	de, CALLstr
    2666/     CCB : 18 E3               	jr	CC_NNNN
    2667/     CCD :                     
    2668/     CCD :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2669/     CCD :                     	; OPECODE 0CBH check
    2670/     CCD :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2671/     CCD :                     
    2672/     CCD :                     chk_0CBH:
    2673/     CCD : 2A 86 EF            	ld	hl, (dasm_adr)
    2674/     CD0 : 23                  	inc	hl		; 2nd opecode address
    2675/     CD1 :                     
    2676/     CD1 : F5                  	push	af
    2677/     CD2 : 3E 02               	ld	a, 2
    2678/     CD4 : 32 8C EF            	ld	(mc_Size), a	; set 2bytes MC
    2679/     CD7 : F1                  	pop	af
    2680/     CD8 :                     
    2681/     CD8 : FE CB               	cp	0cbh
    2682/     CDA : C2 93 0D            	jp	nz, chk_0DDH
    2683/     CDD :                     
    2684/     CDD : 7E                  	ld	a, (hl)		; a : 2nd opecode
    2685/     CDE : 21 A8 EF            	ld	hl, dasm_OprStr ; set operand string buffer
    2686/     CE1 :                     
    2687/     CE1 : FE 08               	cp	08h
    2688/     CE3 : DA 1C 0D            	jp	c, mk_rlcr
    2689/     CE6 : FE 10               	cp	10h
    2690/     CE8 : DA 25 0D            	jp	c, mk_rrcr
    2691/     CEB : FE 18               	cp	18h
    2692/     CED : DA 2E 0D            	jp	c, mk_rlr
    2693/     CF0 : FE 20               	cp	20h
    2694/     CF2 : DA 37 0D            	jp	c, mk_rrr
    2695/     CF5 : FE 28               	cp	28h
    2696/     CF7 : DA 40 0D            	jp	c, mk_slar
    2697/     CFA : FE 30               	cp	30h
    2698/     CFC : DA 49 0D            	jp	c, mk_srar
    2699/     CFF : FE 38               	cp	38h
    2700/     D01 : DA 6D 0D            	jp	c, op_err
    2701/     D04 : FE 40               	cp	40h
    2702/     D06 : DA 52 0D            	jp	c, mk_srlr
    2703/     D09 : FE 80               	cp	80h
    2704/     D0B : DA 5B 0D            	jp	c, mk_bitr
    2705/     D0E : FE C0               	cp	0c0h
    2706/     D10 : DA 64 0D            	jp	c, mk_resr
    2707/     D13 :                     
    2708/     D13 :                     ; make SET n, r, SET n, (HL)
    2709/     D13 :                     
    2710/     D13 : CD 73 0D            	call	mk_bitr_str
    2711/     D16 : 11 3B 13            	ld	de, SETstr
    2712/     D19 : C3 0A 11            	jp	mkopcstr
    2713/     D1C :                     
    2714/     D1C :                     
    2715/     D1C :                     ; make RLC r, RLC (HL)
    2716/     D1C :                     mk_rlcr:
    2717/     D1C : CD 78 0D            	call	ins_rstg
    2718/     D1F : 11 B6 12            	ld	de, RLCstr
    2719/     D22 : C3 0A 11            	jp	mkopcstr
    2720/     D25 :                     
    2721/     D25 :                     ; make RRC r, RRC (HL)
    2722/     D25 :                     mk_rrcr:
    2723/     D25 : CD 78 0D            	call	ins_rstg
    2724/     D28 : 11 BA 12            	ld	de, RRCstr
    2725/     D2B : C3 0A 11            	jp	mkopcstr
    2726/     D2E :                     
    2727/     D2E :                     ; make RL r, RL (HL)
    2728/     D2E :                     mk_rlr:
    2729/     D2E : CD 78 0D            	call	ins_rstg
    2730/     D31 : 11 BE 12            	ld	de, RLstr
    2731/     D34 : C3 0A 11            	jp	mkopcstr
    2732/     D37 :                     
    2733/     D37 :                     ; make RR r, RR (HL)
    2734/     D37 :                     mk_rrr:
    2735/     D37 : CD 78 0D            	call	ins_rstg
    2736/     D3A : 11 C1 12            	ld	de, RRstr
    2737/     D3D : C3 0A 11            	jp	mkopcstr
    2738/     D40 :                     
    2739/     D40 :                     ; make SLA r, SLA (HL)
    2740/     D40 :                     mk_slar:
    2741/     D40 : CD 78 0D            	call	ins_rstg
    2742/     D43 : 11 C4 12            	ld	de, SLAstr
    2743/     D46 : C3 0A 11            	jp	mkopcstr
    2744/     D49 :                     
    2745/     D49 :                     ; make SRA r, SRA (HL)
    2746/     D49 :                     mk_srar:
    2747/     D49 : CD 78 0D            	call	ins_rstg
    2748/     D4C : 11 C8 12            	ld	de, SRAstr
    2749/     D4F : C3 0A 11            	jp	mkopcstr
    2750/     D52 :                     
    2751/     D52 :                     ; make SRL r, SRL (HL)
    2752/     D52 :                     mk_srlr:
    2753/     D52 : CD 78 0D            	call	ins_rstg
    2754/     D55 : 11 CC 12            	ld	de, SRLstr
    2755/     D58 : C3 0A 11            	jp	mkopcstr
    2756/     D5B :                     
    2757/     D5B :                     ; make BIT n, r, BIT n, (HL)
    2758/     D5B :                     mk_bitr:
    2759/     D5B : CD 73 0D            	call	mk_bitr_str
    2760/     D5E : 11 D0 12            	ld	de, BITstr
    2761/     D61 : C3 0A 11            	jp	mkopcstr
    2762/     D64 :                     
    2763/     D64 :                     ; make RES n, r, RES n, (HL)
    2764/     D64 :                     mk_resr:
    2765/     D64 : CD 73 0D            	call	mk_bitr_str
    2766/     D67 : 11 D4 12            	ld	de, RESstr
    2767/     D6A : C3 0A 11            	jp	mkopcstr
    2768/     D6D :                     
    2769/     D6D :                     op_err:
    2770/     D6D : 11 3F 13            	ld	de, ER_OPMSG
    2771/     D70 : C3 0A 11            	jp	mkopcstr
    2772/     D73 :                     
    2773/     D73 :                     ;-------------------------------------------
    2774/     D73 :                     ; input a : 2nd opecode
    2775/     D73 :                     ;	hl : make string buffer
    2776/     D73 :                     ; make "bit No, r" string to *hl
    2777/     D73 :                     ; (ex) *hl = "1, B"
    2778/     D73 :                     ;-------------------------------------------
    2779/     D73 :                     mk_bitr_str:
    2780/     D73 : F5                  	push	af
    2781/     D74 : CD 85 0D            	call	set_bitno
    2782/     D77 : F1                  	pop	af
    2783/     D78 :                     
    2784/     D78 :                     ins_rstg:
    2785/     D78 : E6 07               	and	07h
    2786/     D7A : 4F                  	ld	c, a	; table offset
    2787/     D7B : 06 00               	ld	b, 0		; bc : string offset
    2788/     D7D : E5                  	push	hl
    2789/     D7E : CD 89 10            	call	get_rstg_off	; get string address to de
    2790/     D81 : E1                  	pop	hl
    2791/     D82 : C3 33 11            	jp	cpstr_crlf	; "REG", CR, LF, 00h
    2792/     D85 :                     ;
    2793/     D85 :                     ; input hl : make string buffer
    2794/     D85 :                     ;
    2795/     D85 :                     set_bitno:
    2796/     D85 : E6 38               	and	38h
    2797/     D87 : 0F                  	rrca
    2798/     D88 : 0F                  	rrca
    2799/     D89 : 0F                  	rrca
    2800/     D8A : 47                  	ld	b, a	; bit number
    2801/     D8B :                     
    2802/     D8B : 3E 30               	ld	a, 30h
    2803/     D8D : B0                  	or	b		; a : bit string "0" - "7"
    2804/     D8E : 77                  	ld	(hl), a
    2805/     D8F : 23                  	inc	hl
    2806/     D90 : C3 82 11            	jp	ins_kmR
    2807/     D93 :                     
    2808/     D93 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2809/     D93 :                     	; OPECODE 0DDH check
    2810/     D93 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2811/     D93 :                     
    2812/     D93 :                     chk_0DDH:
    2813/     D93 : FE DD               	cp	0ddh
    2814/     D95 : C2 39 0F            	jp	nz, chk_0EDH
    2815/     D98 :                     
    2816/     D98 : 11 C4 2E            	ld	de, RNIX
    2817/     D9B : ED 53 88 EF         	ld	(reg_xy), de	; save index reg string
    2818/     D9F : 11 E2 13            	ld	de, addixrp_tbl
    2819/     DA2 : ED 53 8A EF         	ld	(xy_srtp), de
    2820/     DA6 :                     
    2821/     DA6 :                     chk_0DDH_1:
    2822/     DA6 :                     
    2823/     DA6 : 7E                  	ld	a, (hl)		; get 2nd opcode
    2824/     DA7 :                     
    2825/     DA7 : FE E3               	cp	0E3h	; EX (SP),IX
    2826/     DA9 : CA ED 0D            	jp	z, ins_kspkix
    2827/     DAC : FE E9               	cp	0E9h	; JP (IX)
    2828/     DAE : CA DB 0D            	jp	z, ins_jpix
    2829/     DB1 : FE F9               	cp	0F9h	; LD SP, IX
    2830/     DB3 : CA FC 0D            	jp	z, ins_spix
    2831/     DB6 :                     
    2832/     DB6 : 01 04 00            	ld	bc, DD_2NDTBL1 - DD_2NDTBL
    2833/     DB9 : 21 54 07            	ld	hl, DD_2NDTBL
    2834/     DBC : ED B1               	cpir
    2835/     DBE : CA 05 0E            	jp	z, ins_ixrp
    2836/     DC1 :                     
    2837/     DC1 : 01 04 00            	ld	bc, DD_2NDTBL2 - DD_2NDTBL1
    2838/     DC4 : 21 58 07            	ld	hl, DD_2NDTBL1
    2839/     DC7 : ED B1               	cpir
    2840/     DC9 : C2 1A 0E            	jp	nz, chk_0DD3op
    2841/     DCC :                     
    2842/     DCC :                     ; INC	IX
    2843/     DCC :                     ; DEC	IX
    2844/     DCC :                     ; PUSH	IX
    2845/     DCC :                     ; POP	IX
    2846/     DCC : 21 DA 13            	ld	hl, dd_2opt
    2847/     DCF : CD 8C 10            	call	get_strBufpoint
    2848/     DD2 : CD 0A 11            	call	mkopcstr		; inseert OPCODE strings to dasm_OpcStr
    2849/     DD5 :                     
    2850/     DD5 : 21 A8 EF            	ld	hl, dasm_OprStr
    2851/     DD8 : C3 2A 11            	jp	ix_crlf			; "IX", CR, LF, 00h
    2852/     DDB :                     
    2853/     DDB :                     ; JP	(IX)
    2854/     DDB :                     ins_jpix:
    2855/     DDB : ED 5B 88 EF         	ld	de, (reg_xy)
    2856/     DDF :                     ins_jpix1:
    2857/     DDF : D5                  	push	de
    2858/     DE0 : 11 31 12            	ld	de, JPstr
    2859/     DE3 : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2860/     DE6 :                     
    2861/     DE6 : D1                  	pop	de
    2862/     DE7 : CD 41 11            	call	mk_krk_1
    2863/     DEA : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    2864/     DED :                     
    2865/     DED :                     ; EX	(SP),IX
    2866/     DED :                     ins_kspkix:
    2867/     DED : 11 7C 12            	ld	de, EXstr
    2868/     DF0 : CD 0A 11            	call	mkopcstr	; de : next string buffer addr
    2869/     DF3 : 11 CA 2E            	ld	de, RNSP
    2870/     DF6 : CD 4C 11            	call	mk_krkcs	; "(SP), "
    2871/     DF9 : C3 2A 11            	jp	ix_crlf		; "IX",cr,lf
    2872/     DFC :                     
    2873/     DFC :                     ; LD	SP,IX
    2874/     DFC :                     ins_spix:
    2875/     DFC : 11 CA 2E            	ld	de, RNSP
    2876/     DFF : CD 5D 11            	call	mk_rcs		; "SP, "
    2877/     E02 : C3 2A 11            	jp	ix_crlf		; "IX",cr,lf
    2878/     E05 :                     
    2879/     E05 :                     ; ADD	IX,BC
    2880/     E05 :                     ; ADD	IX,DE
    2881/     E05 :                     ; ADD	IX,IX
    2882/     E05 :                     ; ADD	IX,SP
    2883/     E05 :                     ins_ixrp:
    2884/     E05 : CD 07 11            	call	add_opstr	; de : next string buffer addr
    2885/     E08 :                     
    2886/     E08 : ED 5B 88 EF         	ld	de, (reg_xy)
    2887/     E0C : CD 5D 11            	call	mk_rcs		; "IX, "
    2888/     E0F :                     
    2889/     E0F : E5                  	push	hl
    2890/     E10 : 2A 8A EF            	ld	hl, (xy_srtp)
    2891/     E13 : CD 8C 10            	call	get_strBufpoint
    2892/     E16 : E1                  	pop	hl
    2893/     E17 : C3 33 11            	jp	cpstr_crlf	; "REG",cr,lf
    2894/     E1A :                     
    2895/     E1A :                     ;
    2896/     E1A :                     ; check 0DD 3bytes MC
    2897/     E1A :                     ;
    2898/     E1A :                     chk_0DD3op:
    2899/     E1A : F5                  	push	af
    2900/     E1B : 3E 03               	ld	a, 3
    2901/     E1D : 32 8C EF            	ld	(mc_Size), a	; 2byte machine code
    2902/     E20 : F1                  	pop	af
    2903/     E21 :                     
    2904/     E21 : 01 0E 00            	ld	bc, dd_ld_tble - dd_ld_tbl
    2905/     E24 : 21 BA 11            	ld	hl, dd_ld_tbl
    2906/     E27 : ED B1               	cpir
    2907/     E29 : CA 59 0E            	jp	z, dd_ld
    2908/     E2C :                     
    2909/     E2C : FE 86               	cp	86h
    2910/     E2E : CA 84 0E            	jp	z, dd_mix
    2911/     E31 : FE 8E               	cp	8eh
    2912/     E33 : CA 8F 0E            	jp	z, dd_mix1
    2913/     E36 : FE 9E               	cp	9eh
    2914/     E38 : CA 94 0E            	jp	z, dd_mix2
    2915/     E3B :                     
    2916/     E3B : 01 07 00            	ld	bc, dd_log_tble - dd_log_tbl
    2917/     E3E : 21 C8 11            	ld	hl, dd_log_tbl
    2918/     E41 : ED B1               	cpir
    2919/     E43 : C2 99 0E            	jp	nz, chk_0DD4op
    2920/     E46 :                     
    2921/     E46 :                     ;
    2922/     E46 :                     ; make "SUB (IX+nn)", "AND (IX+nn)", "XOR (IX+nn)"
    2923/     E46 :                     ;       "OR (IX+nn)",  "CP (IX+nn)"
    2924/     E46 :                     ;      "INC (IX+nn)", "DEC (IX+nn)"
    2925/     E46 :                     ;
    2926/     E46 : 21 F2 13            	ld	hl, ddlogtbl
    2927/     E49 : CD 8C 10            	call	get_strBufpoint
    2928/     E4C : CD 0A 11            	call	mkopcstr
    2929/     E4F :                     
    2930/     E4F :                     mk_kixpnk:
    2931/     E4F : ED 5B 88 EF         	ld	de, (reg_xy)
    2932/     E53 :                     
    2933/     E53 :                     mk_kiypnk:
    2934/     E53 : 21 A8 EF            	ld	hl, dasm_OprStr
    2935/     E56 : C3 50 10            	jp	kixypnk_crlf		; "(IX+nnH)",cr,lf
    2936/     E59 :                     
    2937/     E59 :                     ;
    2938/     E59 :                     ; make "LD (IX+nn), r" or "LD r, (IX+nn)"
    2939/     E59 :                     ;
    2940/     E59 :                     dd_ld:
    2941/     E59 : 79                  	ld	a, c
    2942/     E5A : FE 07               	cp	7
    2943/     E5C : D2 71 0E            	jp	nc, dd_ld1
    2944/     E5F :                     	
    2945/     E5F :                     ; LD (IX+nn), r
    2946/     E5F : ED 5B 88 EF         	ld	de, (reg_xy)
    2947/     E63 : CD 47 10            	call	kixypnk_cs	; make "(IX+nn), "
    2948/     E66 :                     
    2949/     E66 : E5                  	push	hl
    2950/     E67 : 21 00 14            	ld	hl, dd_ldtbl
    2951/     E6A : CD 8C 10            	call	get_strBufpoint
    2952/     E6D : E1                  	pop	hl
    2953/     E6E : C3 33 11            	jp	cpstr_crlf	; "A", "L", "H", "E", D", "C", "B"
    2954/     E71 :                     				; CR, LF, 00h
    2955/     E71 :                     	
    2956/     E71 :                     ; LD r, (IX+nn)
    2957/     E71 :                     dd_ld1:
    2958/     E71 : D6 07               	sub	7
    2959/     E73 : 4F                  	ld	c, a
    2960/     E74 : 21 00 14            	ld	hl, dd_ldtbl
    2961/     E77 : CD 8C 10            	call	get_strBufpoint
    2962/     E7A :                     
    2963/     E7A : CD 5D 11            	call	mk_rcs		; "REG, "
    2964/     E7D :                     dd_mix4:
    2965/     E7D : ED 5B 88 EF         	ld	de, (reg_xy)
    2966/     E81 : C3 50 10            	jp	kixypnk_crlf	; "(IX+nn)", CR, LF, 00h
    2967/     E84 :                     
    2968/     E84 :                     
    2969/     E84 :                     ; "ADD A,(IX+nn)"
    2970/     E84 :                     dd_mix:
    2971/     E84 : 11 4D 12            	ld	de, ADDstr
    2972/     E87 :                     dd_mix3:
    2973/     E87 : CD 0A 11            	call	mkopcstr	; "ADD"
    2974/     E8A : CD 5A 11            	call	a_colon_sp	; "A, "
    2975/     E8D : 18 EE               	jr	dd_mix4		; "(IX+nn)",cr,lf
    2976/     E8F :                     
    2977/     E8F :                     ;"ADC A,(IX+nn)"
    2978/     E8F :                     dd_mix1:
    2979/     E8F : 11 51 12            	ld	de, ADCstr
    2980/     E92 : 18 F3               	jr	dd_mix3
    2981/     E94 :                     
    2982/     E94 :                     ;"SBC A,(IX+nn)"
    2983/     E94 :                     dd_mix2:
    2984/     E94 : 11 59 12            	ld	de, SBCstr
    2985/     E97 : 18 EE               	jr	dd_mix3
    2986/     E99 :                     
    2987/     E99 :                     ;
    2988/     E99 :                     ; check 0DD 4bytes MC
    2989/     E99 :                     ;
    2990/     E99 :                     chk_0DD4op:
    2991/     E99 : F5                  	push	af
    2992/     E9A : 3E 04               	ld	a, 4
    2993/     E9C : 32 8C EF            	ld	(mc_Size), a	; 2byte machine code
    2994/     E9F : F1                  	pop	af
    2995/     EA0 :                     
    2996/     EA0 : FE 21               	cp	21h
    2997/     EA2 : CA BF 0E            	jp	z, DD_21
    2998/     EA5 : FE 22               	cp	22h
    2999/     EA7 : CA CC 0E            	jp	z, DD_22
    3000/     EAA : FE 2A               	cp	2ah
    3001/     EAC : CA D5 0E            	jp	z, DD_2a
    3002/     EAF : FE 36               	cp	36h
    3003/     EB1 : C2 E5 0E            	jp	nz, chk_DD_CB
    3004/     EB4 :                     ; DD 36
    3005/     EB4 :                     ; "LD (IX+xx), yy"
    3006/     EB4 :                     
    3007/     EB4 : ED 5B 88 EF         	ld	de, (reg_xy)
    3008/     EB8 : CD 47 10            	call	kixypnk_cs	; "(IX+xx), "
    3009/     EBB : 5A                  	ld	e, d		; e: yy
    3010/     EBC : C3 95 10            	jp	mk_n2crlf	; "0yyH",cr,lf
    3011/     EBF :                     
    3012/     EBF :                     
    3013/     EBF :                     ; "LD IX, nnnn"
    3014/     EBF :                     DD_21:
    3015/     EBF : ED 5B 88 EF         	ld	de, (reg_xy)
    3016/     EC3 : CD 5D 11            	call	mk_rcs		; "IX, "
    3017/     EC6 : CD 75 10            	call	get_nnnn
    3018/     EC9 : C3 9B 10            	jp	mk_n4crlf	; "nnnnH",cr,lf
    3019/     ECC :                     
    3020/     ECC :                     ; "LD (nnnn), IX"
    3021/     ECC :                     DD_22:
    3022/     ECC : CD 75 10            	call	get_nnnn
    3023/     ECF : CD A1 10            	call	ins_kn4kcs	; "(nnnnH), "
    3024/     ED2 : C3 2A 11            	jp	ix_crlf		; "IX",cr,lf
    3025/     ED5 :                     
    3026/     ED5 :                     ; "LD IX, (nnnn)"
    3027/     ED5 :                     DD_2a:
    3028/     ED5 : ED 5B 88 EF         	ld	de, (reg_xy)
    3029/     ED9 :                     DD_2a1:
    3030/     ED9 : CD 5D 11            	call	mk_rcs		; "IX, "
    3031/     EDC : CD 75 10            	call	get_nnnn
    3032/     EDF : CD B0 10            	call	mk_kn4k		; "(nnnnH)"
    3033/     EE2 : C3 36 11            	jp	insPostStr	; cr,lf
    3034/     EE5 :                     
    3035/     EE5 :                     chk_DD_CB
    3036/     EE5 : FE CB               	cp	0CBH
    3037/     EE7 : C2 6D 0D            	jp	nz, op_err
    3038/     EEA :                     
    3039/     EEA : CD 75 10            	call	get_nnnn	; d: 3rd OP, e:nn
    3040/     EED : 7A                  	ld	a, d
    3041/     EEE :                     
    3042/     EEE : 01 07 00            	ld	bc, dd_rt_tble - dd_rt_tbles
    3043/     EF1 : 21 CF 11            	ld	hl, dd_rt_tbles
    3044/     EF4 : ED B1               	cpir
    3045/     EF6 : C2 05 0F            	jp	nz, DD_CB_nn_XX
    3046/     EF9 :                     
    3047/     EF9 : 21 38 14            	ld	hl, dd_rt_str
    3048/     EFC : CD 8C 10            	call	get_strBufpoint
    3049/     EFF : CD 0A 11            	call	mkopcstr	; RLC, RRC, RL, RR, SLA, SRA, SRL
    3050/     F02 : C3 4F 0E            	jp	mk_kixpnk	; "(IX+nnH)",cr,lf
    3051/     F05 :                     
    3052/     F05 :                     ; check BIT, RES, SET
    3053/     F05 :                     DD_CB_nn_XX:
    3054/     F05 :                     
    3055/     F05 :                     	; check undefine MC
    3056/     F05 : 01 18 00            	ld	bc, dd_bit_opTble - dd_bit_opTbl
    3057/     F08 : 21 D6 11            	ld	hl, dd_bit_opTbl
    3058/     F0B : ED B1               	cpir
    3059/     F0D : C2 6D 0D            	jp	nz, op_err
    3060/     F10 :                     
    3061/     F10 : FE 80               	cp	80h
    3062/     F12 : DA 29 0F            	jp	c, dd_bit
    3063/     F15 : FE C0               	cp	0c0h
    3064/     F17 : DA 31 0F            	jp	c, dd_res
    3065/     F1A :                     
    3066/     F1A :                     ; DD_SET
    3067/     F1A :                     ; "SET i, (IX+nn)"
    3068/     F1A :                     
    3069/     F1A : 11 3B 13            	ld	de, SETstr
    3070/     F1D : CD 0A 11            	call	mkopcstr
    3071/     F20 :                     
    3072/     F20 :                     DD_BSR:
    3073/     F20 :                     
    3074/     F20 : 21 A8 EF            	ld	hl, dasm_OprStr ; set operand string buffer
    3075/     F23 : CD 85 0D            	call	set_bitno	; "i, "
    3076/     F26 : C3 7D 0E            	jp	dd_mix4		; "(IX+nn)", cr,lf
    3077/     F29 :                     
    3078/     F29 :                     ; DD_BIT
    3079/     F29 :                     ; "BIT i, (IX+nn)"
    3080/     F29 :                     dd_bit:
    3081/     F29 : 11 D0 12            	ld	de, BITstr
    3082/     F2C : CD 0A 11            	call	mkopcstr
    3083/     F2F : 18 EF               	jr	DD_BSR
    3084/     F31 :                     
    3085/     F31 :                     ; DD_RES
    3086/     F31 :                     ; "RES i, (IX+nn)"
    3087/     F31 :                     dd_res:
    3088/     F31 : 11 D4 12            	ld	de, RESstr
    3089/     F34 : CD 0A 11            	call	mkopcstr
    3090/     F37 : 18 E7               	jr	DD_BSR
    3091/     F39 :                     
    3092/     F39 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3093/     F39 :                     	; OPECODE 0EDH check
    3094/     F39 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3095/     F39 :                     
    3096/     F39 :                     chk_0EDH:
    3097/     F39 : FE ED               	cp	0edh
    3098/     F3B : C2 36 10            	jp	nz, chk_0FDH
    3099/     F3E :                     
    3100/     F3E : 7E                  	ld	a, (hl)		; get 2nd opcode
    3101/     F3F :                     
    3102/     F3F :                     	; check undefine MC
    3103/     F3F : 01 38 00            	ld	bc, ed_op_tble - ed_op_tbl
    3104/     F42 : 21 EE 11            	ld	hl, ed_op_tbl
    3105/     F45 : ED B1               	cpir
    3106/     F47 : C2 6D 0D            	jp	nz, op_err
    3107/     F4A :                     
    3108/     F4A : 79                  	ld	a, c
    3109/     F4B : FE 06               	cp	6
    3110/     F4D : DA 17 10            	jp	c, ed_4mc
    3111/     F50 : FE 1B               	cp	27
    3112/     F52 : DA 09 10            	jp	c, ed_no_opr
    3113/     F55 : FE 1E               	cp	30
    3114/     F57 : DA F6 0F            	jp	c, ed_im
    3115/     F5A : CA D6 0F            	jp	z, ed_ld_ar
    3116/     F5D : FE 1F               	cp	31
    3117/     F5F : CA DF 0F            	jp	z, ed_ld_ai
    3118/     F62 : FE 20               	cp	32
    3119/     F64 : CA E8 0F            	jp	z, ed_ld_ra
    3120/     F67 : FE 21               	cp	33
    3121/     F69 : CA F1 0F            	jp	z, ed_ld_ia
    3122/     F6C : FE 26               	cp	38
    3123/     F6E : DA C5 0F            	jp	c, ed_adc
    3124/     F71 : FE 2A               	cp	42
    3125/     F73 : DA AF 0F            	jp	c, ed_sbc
    3126/     F76 : FE 31               	cp	49
    3127/     F78 : DA 94 0F            	jp	c, ed_out
    3128/     F7B :                     
    3129/     F7B :                     ; c: 49 - 55 : IN r,(C) (r:B,C,D,E,H,L,A)
    3130/     F7B :                     
    3131/     F7B : 11 B3 12            	ld	de, INstr
    3132/     F7E : CD 0A 11            	call	mkopcstr
    3133/     F81 :                     
    3134/     F81 : 79                  	ld	a, c
    3135/     F82 : D6 31               	sub	49
    3136/     F84 : 4F                  	ld	c, a
    3137/     F85 : 21 00 14            	ld	hl, dd_ldtbl
    3138/     F88 : CD 8C 10            	call	get_strBufpoint	; get strung buffer
    3139/     F8B : CD 5D 11            	call	mk_rcs		; "REG, "
    3140/     F8E : 11 43 13            	ld	de, KCKstr
    3141/     F91 : C3 33 11            	jp	cpstr_crlf	; "(C)",cr,lf
    3142/     F94 :                     
    3143/     F94 :                     ; c: 42 - 48 : OUT (C),r(r:B,C,D,E,H,L,A)
    3144/     F94 :                     ed_out:
    3145/     F94 : 11 AF 12            	ld	de, OUTstr
    3146/     F97 : CD 0A 11            	call	mkopcstr
    3147/     F9A :                     
    3148/     F9A : 11 43 13            	ld	de, KCKstr
    3149/     F9D : CD 5D 11            	call	mk_rcs		; "(C), "
    3150/     FA0 :                     
    3151/     FA0 : 79                  	ld	a, c
    3152/     FA1 : D6 2A               	sub	42
    3153/     FA3 : 4F                  	ld	c, a
    3154/     FA4 : E5                  	push	hl
    3155/     FA5 : 21 00 14            	ld	hl, dd_ldtbl
    3156/     FA8 :                     
    3157/     FA8 :                     ed_out1:
    3158/     FA8 : CD 8C 10            	call	get_strBufpoint	; get strung buffer
    3159/     FAB : E1                  	pop	hl
    3160/     FAC : C3 33 11            	jp	cpstr_crlf	; "REG",cr,lf
    3161/     FAF :                     
    3162/     FAF :                     ; c: 38 - 41 : SBC HL,rr(rr:BC,DE,HL,SP)
    3163/     FAF :                     ed_sbc:
    3164/     FAF : 11 59 12            	ld	de, SBCstr
    3165/     FB2 : CD 0A 11            	call	mkopcstr
    3166/     FB5 :                     
    3167/     FB5 : 11 97 2E            	ld	de, RNHL
    3168/     FB8 : CD 5D 11            	call	mk_rcs		; "HL, "
    3169/     FBB :                     
    3170/     FBB : 79                  	ld	a, c
    3171/     FBC : D6 26               	sub	38
    3172/     FBE :                     ed_sbc1:
    3173/     FBE : 4F                  	ld	c, a
    3174/     FBF : E5                  	push	hl
    3175/     FC0 : 21 88 13            	ld	hl, INC_DEC_ADDrp
    3176/     FC3 : 18 E3               	jr	ed_out1
    3177/     FC5 :                     
    3178/     FC5 :                     ; c: 34 - 37 : ADC HL,rr(rr:BC,DE,HL,SP)
    3179/     FC5 :                     ed_adc:
    3180/     FC5 : 11 51 12            	ld	de, ADCstr
    3181/     FC8 : CD 0A 11            	call	mkopcstr
    3182/     FCB :                     
    3183/     FCB : 11 97 2E            	ld	de, RNHL
    3184/     FCE : CD 5D 11            	call	mk_rcs		; "HL, "
    3185/     FD1 :                     
    3186/     FD1 : 79                  	ld	a, c
    3187/     FD2 : D6 22               	sub	34
    3188/     FD4 : 18 E8               	jr	ed_sbc1
    3189/     FD6 :                     
    3190/     FD6 :                     ; c: 30, 31 : LD A,R ; LD A,I
    3191/     FD6 :                     ed_ld_ar:
    3192/     FD6 : CD 5A 11            	call	a_colon_sp	; "A, "
    3193/     FD9 : 11 D2 2E            	ld	de, RNR
    3194/     FDC : C3 33 11            	jp	cpstr_crlf	; "R",cr,lf
    3195/     FDF :                     	
    3196/     FDF :                     ed_ld_ai:
    3197/     FDF : CD 5A 11            	call	a_colon_sp	; "A, "
    3198/     FE2 : 11 D0 2E            	ld	de, RNI
    3199/     FE5 : C3 33 11            	jp	cpstr_crlf	; "I",cr,lf
    3200/     FE8 :                     	
    3201/     FE8 :                     ; c: 32, 33 : LD R,A ; LD I,A
    3202/     FE8 :                     ed_ld_ra:
    3203/     FE8 : 11 D2 2E            	ld	de, RNR
    3204/     FEB :                     ed_ld_ra1:
    3205/     FEB : CD 5D 11            	call	mk_rcs		; "R, "
    3206/     FEE : C3 25 11            	jp	a_crlf		; "A",cr,lf
    3207/     FF1 :                     
    3208/     FF1 :                     ed_ld_ia:
    3209/     FF1 : 11 D0 2E            	ld	de, RNI
    3210/     FF4 : 18 F5               	jr	ed_ld_ra1
    3211/     FF6 :                     	
    3212/     FF6 :                     ; c: 27, 28, 29 : IM 2, IM 1, IM 0
    3213/     FF6 :                     ed_im:
    3214/     FF6 : 11 DC 12            	ld	de, IMstr
    3215/     FF9 : CD 0A 11            	call	mkopcstr
    3216/     FFC :                     
    3217/     FFC : 3E 1D               	ld	a, 29
    3218/     FFE : 91                  	sub	c
    3219/     FFF : C6 30               	add	a, '0'		; '0', '1', '2'
    3220/    1001 : 21 A8 EF            	ld	hl, dasm_OprStr
    3221/    1004 : 77                  	ld	(hl), a
    3222/    1005 : 23                  	inc	hl
    3223/    1006 : C3 36 11            	jp	insPostStr
    3224/    1009 :                     
    3225/    1009 :                     ; c: 6 - 26 ed_noopr
    3226/    1009 :                     ed_no_opr:
    3227/    1009 : D6 06               	sub	6
    3228/    100B : 4F                  	ld	c, a
    3229/    100C : 06 00               	ld	b, 0
    3230/    100E : 21 0E 14            	ld	hl, ed_noopr
    3231/    1011 : CD 8C 10            	call	get_strBufpoint		; de : string buffer
    3232/    1014 : C3 0A 11            	jp	mkopcstr
    3233/    1017 :                     ;
    3234/    1017 :                     ; check ED 4 byte MC
    3235/    1017 :                     ;
    3236/    1017 :                     ed_4mc:
    3237/    1017 : 3E 04               	ld	a, 4
    3238/    1019 : 32 8C EF            	ld	(mc_Size), a	; 4byte machine code
    3239/    101C :                     
    3240/    101C : C5                  	push	bc
    3241/    101D : 79                  	ld	a, c
    3242/    101E : 21 CE 13            	ld	hl, ed_rp_str
    3243/    1021 : CD 8C 10            	call	get_strBufpoint		; de : string buffer
    3244/    1024 : C1                  	pop	bc
    3245/    1025 : 79                  	ld	a, c
    3246/    1026 : FE 03               	cp	3
    3247/    1028 : DA D9 0E            	jp	c, DD_2a1		; "rr, (nnnnH)",cr,lf
    3248/    102B :                     					; rr: BC, DE, SP
    3249/    102B :                     ; "(nnnnH), rr" rr: BC, DE, SP
    3250/    102B :                     
    3251/    102B : D5                  	push	de
    3252/    102C : CD 75 10            	call	get_nnnn
    3253/    102F : CD A1 10            	call	ins_kn4kcs	; "(nnnnH), "
    3254/    1032 : D1                  	pop	de
    3255/    1033 : C3 33 11            	jp	cpstr_crlf	; "REG",cr,lf
    3256/    1036 :                     
    3257/    1036 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3258/    1036 :                     	; OPECODE 0FDH check
    3259/    1036 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3260/    1036 :                     
    3261/    1036 :                     chk_0FDH:
    3262/    1036 :                     
    3263/    1036 : 11 C7 2E            	ld	de, RNIY
    3264/    1039 : ED 53 88 EF         	ld	(reg_xy), de	; save index reg string
    3265/    103D : 11 EA 13            	ld	de, addiyrp_tbl
    3266/    1040 : ED 53 8A EF         	ld	(xy_srtp), de
    3267/    1044 :                     
    3268/    1044 : C3 A6 0D            	jp	chk_0DDH_1
    3269/    1047 :                     
    3270/    1047 :                     ;-----------------------------------
    3271/    1047 :                     ; make "(REG+nn), " at dasm_OprStr
    3272/    1047 :                     ;	REG : IX or IY
    3273/    1047 :                     ; input de: RNIX, or RNIY
    3274/    1047 :                     ;-----------------------------------
    3275/    1047 :                     kixypnk_cs:
    3276/    1047 : 21 A8 EF            	ld	hl, dasm_OprStr
    3277/    104A : CD 56 10            	call	mk_kixypnk
    3278/    104D : C3 82 11            	jp	ins_kmR
    3279/    1050 :                     
    3280/    1050 :                     ;-----------------------------------
    3281/    1050 :                     ; make "(REG+nn)",cr,lf 
    3282/    1050 :                     ;	REG : IX or IY
    3283/    1050 :                     ; input de: RNIX, or RNIY
    3284/    1050 :                     ;       hl: string buffer
    3285/    1050 :                     ;-----------------------------------
    3286/    1050 :                     kixypnk_crlf:
    3287/    1050 : CD 56 10            	call	mk_kixypnk
    3288/    1053 : C3 36 11            	jp	insPostStr	; CR, LF, 00h
    3289/    1056 :                     
    3290/    1056 :                     ;-----------------------------------
    3291/    1056 :                     ; make "(IX+nn)", "(IY+nn)" string
    3292/    1056 :                     ; input de: RNIX, or RNIY
    3293/    1056 :                     ;       hl: string buffer
    3294/    1056 :                     ;-----------------------------------
    3295/    1056 :                     mk_kixypnk:
    3296/    1056 : CD 6D 11            	call	ins_kakkoL	; "("
    3297/    1059 : CD 65 11            	call	st_copy	; IX
    3298/    105C : CD 75 10            	call	get_nnnn
    3299/    105F : 7B                  	ld	a, e		;get number
    3300/    1060 : FE 80               	cp	80h
    3301/    1062 : 38 0C               	jr	c, numPlus	; number plus
    3302/    1064 : ED 44               	neg			; a = not a + 1
    3303/    1066 : 5F                  	ld	e, a
    3304/    1067 : CD 7E 11            	call	ins_misR	; -
    3305/    106A :                     sv_nnkr:
    3306/    106A : CD D8 10            	call	hex2str_asm	; nnh
    3307/    106D : C3 71 11            	jp	ins_kakkoR	; ")"
    3308/    1070 :                     	
    3309/    1070 :                     numPlus:
    3310/    1070 : CD 7A 11            	call	ins_plsR	; +
    3311/    1073 : 18 F5               	jr	sv_nnkr
    3312/    1075 :                     
    3313/    1075 :                     ; de : nnnn , or d:yy, e:xx
    3314/    1075 :                     get_nnnn:
    3315/    1075 : E5                  	push	hl
    3316/    1076 : 2A 86 EF            	ld	hl, (dasm_adr)
    3317/    1079 : 23                  	inc	hl		; 2nd opecode address
    3318/    107A : 23                  	inc	hl		; operand address
    3319/    107B : 5E                  	ld	e, (hl)		; get nn
    3320/    107C : 23                  	inc	hl
    3321/    107D : 56                  	ld	d, (hl)		; d:yy use for "LD (IX+xx), yy"
    3322/    107E :                     				; d:OP use for 4bytes MC like "DD CB xx OP"
    3323/    107E :                     				; de : YYXX : ED OP XX YY
    3324/    107E : E1                  	pop	hl
    3325/    107F : C9                  	ret
    3326/    1080 :                     
    3327/    1080 :                     ;-------------------------------------------------
    3328/    1080 :                     ; hl: massage table
    3329/    1080 :                     ; bc: found operand point
    3330/    1080 :                     ;
    3331/    1080 :                     ; output: copy strings to dasm_OprStr buffer
    3332/    1080 :                     ;         hl = end point of copied string buffer
    3333/    1080 :                     ;-------------------------------------------------
    3334/    1080 :                     mk_str:
    3335/    1080 : CD 8C 10            	call	get_strBufpoint
    3336/    1083 : 21 A8 EF            	ld	hl, dasm_OprStr
    3337/    1086 : C3 65 11            	jp	st_copy
    3338/    1089 :                     
    3339/    1089 :                     ;------------------------------------------------
    3340/    1089 :                     ; get register strings address
    3341/    1089 :                     ; input bc: string buffer offset
    3342/    1089 :                     ; output de: register strings address
    3343/    1089 :                     ;------------------------------------------------
    3344/    1089 :                     get_rstg_off:
    3345/    1089 : 21 60 13            	ld	hl, disRegTbl
    3346/    108C :                     
    3347/    108C :                     ;-------------------------------------------------
    3348/    108C :                     ; input
    3349/    108C :                     ;	bc: found operand point
    3350/    108C :                     ;	hl: massage table
    3351/    108C :                     ; output: 
    3352/    108C :                     ;	DE : string point
    3353/    108C :                     ;-------------------------------------------------
    3354/    108C :                     get_strBufpoint:
    3355/    108C : CB 21               	sla	c
    3356/    108E : CB 10               	rl	b		; bc *=2
    3357/    1090 : 09                  	add	hl, bc		; get operand string point
    3358/    1091 : 5E                  	ld	e, (hl)
    3359/    1092 : 23                  	inc	hl
    3360/    1093 : 56                  	ld	d, (hl)
    3361/    1094 : C9                  	ret
    3362/    1095 :                     
    3363/    1095 :                     ;------------------------------------------------
    3364/    1095 :                     ; insert "nnH", CR, LF to buffer
    3365/    1095 :                     ;input e: value
    3366/    1095 :                     ;      hl: string buffer
    3367/    1095 :                     ;------------------------------------------------
    3368/    1095 :                     mk_n2crlf:
    3369/    1095 : CD D8 10            	call	hex2str_asm
    3370/    1098 : C3 36 11            	jp	insPostStr
    3371/    109B :                     
    3372/    109B :                     ;------------------------------------------------
    3373/    109B :                     ; insert "nnnnH", CR, LF to buffer
    3374/    109B :                     ;input de: value
    3375/    109B :                     ;      hl: string buffer
    3376/    109B :                     ;------------------------------------------------
    3377/    109B :                     mk_n4crlf:
    3378/    109B : CD C7 10            	call	hex4str_asm
    3379/    109E : C3 36 11            	jp	insPostStr
    3380/    10A1 :                     
    3381/    10A1 :                     ;------------------------------------------------
    3382/    10A1 :                     ; insert "(nnnnH), " to buffer dasm_OprStr
    3383/    10A1 :                     ;input de: value
    3384/    10A1 :                     ;
    3385/    10A1 :                     ; make "(nnnnH), " to dasm_OprStr buffer
    3386/    10A1 :                     ; output hl: end point of string buffer
    3387/    10A1 :                     ;------------------------------------------------
    3388/    10A1 :                     ins_kn4kcs:
    3389/    10A1 : 21 A8 EF            	ld	hl, dasm_OprStr	;operand str buffer
    3390/    10A4 : CD 6D 11            	call	ins_kakkoL	; "("
    3391/    10A7 : CD C7 10            	call	hex4str_asm
    3392/    10AA : CD 71 11            	call	ins_kakkoR	; ")"
    3393/    10AD : C3 82 11            	jp	ins_kmR		; ", "
    3394/    10B0 :                     
    3395/    10B0 :                     ;------------------------------------------------
    3396/    10B0 :                     ; insert "(nnnnH)" to buffer
    3397/    10B0 :                     ;input de: value
    3398/    10B0 :                     ;      hl: string buffer
    3399/    10B0 :                     ;------------------------------------------------
    3400/    10B0 :                     mk_kn4k:
    3401/    10B0 : CD 6D 11            	call	ins_kakkoL	; "("
    3402/    10B3 : CD C7 10            	call	hex4str_asm
    3403/    10B6 : C3 71 11            	jp	ins_kakkoR	; ")"
    3404/    10B9 :                     
    3405/    10B9 :                     ;------------------------------------------------
    3406/    10B9 :                     ; Make address string from branch relative value
    3407/    10B9 :                     ; input hl: string buffer pointer
    3408/    10B9 :                     ; output *hl= "nnnnH",cr,lf,0
    3409/    10B9 :                     ;------------------------------------------------
    3410/    10B9 :                     mkRel_str:
    3411/    10B9 : E5                  	push	hl
    3412/    10BA : 2A 86 EF            	ld	hl, (dasm_adr)
    3413/    10BD : CD 18 06            	call	Rel_adr_c	; return hl : target addr
    3414/    10C0 : EB                  	ex	de, hl		; hl: buffer, de: addr value
    3415/    10C1 : E1                  	pop	hl
    3416/    10C2 : CD C7 10            	call	hex4str_asm
    3417/    10C5 : 18 6F               	jr	insPostStr
    3418/    10C7 :                     	
    3419/    10C7 :                     ;------------------------------------------------
    3420/    10C7 :                     ;input de: value, hl: save baffer.
    3421/    10C7 :                     ;output 4hex chars(asm format)
    3422/    10C7 :                     ;	(ex). "0FFFFH"
    3423/    10C7 :                     ;             "1234H"
    3424/    10C7 :                     ;       hl : hl = hl + 5(or 6); *hl=0
    3425/    10C7 :                     ;------------------------------------------------
    3426/    10C7 :                     hex4str_asm:
    3427/    10C7 : 7A                  	ld	a, d
    3428/    10C8 : FE A0               	cp	0a0h
    3429/    10CA : 38 04               	jr	c, h4sa_1
    3430/    10CC : 3E 30               	ld	a, '0'
    3431/    10CE : 77                  	ld	(hl), a
    3432/    10CF : 23                  	inc	hl
    3433/    10D0 :                     
    3434/    10D0 :                     h4sa_1:
    3435/    10D0 : CD E6 10            	call	hex4str
    3436/    10D3 :                     h4sa_2:
    3437/    10D3 : 3E 48               	ld	a, 'H'
    3438/    10D5 : C3 73 11            	jp	ikk_1
    3439/    10D8 :                     
    3440/    10D8 :                     ;------------------------------------------------
    3441/    10D8 :                     ;input e: value, hl: save baffer.
    3442/    10D8 :                     ;output: 2 hex chars(asm format)
    3443/    10D8 :                     ;	(ex). "0FFH"
    3444/    10D8 :                     ;             "12H"
    3445/    10D8 :                     ;       hl : hl = hl + 3(or 4); *hl=0
    3446/    10D8 :                     ;------------------------------------------------
    3447/    10D8 :                     hex2str_asm:
    3448/    10D8 : 7B                  	ld	a, e
    3449/    10D9 : FE A0               	cp	0a0h
    3450/    10DB : 38 04               	jr	c, h2sa_1
    3451/    10DD : 3E 30               	ld	a, '0'
    3452/    10DF : 77                  	ld	(hl), a
    3453/    10E0 : 23                  	inc	hl
    3454/    10E1 :                     
    3455/    10E1 :                     h2sa_1:
    3456/    10E1 : CD EE 10            	call	hex2str
    3457/    10E4 : 18 ED               	jr	h4sa_2
    3458/    10E6 :                     
    3459/    10E6 :                     ;------------------------------------------------
    3460/    10E6 :                     ;input de: value, hl: save baffer.
    3461/    10E6 :                     ;output: 4 hex chras in save buffer
    3462/    10E6 :                     ;	 hl = hl + 4
    3463/    10E6 :                     ;------------------------------------------------
    3464/    10E6 :                     hex4str:
    3465/    10E6 : 7A                  	ld	a, d
    3466/    10E7 : CD F7 10            	call	h2s_n1
    3467/    10EA : 7A                  	ld	a, d
    3468/    10EB : CD FB 10            	call	h2s_n2
    3469/    10EE :                     
    3470/    10EE :                     ;------------------------------------------------
    3471/    10EE :                     ;input e: value, hl: save baffer.
    3472/    10EE :                     ;output: 2 hex chras in save buffer
    3473/    10EE :                     ;	 hl = hl + 2
    3474/    10EE :                     ;------------------------------------------------
    3475/    10EE :                     hex2str:
    3476/    10EE : 7B                  	ld	a, e
    3477/    10EF : CD F7 10            	call	h2s_n1
    3478/    10F2 : 7B                  	ld	a, e
    3479/    10F3 : CD FB 10            	call	h2s_n2
    3480/    10F6 : C9                  	ret
    3481/    10F7 :                     
    3482/    10F7 :                     h2s_n1:
    3483/    10F7 : 0F                  	rrca
    3484/    10F8 : 0F                  	rrca
    3485/    10F9 : 0F                  	rrca
    3486/    10FA : 0F                  	rrca
    3487/    10FB :                     h2s_n2:
    3488/    10FB : E6 0F               	and	0fh
    3489/    10FD : F6 30               	or	30h
    3490/    10FF : FE 3A               	cp	3aH
    3491/    1101 : 38 70               	jr	c, ikk_1	; '0' to '9'
    3492/    1103 : C6 07               	add	a, 07h		; 'A' to 'F'
    3493/    1105 : 18 6C               	jr	ikk_1
    3494/    1107 :                     
    3495/    1107 :                     add_opstr:
    3496/    1107 : 11 4D 12            	ld	de, ADDstr
    3497/    110A :                     ;-----------------------------------
    3498/    110A :                     ; make opecode strings
    3499/    110A :                     ; input de : opecode strings
    3500/    110A :                     ;-----------------------------------
    3501/    110A :                     mkopcstr:
    3502/    110A : F5                  	push	af
    3503/    110B : C5                  	push	bc
    3504/    110C : 06 08               	ld	b, 8	;tab size
    3505/    110E : 21 A0 EF            	ld	hl, dasm_OpcStr
    3506/    1111 :                     dmkstr0:
    3507/    1111 : 1A                  	ld	a, (de)
    3508/    1112 : B7                  	or	a
    3509/    1113 : 28 06               	jr	z, dmkst1
    3510/    1115 : 77                  	ld	(hl), a
    3511/    1116 : 23                  	inc	hl
    3512/    1117 : 13                  	inc	de
    3513/    1118 : 05                  	dec	b
    3514/    1119 : 18 F6               	jr	dmkstr0
    3515/    111B :                     dmkst1:
    3516/    111B : 3E 20               	ld	a, ' '
    3517/    111D :                     dmkst2:
    3518/    111D : 77                  	ld	(hl), a
    3519/    111E : 23                  	inc	hl
    3520/    111F : 05                  	dec	b
    3521/    1120 : 20 FB               	jr	nz, dmkst2
    3522/    1122 : C1                  	pop	bc
    3523/    1123 : F1                  	pop	af
    3524/    1124 : C9                  	ret
    3525/    1125 :                     
    3526/    1125 :                     ;
    3527/    1125 :                     ; "REG",CR,LF
    3528/    1125 :                     ;
    3529/    1125 :                     a_crlf:
    3530/    1125 : 11 87 2E            	ld	de, RNA
    3531/    1128 : 18 09               	jr	cpstr_crlf	; "A",CR,LF
    3532/    112A :                     ;bc_crlf:
    3533/    112A :                     ;	ld	de, RNBC
    3534/    112A :                     ;	jr	cpstr_crlf
    3535/    112A :                     ;de_crlf:
    3536/    112A :                     ;	ld	de, RNDE
    3537/    112A :                     ;	jr	cpstr_crlf
    3538/    112A :                     ix_crlf:
    3539/    112A : ED 5B 88 EF         	ld	de, (reg_xy)
    3540/    112E : 18 03               	jr	cpstr_crlf
    3541/    1130 :                     ;sp_crlf:
    3542/    1130 :                     ;	ld	de, RNSP
    3543/    1130 :                     ;	jr	cpstr_crlf
    3544/    1130 :                     hl_crlf:
    3545/    1130 : 11 97 2E            	ld	de, RNHL
    3546/    1133 :                     cpstr_crlf:
    3547/    1133 : CD 65 11            	call	st_copy		; "REG"
    3548/    1136 :                     	
    3549/    1136 :                     ;-----------------------------------
    3550/    1136 :                     ; insert CR, LF, 00H(end delimiter)
    3551/    1136 :                     ; input hl : insert buffer
    3552/    1136 :                     ;-----------------------------------
    3553/    1136 :                     insPostStr:
    3554/    1136 : 3E 0D               	ld	a, CR
    3555/    1138 : 77                  	ld	(hl), a		; CR code
    3556/    1139 : 23                  	inc	hl
    3557/    113A : 3E 0A               	ld	a, LF
    3558/    113C : 77                  	ld	(hl), a		; LF code
    3559/    113D : 23                  	inc	hl
    3560/    113E : AF                  	xor	a
    3561/    113F : 77                  	ld	(hl), a		; end delimiter
    3562/    1140 : C9                  	ret
    3563/    1141 :                     
    3564/    1141 :                     mk_krk_1:
    3565/    1141 : 21 A8 EF            	ld	hl, dasm_OprStr
    3566/    1144 :                     ;----------------------------
    3567/    1144 :                     ; insert "(Reg)" to buffer
    3568/    1144 :                     ;
    3569/    1144 :                     ; input de: register string
    3570/    1144 :                     ;	hl: save buffer
    3571/    1144 :                     ;----------------------------
    3572/    1144 :                     mk_krk:
    3573/    1144 : CD 6D 11            	call	ins_kakkoL	; "("
    3574/    1147 : CD 65 11            	call	st_copy		; "REG"
    3575/    114A : 18 25               	jr	ins_kakkoR	; ")"
    3576/    114C :                     
    3577/    114C :                     ;----------------------------
    3578/    114C :                     ; insert "(Reg), " to dasm_OprStr
    3579/    114C :                     ;
    3580/    114C :                     ; input de: register string
    3581/    114C :                     ;----------------------------
    3582/    114C :                     mk_krkcs:
    3583/    114C : 21 A8 EF            	ld	hl, dasm_OprStr
    3584/    114F : CD 6D 11            	call	ins_kakkoL	; "("
    3585/    1152 : CD 65 11            	call	st_copy		; "REG"
    3586/    1155 : CD 71 11            	call	ins_kakkoR	; ")"
    3587/    1158 : 18 28               	jr	ins_kmR		; ", "
    3588/    115A :                     
    3589/    115A :                     ;----------------------------
    3590/    115A :                     ; insert "A, " to dasm_OprStr
    3591/    115A :                     ;----------------------------
    3592/    115A :                     a_colon_sp:
    3593/    115A : 11 87 2E            	ld	de, RNA
    3594/    115D :                     ;----------------------------
    3595/    115D :                     ; insert "Reg, " to dasm_OprStr
    3596/    115D :                     ;
    3597/    115D :                     ; input de: register string
    3598/    115D :                     ;----------------------------
    3599/    115D :                     mk_rcs:
    3600/    115D : 21 A8 EF            	ld	hl, dasm_OprStr
    3601/    1160 : CD 65 11            	call	st_copy		; "REG"
    3602/    1163 : 18 1D               	jr	ins_kmR		; ", "
    3603/    1165 :                     
    3604/    1165 :                     ;-------------------------------------------------
    3605/    1165 :                     ; copy string to output buffer
    3606/    1165 :                     ; input:
    3607/    1165 :                     ;	de : string point
    3608/    1165 :                     ;	hl : output buffer
    3609/    1165 :                     ;-------------------------------------------------
    3610/    1165 :                     st_copy:
    3611/    1165 : 1A                  	ld	a, (de)
    3612/    1166 : 77                  	ld	(hl), a
    3613/    1167 : B7                  	or	a
    3614/    1168 : C8                  	ret	z	; return after coping delimiter
    3615/    1169 :                     			; hl : delimiter position
    3616/    1169 : 23                  	inc	hl
    3617/    116A : 13                  	inc	de
    3618/    116B : 18 F8               	jr	st_copy
    3619/    116D :                     
    3620/    116D :                     ;--------------
    3621/    116D :                     ; insert "("
    3622/    116D :                     ;--------------
    3623/    116D :                     ins_kakkoL:
    3624/    116D : 3E 28               	ld	a, '('
    3625/    116F : 18 02               	jr	ikk_1
    3626/    1171 :                     	
    3627/    1171 :                     ;--------------
    3628/    1171 :                     ; insert ")"
    3629/    1171 :                     ;--------------
    3630/    1171 :                     ins_kakkoR:
    3631/    1171 : 3E 29               	ld	a, ')'
    3632/    1173 :                     ikk_1:
    3633/    1173 : 77                  	ld	(hl), a
    3634/    1174 : 23                  	inc	hl
    3635/    1175 : C9                  	ret
    3636/    1176 :                     
    3637/    1176 :                     ;--------------
    3638/    1176 :                     ; insert " "
    3639/    1176 :                     ;--------------
    3640/    1176 :                     ins_spcR:
    3641/    1176 : 3E 20               	ld	a, ' '
    3642/    1178 : 18 F9               	jr	ikk_1
    3643/    117A :                     
    3644/    117A :                     ;--------------
    3645/    117A :                     ; insert "+"
    3646/    117A :                     ;--------------
    3647/    117A :                     ins_plsR:
    3648/    117A : 3E 2B               	ld	a, '+'
    3649/    117C : 18 F5               	jr	ikk_1
    3650/    117E :                     
    3651/    117E :                     ;--------------
    3652/    117E :                     ; insert "-"
    3653/    117E :                     ;--------------
    3654/    117E :                     ins_misR:
    3655/    117E : 3E 2D               	ld	a, '-'
    3656/    1180 : 18 F1               	jr	ikk_1
    3657/    1182 :                     
    3658/    1182 :                     ;--------------
    3659/    1182 :                     ; insert ", "
    3660/    1182 :                     ;--------------
    3661/    1182 :                     ins_kmR:
    3662/    1182 : 3E 2C               	ld	a, ','
    3663/    1184 : CD 73 11            	call	ikk_1
    3664/    1187 : 18 ED               	jr	ins_spcR
    3665/    1189 :                     
    3666/    1189 :                     ;------------------------------------------
    3667/    1189 :                     ; Dis assemble tables
    3668/    1189 :                     ;------------------------------------------
    3669/    1189 :                     oth_1op_s:
    3670/    1189 : 00                  	DB	00H	; NOP
    3671/    118A : 07                  	DB	07H	; RLCA
    3672/    118B : 0F                  	DB	0FH	; RRCA
    3673/    118C : 17                  	DB	17H	; RLA
    3674/    118D : 1F                  	DB	1FH	; RRA
    3675/    118E : 27                  	DB	27H	; DAA
    3676/    118F : 2F                  	DB	2FH	; CPL
    3677/    1190 : 37                  	DB	37H	; SCF
    3678/    1191 : 3F                  	DB	3FH	; CCF
    3679/    1192 : C9                  	DB	0C9H	; RET
    3680/    1193 : D9                  	DB	0D9H	; EXX
    3681/    1194 : F3                  	DB	0F3H	; DI
    3682/    1195 : FB                  	DB	0FBH	; EI
    3683/    1196 :                     oth_1op_e:
    3684/    1196 :                     
    3685/    1196 :                     INC_OPCDTBLS:
    3686/    1196 : 04                  	DB	04H	; INC	B
    3687/    1197 : 0C                  	DB	0CH	; INC	C
    3688/    1198 : 14                  	DB	14H	; INC	D
    3689/    1199 : 1C                  	DB	1CH	; INC	E
    3690/    119A : 24                  	DB	24H	; INC	H
    3691/    119B : 2C                  	DB	2CH	; INC	L
    3692/    119C : 34                  	DB	34H	; INC	(HL)
    3693/    119D : 3C                  	DB	3CH	; INC	A
    3694/    119E :                     INC_OPCDTBLE:
    3695/    119E :                     
    3696/    119E :                     DEC_OPCDTBLS:
    3697/    119E : 05                  	DB	05H	; DEC	B
    3698/    119F : 0D                  	DB	0DH	; DEC	C
    3699/    11A0 : 15                  	DB	15H	; DEC	D
    3700/    11A1 : 1D                  	DB	1DH	; DEC	E
    3701/    11A2 : 25                  	DB	25H	; DEC	H
    3702/    11A3 : 2D                  	DB	2DH	; DEC	L
    3703/    11A4 : 35                  	DB	35H	; DEC	(HL)
    3704/    11A5 : 3D                  	DB	3DH	; DEC	A
    3705/    11A6 :                     DEC_OPCDTBLE:
    3706/    11A6 :                     
    3707/    11A6 :                     inc_rp_s:
    3708/    11A6 : 03                  	DB	03H	; INC	BC
    3709/    11A7 : 13                  	DB	13H	; INC	DE
    3710/    11A8 : 23                  	DB	23H	; INC	HL
    3711/    11A9 : 33                  	DB	33H	; INC	SP
    3712/    11AA :                     inc_rp_e:
    3713/    11AA :                     
    3714/    11AA :                     dec_rp_s:
    3715/    11AA : 0B                  	DB	0BH	; DEC	BC
    3716/    11AB : 1B                  	DB	1BH	; DEC	DE
    3717/    11AC : 2B                  	DB	2BH	; DEC	HL
    3718/    11AD : 3B                  	DB	3BH	; DEC	SP
    3719/    11AE :                     dec_rp_e:
    3720/    11AE :                     
    3721/    11AE :                     add_rp_s:
    3722/    11AE : 09                  	DB	09H	; ADD	HL,BC
    3723/    11AF : 19                  	DB	19H	; ADD	HL,DE
    3724/    11B0 : 29                  	DB	29H	; ADD	HL,HL
    3725/    11B1 : 39                  	DB	39H	; ADD	HL,SP
    3726/    11B2 :                     add_rp_e:
    3727/    11B2 :                     
    3728/    11B2 :                     pop_rp_s:
    3729/    11B2 : C1                  	DB	0C1H	; POP	BC
    3730/    11B3 : D1                  	DB	0D1H	; POP	DE
    3731/    11B4 : E1                  	DB	0E1H	; POP	HL
    3732/    11B5 : F1                  	DB	0F1H	; POP	AF
    3733/    11B6 :                     pop_rp_e:
    3734/    11B6 :                     
    3735/    11B6 :                     push_rp_s:
    3736/    11B6 : C5                  	DB	0C5H	; PUSH	BC
    3737/    11B7 : D5                  	DB	0D5H	; PUSH	DE
    3738/    11B8 : E5                  	DB	0E5H	; PUSH	HL
    3739/    11B9 : F5                  	DB	0F5H	; PUSH	AF
    3740/    11BA :                     push_rp_e:
    3741/    11BA :                     
    3742/    11BA :                     dd_ld_tbl:
    3743/    11BA : 46                  	DB	46h	; nn: LD B,(IX+nn)
    3744/    11BB : 4E                  	DB	4Eh	; nn: LD C,(IX+nn)
    3745/    11BC : 56                  	DB	56h	; nn: LD D,(IX+nn)
    3746/    11BD : 5E                  	DB	5Eh	; nn: LD E,(IX+nn)
    3747/    11BE : 66                  	DB	66h	; nn: LD H,(IX+nn)
    3748/    11BF : 6E                  	DB	6Eh	; nn: LD L,(IX+nn)
    3749/    11C0 : 7E                  	DB	7Eh	; nn: LD A,(IX+nn)
    3750/    11C1 :                     
    3751/    11C1 : 70                  	DB	70h	; nn: LD (IX+nn),B
    3752/    11C2 : 71                  	DB	71h	; nn: LD (IX+nn),C
    3753/    11C3 : 72                  	DB	72h	; nn: LD (IX+nn),D
    3754/    11C4 : 73                  	DB	73h	; nn: LD (IX+nn),E
    3755/    11C5 : 74                  	DB	74h	; nn: LD (IX+nn),H
    3756/    11C6 : 75                  	DB	75h	; nn: LD (IX+nn),L
    3757/    11C7 : 77                  	DB	77h	; nn: LD (IX+nn),A
    3758/    11C8 :                     dd_ld_tble:
    3759/    11C8 :                     
    3760/    11C8 :                     dd_log_tbl:
    3761/    11C8 : 96                  	DB	96h	; nn: SUB (IX+nn)
    3762/    11C9 : A6                  	DB	0A6h	; nn: AND (IX+nn)
    3763/    11CA : AE                  	DB	0AEh	; nn: XOR (IX+nn)
    3764/    11CB : B6                  	DB	0B6h	; nn: OR  (IX+nn)
    3765/    11CC : BE                  	DB	0BEh	; nn: CP  (IX+nn)
    3766/    11CD : 34                  	DB	34h	; nn: INC (IX+nn)
    3767/    11CE : 35                  	DB	35h	; nn: DEC (IX+nn)
    3768/    11CF :                     dd_log_tble:
    3769/    11CF :                     
    3770/    11CF :                     dd_rt_tbles:
    3771/    11CF : 06                  	DB	06h	; RLC (IX+nn)
    3772/    11D0 : 0E                  	DB	0Eh	; RRC (IX+nn)
    3773/    11D1 : 16                  	DB	16h	; RL  (IX+nn)
    3774/    11D2 : 1E                  	DB	1Eh	; RR  (IX+nn)
    3775/    11D3 : 26                  	DB	26h	; SLA (IX+nn)
    3776/    11D4 : 2E                  	DB	2Eh	; SRA (IX+nn)
    3777/    11D5 : 3E                  	DB	3Eh	; SRL (IX+nn)
    3778/    11D6 :                     dd_rt_tble:
    3779/    11D6 :                     
    3780/    11D6 :                     ; use checking undefine MC ( DD CB nn XX )
    3781/    11D6 :                     dd_bit_opTbl:
    3782/    11D6 : 46                  	DB	46h	; BIT 0,(IX+12H)
    3783/    11D7 : 4E                  	DB	4Eh	; BIT 1,(IX+12H)
    3784/    11D8 : 56                  	DB	56h	; BIT 2,(IX+12H)
    3785/    11D9 : 5E                  	DB	5Eh	; BIT 3,(IX+12H)
    3786/    11DA : 66                  	DB	66h	; BIT 4,(IX+12H)
    3787/    11DB : 6E                  	DB	6Eh	; BIT 5,(IX+12H)
    3788/    11DC : 76                  	DB	76h	; BIT 6,(IX+12H)
    3789/    11DD : 7E                  	DB	7Eh	; BIT 7,(IX+12H)
    3790/    11DE : 86                  	DB	86h	; RES 0,(IX+12H)
    3791/    11DF : 8E                  	DB	8Eh	; RES 1,(IX+12H)
    3792/    11E0 : 96                  	DB	96h	; RES 2,(IX+12H)
    3793/    11E1 : 9E                  	DB	9Eh	; RES 3,(IX+12H)
    3794/    11E2 : A6                  	DB	0A6h	; RES 4,(IX+12H)
    3795/    11E3 : AE                  	DB	0AEh	; RES 5,(IX+12H)
    3796/    11E4 : B6                  	DB	0B6h	; RES 6,(IX+12H)
    3797/    11E5 : BE                  	DB	0BEh	; RES 7,(IX+12H)
    3798/    11E6 : C6                  	DB	0C6h	; SET 0,(IX+12H)
    3799/    11E7 : CE                  	DB	0CEh	; SET 1,(IX+12H)
    3800/    11E8 : D6                  	DB	0D6h	; SET 2,(IX+12H)
    3801/    11E9 : DE                  	DB	0DEh	; SET 3,(IX+12H)
    3802/    11EA : E6                  	DB	0E6h	; SET 4,(IX+12H)
    3803/    11EB : EE                  	DB	0EEh	; SET 5,(IX+12H)
    3804/    11EC : F6                  	DB	0F6h	; SET 6,(IX+12H)
    3805/    11ED : FE                  	DB	0FEh	; SET 7,(IX+12H)
    3806/    11EE :                     dd_bit_opTble:
    3807/    11EE :                     
    3808/    11EE :                     ; use checking undefine MC ( ED XX ....)
    3809/    11EE :                     ed_op_tbl:
    3810/    11EE : 40                  	DB	40h	; 55:IN  B,(C)
    3811/    11EF : 48                   	DB	48h	; 54:IN  C,(C)
    3812/    11F0 : 50                  	DB	50h	; 53:IN  D,(C)
    3813/    11F1 : 58                  	DB	58h	; 52:IN  E,(C)
    3814/    11F2 : 60                  	DB	60h	; 51:IN  H,(C)
    3815/    11F3 : 68                  	DB	68h	; 50:IN  L,(C)
    3816/    11F4 : 78                  	DB	78h	; 49:IN  A,(C)
    3817/    11F5 :                     
    3818/    11F5 : 41                  	DB	41h	; 48:OUT (C),B
    3819/    11F6 : 49                  	DB	49h	; 47:OUT (C),C
    3820/    11F7 : 51                  	DB	51h	; 46:OUT (C),D
    3821/    11F8 : 59                  	DB	59h	; 45:OUT (C),E
    3822/    11F9 : 61                  	DB	61h	; 44:OUT (C),H
    3823/    11FA : 69                  	DB	69h	; 43:OUT (C),L
    3824/    11FB : 79                  	DB	79h	; 42:OUT (C),A
    3825/    11FC :                     
    3826/    11FC : 42                  	DB	42h	; 41:SBC HL,BC
    3827/    11FD : 52                  	DB	52h	; 40:SBC HL,DE
    3828/    11FE : 62                  	DB	62h	; 39:SBC HL,HL
    3829/    11FF : 72                  	DB	72h	; 38:SBC HL,SP
    3830/    1200 :                     
    3831/    1200 : 4A                  	DB	4Ah	; 37:ADC HL,BC
    3832/    1201 : 5A                  	DB	5Ah	; 36:ADC HL,DE
    3833/    1202 : 6A                  	DB	6Ah	; 35:ADC HL,HL
    3834/    1203 : 7A                  	DB	7Ah	; 34:ADC HL,SP
    3835/    1204 :                     
    3836/    1204 : 47                  	DB	47h	; 33:LD I,A
    3837/    1205 : 4F                  	DB	4Fh	; 32:LD R,A
    3838/    1206 : 57                  	DB	57h	; 31:LD A,I
    3839/    1207 : 5F                  	DB	5Fh	; 30:LD A,R
    3840/    1208 :                     
    3841/    1208 : 46                  	DB	46h	; 29:IM  0
    3842/    1209 : 56                  	DB	56h	; 28:IM  1
    3843/    120A : 5E                  	DB	5Eh	; 27:IM  2
    3844/    120B :                     
    3845/    120B : 44                  	DB	44h	; 26:NEG
    3846/    120C : 45                  	DB	45h	; 25:RETN
    3847/    120D : 4D                  	DB	4Dh	; 24:RETI
    3848/    120E : 67                  	DB	67h	; 23:RRD
    3849/    120F : 6F                  	DB	6Fh	; 22:RLD
    3850/    1210 : A0                  	DB	0A0h	; 21:LDI
    3851/    1211 : A1                  	DB	0A1h	; 20:CPI
    3852/    1212 : A2                  	DB	0A2h	; 19:INI
    3853/    1213 : A3                  	DB	0A3h	; 18:OUTI
    3854/    1214 : A8                  	DB	0A8h	; 17:LDD
    3855/    1215 : A9                  	DB	0A9h	; 16:CPD
    3856/    1216 : AA                  	DB	0AAh	; 15:IND
    3857/    1217 : AB                  	DB	0ABh	; 14:OUTD
    3858/    1218 : B0                  	DB	0B0h	; 13:LDIR
    3859/    1219 : B1                  	DB	0B1h	; 12:CPIR
    3860/    121A : B2                  	DB	0B2h	; 11:INIR
    3861/    121B : B3                  	DB	0B3h	; 10:OTIR
    3862/    121C : B8                  	DB	0B8h	; 09:LDDR
    3863/    121D : B9                  	DB	0B9h	; 08:CPDR
    3864/    121E : BA                  	DB	0BAh	; 07:INDR
    3865/    121F : BB                  	DB	0BBh	; 06:OTDR
    3866/    1220 :                     
    3867/    1220 : 43                  	DB	43h	; 05:LD (nnnn),BC
    3868/    1221 : 53                  	DB	53h	; 04:LD (nnnn),DE
    3869/    1222 : 73                  	DB	73h	; 03:LD (nnnn),SP
    3870/    1223 :                     
    3871/    1223 : 4B                  	DB	4Bh	; 02:LD BC,(nnnn)
    3872/    1224 : 5B                  	DB	5Bh	; 01:LD DE,(nnnn)
    3873/    1225 : 7B                  	DB	7Bh	; 00:LD SP,(nnnn)
    3874/    1226 :                     ed_op_tble:
    3875/    1226 :                     
    3876/    1226 : 41 46 00            RNAF:		DB	"AF",00H
    3877/    1229 : 41 46 27 00         RNAFX:		DB	"AF'",00H
    3878/    122D :                     
    3879/    122D : 52 45 54 00         RETstr:		db	"RET", 00h
    3880/    1231 : 4A 50 00            JPstr:		db	"JP", 00h
    3881/    1234 : 4A 52 00            JRstr:		db	"JR", 00h
    3882/    1237 : 44 4A 4E 5A 00      DJNZstr:	db	"DJNZ", 00h
    3883/    123C : 43 41 4C 4C 00      CALLstr:	db	"CALL", 00h
    3884/    1241 : 52 53 54 00         RSTstr:		db	"RST", 00h
    3885/    1245 : 4C 44 00            LDstr:		db	"LD", 00h
    3886/    1248 : 48 41 4C 54 00      HLTstr:		db	"HALT", 00h
    3887/    124D : 41 44 44 00         ADDstr:		db	"ADD", 00h
    3888/    1251 : 41 44 43 00         ADCstr:		db	"ADC", 00h
    3889/    1255 : 53 55 42 00         SUBstr:		db	"SUB", 00h
    3890/    1259 : 53 42 43 00         SBCstr:		db	"SBC", 00h
    3891/    125D : 41 4E 44 00         ANDstr:		db	"AND", 00h
    3892/    1261 : 58 4F 52 00         XORstr:		db	"XOR", 00h
    3893/    1265 : 4F 52 00            ORstr:		db	"OR", 00h
    3894/    1268 : 43 50 00            CPstr:		db	"CP", 00h
    3895/    126B : 49 4E 43 00         INCstr:		db	"INC", 00h
    3896/    126F : 44 45 43 00         DECstr:		db	"DEC", 00h
    3897/    1273 : 50 4F 50 00         POPstr:		db	"POP", 00h
    3898/    1277 : 50 55 53 48 00      PUSHstr:	db	"PUSH",00h
    3899/    127C : 45 58 00            EXstr:		db	"EX", 00h
    3900/    127F :                     
    3901/    127F : 45 58 58 00         EXXstr:		db	"EXX", 00h
    3902/    1283 : 4E 4F 50 00         NOPstr:		db	"NOP", 00h
    3903/    1287 : 52 4C 43 41 00      RLCAstr:	db	"RLCA", 00h
    3904/    128C : 52 52 43 41 00      RRCAstr:	db	"RRCA", 00h
    3905/    1291 : 52 4C 41 00         RLAstr:		db	"RLA", 00h
    3906/    1295 : 52 52 41 00         RRAstr:		db	"RRA", 00h
    3907/    1299 : 44 41 41 00         DAAstr:		db	"DAA", 00h
    3908/    129D : 43 50 4C 00         CPLstr:		db	"CPL", 00h
    3909/    12A1 : 53 43 46 00         SCFstr:		db	"SCF", 00h
    3910/    12A5 : 43 43 46 00         CCFstr:		db	"CCF", 00h
    3911/    12A9 : 44 49 00            DIstr:		db	"DI", 00h
    3912/    12AC : 45 49 00            EIstr:		db	"EI", 00h
    3913/    12AF :                     
    3914/    12AF : 4F 55 54 00         OUTstr:		db	"OUT", 00h
    3915/    12B3 : 49 4E 00            INstr:		db	"IN", 00h
    3916/    12B6 :                     
    3917/    12B6 : 52 4C 43 00         RLCstr		db	"RLC", 00h
    3918/    12BA : 52 52 43 00         RRCstr		db	"RRC", 00h
    3919/    12BE : 52 4C 00            RLstr		db	"RL", 00h
    3920/    12C1 : 52 52 00            RRstr		db	"RR", 00h
    3921/    12C4 : 53 4C 41 00         SLAstr		db	"SLA", 00h
    3922/    12C8 : 53 52 41 00         SRAstr		db	"SRA", 00h
    3923/    12CC : 53 52 4C 00         SRLstr		db	"SRL", 00h
    3924/    12D0 : 42 49 54 00         BITstr		db	"BIT", 00h
    3925/    12D4 : 52 45 53 00         RESstr		db	"RES", 00h
    3926/    12D8 : 4E 45 47 00         NEGstr		db	"NEG", 00h
    3927/    12DC : 49 4D 00            IMstr		db	"IM", 00h
    3928/    12DF : 52 52 44 00         RRDstr		db	"RRD", 00h
    3929/    12E3 : 52 4C 44 00         RLDstr		db	"RLD", 00h
    3930/    12E7 : 4C 44 49 00         LDIstr		db	"LDI", 00h
    3931/    12EB : 43 50 49 00         CPIstr		db	"CPI", 00h
    3932/    12EF : 49 4E 49 00         INIstr		db	"INI", 00h
    3933/    12F3 : 4F 55 54 49 00      OUTIstr		db	"OUTI", 00h
    3934/    12F8 : 4C 44 44 00         LDDstr		db	"LDD", 00h
    3935/    12FC : 43 50 44 00         CPDstr		db	"CPD", 00h
    3936/    1300 : 49 4E 44 00         INDstr		db	"IND", 00h
    3937/    1304 : 4F 55 54 44 00      OUTDstr		db	"OUTD", 00h
    3938/    1309 : 4C 44 49 52 00      LDIRstr		db	"LDIR", 00h
    3939/    130E : 43 50 49 52 00      CPIRstr		db	"CPIR", 00h
    3940/    1313 : 49 4E 49 52 00      INIRstr		db	"INIR", 00h
    3941/    1318 : 4F 54 49 52 00      OTIRstr		db	"OTIR", 00h
    3942/    131D : 4C 44 44 52 00      LDDRstr		db	"LDDR", 00h
    3943/    1322 : 43 50 44 52 00      CPDRstr		db	"CPDR", 00h
    3944/    1327 : 49 4E 44 52 00      INDRstr		db	"INDR", 00h
    3945/    132C : 4F 54 44 52 00      OTDRstr		db	"OTDR", 00h
    3946/    1331 : 52 45 54 49 00      RETIstr		db	"RETI", 00h
    3947/    1336 : 52 45 54 4E 00      RETNstr		db	"RETN", 00h
    3948/    133B :                     ;BITstr		db	"BIT", 00h
    3949/    133B :                     ;RESstr		db	"RES", 00h
    3950/    133B : 53 45 54 00         SETstr		db	"SET", 00h
    3951/    133F :                     com_errm:
    3952/    133F : 3F 3F 3F 00         ER_OPMSG:	db	"???", 00h
    3953/    1343 : 28 43 29 00         KCKstr		db	"(C)", 00h
    3954/    1347 :                     
    3955/    1347 : 28 48 4C 29 00      kRNHL:	db	"(HL)", 00h
    3956/    134C : 4E 5A 00            cc0:	db	"NZ", 00h
    3957/    134F : 5A 00               cc1:	db	"Z", 00h
    3958/    1351 : 4E 43 00            cc2:	db	"NC", 00h
    3959/    1354 : 43 00               cc3:	db	"C", 00h
    3960/    1356 : 50 4F 00            cc4:	db	"PO", 00h
    3961/    1359 : 50 45 00            cc5:	db	"PE", 00h
    3962/    135C : 50 00               cc6:	db	"P", 00h
    3963/    135E : 4D 00               cc7:	db	"M", 00h
    3964/    1360 :                     
    3965/    1360 : 8C 2E 8E 2E 93 2E   disRegTbl:	dw	RNB, RNC, RND, RNE, RNH, RNL, kRNHL, RNA
             1366 : 95 2E 9A 2E 9C 2E 
             136C : 47 13 87 2E       
    3966/    1370 : 5E 13 5C 13 59 13   CC_opr:		dw	cc7, cc6, cc5, cc4, cc3, cc2, cc1, cc0
             1376 : 56 13 54 13 51 13 
             137C : 4F 13 4C 13       
    3967/    1380 : 54 13 51 13 4F 13   JRCC_opr1:	dw	cc3, cc2, cc1, cc0
             1386 : 4C 13             
    3968/    1388 : CA 2E 97 2E 90 2E   INC_DEC_ADDrp:	dw	RNSP, RNHL, RNDE, RNBC
             138E : 89 2E             
    3969/    1390 : 26 12 97 2E 90 2E   POP_PUSHrp:	dw	RNAF, RNHL, RNDE, RNBC
             1396 : 89 2E             
    3970/    1398 :                     
    3971/    1398 : AC 12 A9 12 7F 12   oth_1op_tbl:	dw	EIstr, DIstr, EXXstr, RETstr, CCFstr
             139E : 2D 12 A5 12       
    3972/    13A2 : A1 12 9D 12 99 12   		dw	SCFstr, CPLstr, DAAstr, RRAstr
             13A8 : 95 12             
    3973/    13AA : 91 12 8C 12 87 12   		dw	RLAstr, RRCAstr, RLCAstr, NOPstr
             13B0 : 83 12             
    3974/    13B2 :                     
    3975/    13B2 : AF 12 B3 12 68 12   logop2str:	dw	OUTstr, INstr, CPstr, ORstr, XORstr
             13B8 : 65 12 61 12       
    3976/    13BC : 5D 12 55 12 59 12   		dw	ANDstr, SUBstr, SBCstr, ADCstr, ADDstr
             13C2 : 51 12 4D 12       
    3977/    13C6 :                     
    3978/    13C6 : CA 2E 97 2E 90 2E   logop3str	dw	RNSP, RNHL, RNDE, RNBC
             13CC : 89 2E             
    3979/    13CE : CA 2E 90 2E 89 2E   ed_rp_str	dw	RNSP, RNDE, RNBC, RNSP, RNDE, RNBC
             13D4 : CA 2E 90 2E 89 2E 
    3980/    13DA :                     
    3981/    13DA : 73 12 77 12 6F 12   dd_2opt:	dw	POPstr, PUSHstr, DECstr, INCstr
             13E0 : 6B 12             
    3982/    13E2 : CA 2E C4 2E 90 2E   addixrp_tbl:	dw	RNSP, RNIX, RNDE, RNBC
             13E8 : 89 2E             
    3983/    13EA : CA 2E C7 2E 90 2E   addiyrp_tbl:	dw	RNSP, RNIY, RNDE, RNBC
             13F0 : 89 2E             
    3984/    13F2 :                     
    3985/    13F2 : 6F 12 6B 12 68 12   ddlogtbl:	dw	DECstr, INCstr, CPstr, ORstr, XORstr, ANDstr, SUBstr
             13F8 : 65 12 61 12 5D 12 
             13FE : 55 12             
    3986/    1400 : 87 2E 9C 2E 9A 2E   dd_ldtbl:	dw	RNA, RNL, RNH, RNE, RND, RNC, RNB
             1406 : 95 2E 93 2E 8E 2E 
             140C : 8C 2E             
    3987/    140E :                     
    3988/    140E : 2C 13 27 13 22 13   ed_noopr:	dw	OTDRstr, INDRstr, CPDRstr, LDDRstr
             1414 : 1D 13             
    3989/    1416 : 18 13 13 13 0E 13   		dw	OTIRstr, INIRstr, CPIRstr, LDIRstr
             141C : 09 13             
    3990/    141E : 04 13 00 13 FC 12   		dw	OUTDstr, INDstr, CPDstr, LDDstr
             1424 : F8 12             
    3991/    1426 : F3 12 EF 12 EB 12   		dw	OUTIstr, INIstr, CPIstr, LDIstr
             142C : E7 12             
    3992/    142E : E3 12 DF 12 31 13   		dw	RLDstr, RRDstr, RETIstr, RETNstr
             1434 : 36 13             
    3993/    1436 : D8 12               		dw	NEGstr
    3994/    1438 :                     
    3995/    1438 : CC 12 C8 12 C4 12   dd_rt_str:	dw	SRLstr, SRAstr, SLAstr, RRstr
             143E : C1 12             
    3996/    1440 : BE 12 BA 12 B6 12   		dw	RLstr, RRCstr, RLCstr
    3997/    1446 :                     	
    3998/    1446 :                     ;;;
    3999/    1446 :                     ;;; GO address
    4000/    1446 :                     ;;; 
    4001/    1446 :                     
    4002/    1446 :                     GO:
    4003/    1446 : ED 5B 32 EF         	ld	de, (REGPC)
    4004/    144A : ED 53 47 EF         	ld	(goTmp), de	; save go tmp go address
    4005/    144E : 23                  	INC	HL
    4006/    144F : CD EC 26            	CALL	SKIPSP
    4007/    1452 : CD FC 26            	CALL	RDHEX
    4008/    1455 : 30 03               	jr	nc, gostmp
    4009/    1457 : B7                  	OR	A
    4010/    1458 : 28 0A               	JR	Z, g_stpadr
    4011/    145A :                     gostmp:
    4012/    145A : 7A                  	ld	a, d
    4013/    145B :                     
    4014/    145B : =>TRUE              	IF	SuperMEZ80 = 0
    4015/    145B : FE F0               	cp	IO_B >> 8	; a - 0F0H
    4016/    145D : D2 75 01            	jp	nc, ERR		; detect I/O area
    4017/    1460 : [4014]              	ENDIF
    4018/    1460 :                     
    4019/    1460 : ED 53 47 EF         	LD	(goTmp),DE	; save going address
    4020/    1464 :                     g_stpadr:
    4021/    1464 : CD EC 26            	CALL	SKIPSP
    4022/    1467 : 7E                  	LD	A,(HL)
    4023/    1468 : B7                  	or	a
    4024/    1469 : 28 18               	jr	z, GO1
    4025/    146B : FE 2C               	cp	','
    4026/    146D : C2 75 01            	jp	nz, ERR
    4027/    1470 :                     
    4028/    1470 :                     ; set break point with go command
    4029/    1470 :                     
    4030/    1470 : 23                  	INC	HL
    4031/    1471 : CD EC 26            	CALL	SKIPSP
    4032/    1474 : CD FC 26            	CALL	RDHEX		; 1st arg.
    4033/    1477 : DA 75 01            	jp	c, ERR
    4034/    147A :                     
    4035/    147A : 21 60 EF            	ld	hl, tmpb_f	; hl: temp break point buffer
    4036/    147D : CD 5E 03            	call	setbpadr
    4037/    1480 : DA 75 01            	jp	c, ERR		; address is incorrect
    4038/    1483 :                     
    4039/    1483 :                     GO1:
    4040/    1483 : 2A 47 EF            	LD	hl, (goTmp)
    4041/    1486 : 22 32 EF            	ld	(REGPC), hl	; set go address
    4042/    1489 :                     
    4043/    1489 :                     G0:
    4044/    1489 :                     ; check Trace mode
    4045/    1489 :                     
    4046/    1489 : 3A 50 EF            	ld	a, (tpt1_f)
    4047/    148C : B7                  	or	a
    4048/    148D : 28 1A               	jr	z, donot_trace
    4049/    148F :                     	
    4050/    148F : 2A 4D EF            	ld	hl,(tmpT)
    4051/    1492 : 22 32 EF            	ld	(REGPC), hl	; set trace address
    4052/    1495 :                     
    4053/    1495 : 21 50 EF            	ld	hl, tpt1_f
    4054/    1498 : 11 52 EF            	ld	de, tpt1_adr
    4055/    149B : CD 01 15            	call	set_bp
    4056/    149E : 21 54 EF            	ld	hl, tpt2_f
    4057/    14A1 : 11 56 EF            	ld	de, tpt2_adr
    4058/    14A4 : CD 01 15            	call	set_bp
    4059/    14A7 : 18 1B               	jr	skp_tbp		; skip set tmp bp and bp, if tracing
    4060/    14A9 :                     
    4061/    14A9 :                     ; set break point
    4062/    14A9 :                     donot_trace:
    4063/    14A9 : 21 58 EF            	ld	hl, bpt1_f
    4064/    14AC : 11 5A EF            	ld	de, bpt1_adr
    4065/    14AF : CD 01 15            	call	set_bp
    4066/    14B2 : 21 5C EF            	ld	hl, bpt2_f
    4067/    14B5 : 11 5E EF            	ld	de, bpt2_adr
    4068/    14B8 : CD 01 15            	call	set_bp
    4069/    14BB :                     
    4070/    14BB :                     
    4071/    14BB :                     ; check go, break pointer
    4072/    14BB :                     
    4073/    14BB : 21 60 EF            	ld	hl, tmpb_f
    4074/    14BE : 11 62 EF            	ld	de, tmpb_adr
    4075/    14C1 : CD 01 15            	call	set_bp
    4076/    14C4 :                     
    4077/    14C4 :                     	;; R register adjustment
    4078/    14C4 :                     
    4079/    14C4 :                     skp_tbp:
    4080/    14C4 : 2A 30 EF            	LD	HL,(REGSP)
    4081/    14C7 : F9                  	LD	SP,HL
    4082/    14C8 : 2A 32 EF            	LD	HL,(REGPC)
    4083/    14CB : E5                  	PUSH	HL
    4084/    14CC : DD 2A 2C EF         	LD	IX,(REGIX)
    4085/    14D0 : FD 2A 2E EF         	LD	IY,(REGIY)
    4086/    14D4 : 2A 24 EF            	LD	HL,(REGAFX)
    4087/    14D7 : E5                  	PUSH	HL
    4088/    14D8 : ED 4B 26 EF         	LD	BC,(REGBCX)
    4089/    14DC : ED 5B 28 EF         	LD	DE,(REGDEX)
    4090/    14E0 : 2A 2A EF            	LD	HL,(REGHLX)
    4091/    14E3 : D9                  	EXX
    4092/    14E4 : F1                  	POP	AF
    4093/    14E5 : 08                  	EX	AF,AF'		;'
    4094/    14E6 : 2A 1C EF            	LD	HL,(REGAF)
    4095/    14E9 : E5                  	PUSH	HL
    4096/    14EA : ED 4B 1E EF         	LD	BC,(REGBC)
    4097/    14EE : ED 5B 20 EF         	LD	DE,(REGDE)
    4098/    14F2 : 2A 22 EF            	LD	HL,(REGHL)
    4099/    14F5 : 3A 34 EF            	LD	A,(REGI)
    4100/    14F8 : ED 47               	LD	I,A
    4101/    14FA : 3A 35 EF            	LD	A,(REGR)
    4102/    14FD : ED 4F               	LD	R,A
    4103/    14FF : F1                  	POP	AF
    4104/    1500 : C9                  	RET			; POP PC
    4105/    1501 :                     
    4106/    1501 :                     set_bp:
    4107/    1501 : 7E                  	ld	a, (hl)
    4108/    1502 : B7                  	or	a
    4109/    1503 : C8                  	ret	z
    4110/    1504 :                     
    4111/    1504 : 1A                  	ld	a, (de)
    4112/    1505 : 4F                  	ld	c, a
    4113/    1506 : 13                  	inc	de
    4114/    1507 : 1A                  	ld	a, (de)
    4115/    1508 : 47                  	ld	b, a	; bc = break point address
    4116/    1509 :                     
    4117/    1509 : 3E FF               	ld	a, 0FFH
    4118/    150B : 02                  	ld	(bc), a	; insert RST 38H code
    4119/    150C : C9                  	ret
    4120/    150D :                     	
    4121/    150D :                     ;;;
    4122/    150D :                     ;;; SET memory
    4123/    150D :                     ;;; 
    4124/    150D :                     
    4125/    150D :                     SETM:
    4126/    150D : 23                  	INC	HL
    4127/    150E : CD EC 26            	CALL	SKIPSP
    4128/    1511 : CD FC 26            	CALL	RDHEX
    4129/    1514 :                     
    4130/    1514 : DA 75 01            	jp	c, ERR
    4131/    1517 :                     
    4132/    1517 : CD EC 26            	CALL	SKIPSP
    4133/    151A : 7E                  	LD	A,(HL)
    4134/    151B : B7                  	OR	A
    4135/    151C : C2 75 01            	JP	NZ,ERR
    4136/    151F : 79                  	LD	A,C
    4137/    1520 : B7                  	OR	A
    4138/    1521 : 20 04               	JR	NZ,SM0
    4139/    1523 : ED 5B 17 EF         	LD	DE,(SADDR)
    4140/    1527 :                     
    4141/    1527 :                     
    4142/    1527 :                     SM0:
    4143/    1527 : EB                  	EX	DE,HL
    4144/    1528 :                     SM1:
    4145/    1528 : CD 0B 26            	CALL	HEXOUT4
    4146/    152B : E5                  	PUSH	HL
    4147/    152C : 21 A6 2C            	LD	HL,dsap
    4148/    152F : CD 02 26            	CALL	STROUT
    4149/    1532 : E1                  	POP	HL
    4150/    1533 : 7E                  	LD	A,(HL)
    4151/    1534 : E5                  	PUSH	HL
    4152/    1535 : CD 10 26            	CALL	HEXOUT2
    4153/    1538 : 3E 20               	LD	A,' '
    4154/    153A : CD E5 2E            	CALL	CONOUT
    4155/    153D : CD 62 26            	CALL	GETLIN
    4156/    1540 : CD EC 26            	CALL	SKIPSP
    4157/    1543 : 7E                  	LD	A,(HL)
    4158/    1544 : B7                  	OR	A
    4159/    1545 : 20 07               	JR	NZ,SM2
    4160/    1547 :                     	;; Empty  (Increment address)
    4161/    1547 : E1                  	POP	HL
    4162/    1548 : 23                  	INC	HL
    4163/    1549 : 22 17 EF            	LD	(SADDR),HL
    4164/    154C : 18 DA               	JR	SM1
    4165/    154E :                     SM2:
    4166/    154E : FE 2D               	CP	'-'
    4167/    1550 : 20 07               	JR	NZ,SM3
    4168/    1552 :                     	;; '-'  (Decrement address)
    4169/    1552 : E1                  	POP	HL
    4170/    1553 : 2B                  	DEC	HL
    4171/    1554 : 22 17 EF            	LD	(SADDR),HL
    4172/    1557 : 18 CF               	JR	SM1
    4173/    1559 :                     SM3:
    4174/    1559 : FE 2E               	CP	'.'
    4175/    155B : 20 07               	JR	NZ,SM4
    4176/    155D : E1                  	POP	HL
    4177/    155E : 22 17 EF            	LD	(SADDR),HL
    4178/    1561 : C3 2C 01            	JP	WSTART
    4179/    1564 :                     SM4:
    4180/    1564 : CD FC 26            	CALL	RDHEX
    4181/    1567 : B7                  	OR	A
    4182/    1568 : E1                  	POP	HL
    4183/    1569 : CA 75 01            	JP	Z,ERR
    4184/    156C : 73                  	LD	(HL),E
    4185/    156D : 23                  	INC	HL
    4186/    156E : 22 17 EF            	LD	(SADDR),HL	; set value
    4187/    1571 :                     
    4188/    1571 :                     	; resave opcode for BP command
    4189/    1571 : ED 5B 5A EF         	ld	de, (bpt1_adr)
    4190/    1575 : 1A                  	ld	a, (de)
    4191/    1576 : 32 59 EF            	ld	(bpt1_op), a
    4192/    1579 : ED 5B 5E EF         	ld	de, (bpt2_adr)
    4193/    157D : 1A                  	ld	a, (de)
    4194/    157E : 32 5D EF            	ld	(bpt2_op), a
    4195/    1581 :                     
    4196/    1581 : 18 A5               	JR	SM1
    4197/    1583 :                     
    4198/    1583 :                     ;;;
    4199/    1583 :                     ;;; LOAD HEX file
    4200/    1583 :                     ;;;
    4201/    1583 :                     
    4202/    1583 :                     LOADH:
    4203/    1583 :                     	; clear brk point
    4204/    1583 : AF                  	xor	a
    4205/    1584 : 4F                  	ld	c, a
    4206/    1585 : 32 58 EF            	ld	(bpt1_f), a
    4207/    1588 : 32 5C EF            	ld	(bpt2_f), a
    4208/    158B : 32 36 EF            	ld	(l_jpflg), a
    4209/    158E :                     	
    4210/    158E : 23                  	INC	HL
    4211/    158F : CD EC 26            	CALL	SKIPSP
    4212/    1592 : FE 47               	cp	'G'
    4213/    1594 : 20 06               	jr	nz, lh00
    4214/    1596 : 32 36 EF            	ld	(l_jpflg), a
    4215/    1599 : 23                  	inc	hl
    4216/    159A : 18 03               	jr	lh000
    4217/    159C :                     lh00:
    4218/    159C : CD FC 26            	CALL	RDHEX
    4219/    159F :                     lh000:
    4220/    159F : CD EC 26            	CALL	SKIPSP
    4221/    15A2 : B7                  	OR	A
    4222/    15A3 : C2 75 01            	JP	NZ,ERR
    4223/    15A6 :                     
    4224/    15A6 : 79                  	LD	A,C
    4225/    15A7 : B7                  	OR	A
    4226/    15A8 : 20 03               	JR	NZ,LH0
    4227/    15AA :                     
    4228/    15AA : 11 00 00            	LD	DE,0		;Offset
    4229/    15AD :                     LH0:
    4230/    15AD : 3E 2E               	ld	a, '.'
    4231/    15AF : CD E5 2E            	call	CONOUT
    4232/    15B2 :                     
    4233/    15B2 : CD D4 2E            	CALL	CONIN
    4234/    15B5 : FE 53               	CP	'S'
    4235/    15B7 : 28 78               	JR	Z,LHS0
    4236/    15B9 :                     LH1:
    4237/    15B9 : FE 3A               	CP	':'
    4238/    15BB : 28 0D               	JR	Z,LHI0
    4239/    15BD :                     LH2:
    4240/    15BD :                     	;; Skip to EOL
    4241/    15BD : FE 0D               	CP	CR
    4242/    15BF : 28 EC               	JR	Z,LH0
    4243/    15C1 : FE 0A               	CP	LF
    4244/    15C3 : 28 E8               	JR	Z,LH0
    4245/    15C5 :                     LH3:
    4246/    15C5 : CD D4 2E            	CALL	CONIN
    4247/    15C8 : 18 F3               	JR	LH2
    4248/    15CA :                     
    4249/    15CA :                     LHI0:
    4250/    15CA : CD 27 26            	CALL	HEXIN
    4251/    15CD : 4F                  	LD	C,A		; Checksum
    4252/    15CE : 47                  	LD	B,A		; Length
    4253/    15CF :                     
    4254/    15CF : CD 27 26            	CALL	HEXIN
    4255/    15D2 : 67                  	LD	H,A		; Address H
    4256/    15D3 : 81                  	ADD	A,C
    4257/    15D4 : 4F                  	LD	C,A
    4258/    15D5 :                     
    4259/    15D5 : CD 27 26            	CALL	HEXIN
    4260/    15D8 : 6F                  	LD	L,A		; Address L
    4261/    15D9 : 81                  	ADD	A,C
    4262/    15DA : 4F                  	LD	C,A
    4263/    15DB :                     
    4264/    15DB :                     	;; Add offset
    4265/    15DB : 19                  	ADD	HL,DE
    4266/    15DC : CD 22 16            	call	sv_1staddr
    4267/    15DF :                     
    4268/    15DF : CD 27 26            	CALL	HEXIN
    4269/    15E2 : 32 1A EF            	LD	(RECTYP),A
    4270/    15E5 : 81                  	ADD	A,C
    4271/    15E6 : 4F                  	LD	C,A		; Checksum
    4272/    15E7 :                     
    4273/    15E7 : 78                  	LD	A,B
    4274/    15E8 : B7                  	OR	A
    4275/    15E9 : 28 14               	JR	Z,LHI3
    4276/    15EB :                     LHI1:
    4277/    15EB : CD 27 26            	CALL	HEXIN
    4278/    15EE : F5                  	PUSH	AF
    4279/    15EF : 81                  	ADD	A,C
    4280/    15F0 : 4F                  	LD	C,A		; Checksum
    4281/    15F1 :                     
    4282/    15F1 : 3A 1A EF            	LD	A,(RECTYP)
    4283/    15F4 : B7                  	OR	A
    4284/    15F5 : 20 05               	JR	NZ,LHI20
    4285/    15F7 :                     
    4286/    15F7 : F1                  	POP	AF
    4287/    15F8 : 77                  	LD	(HL),A
    4288/    15F9 : 23                  	INC	HL
    4289/    15FA : 18 01               	JR	LHI2
    4290/    15FC :                     LHI20:
    4291/    15FC : F1                  	POP	AF
    4292/    15FD :                     LHI2:
    4293/    15FD : 10 EC               	DJNZ	LHI1
    4294/    15FF :                     LHI3:
    4295/    15FF : CD 27 26            	CALL	HEXIN
    4296/    1602 : 81                  	ADD	A,C
    4297/    1603 : 20 14               	JR	NZ,LHIE		; Checksum error
    4298/    1605 : 3A 1A EF            	LD	A,(RECTYP)
    4299/    1608 : B7                  	OR	A
    4300/    1609 : CA C5 15            	JP	Z,LH3
    4301/    160C :                     
    4302/    160C :                     lg_jump:
    4303/    160C : CD 4B 26            	call	CRLF
    4304/    160F : 3A 36 EF            	ld	a, (l_jpflg)
    4305/    1612 : B7                  	or	a
    4306/    1613 : 28 0A               	jr	z, l_end
    4307/    1615 : 2A 37 EF            	ld	hl, (ld_jmp)
    4308/    1618 : E9                  	jp	(hl)		; Jump to load address
    4309/    1619 :                     
    4310/    1619 :                     LHIE:
    4311/    1619 : 21 7D 2C            	LD	HL,IHEMSG
    4312/    161C :                     LHSR:
    4313/    161C : CD 02 26            	CALL	STROUT
    4314/    161F :                     l_end:
    4315/    161F : C3 2C 01            	JP	WSTART
    4316/    1622 :                     	
    4317/    1622 :                     
    4318/    1622 :                     sv_1staddr:
    4319/    1622 : 3A 36 EF            	ld	a, (l_jpflg)
    4320/    1625 : FE 47               	cp	'G'
    4321/    1627 : C0                  	ret	nz
    4322/    1628 : 22 37 EF            	ld	(ld_jmp), hl
    4323/    162B : 3E 01               	ld	a, 1
    4324/    162D : 32 36 EF            	ld	(l_jpflg), a
    4325/    1630 : C9                  	ret
    4326/    1631 :                     
    4327/    1631 :                     LHS0:
    4328/    1631 : CD D4 2E            	CALL	CONIN
    4329/    1634 : 32 1A EF            	LD	(RECTYP),A
    4330/    1637 :                     
    4331/    1637 : CD 27 26            	CALL	HEXIN
    4332/    163A : 47                  	LD	B,A		; Length+3
    4333/    163B : 4F                  	LD	C,A		; Checksum
    4334/    163C :                     
    4335/    163C : CD 27 26            	CALL	HEXIN
    4336/    163F : 67                  	LD	H,A
    4337/    1640 : 81                  	ADD	A,C
    4338/    1641 : 4F                  	LD	C,A
    4339/    1642 :                     	
    4340/    1642 : CD 27 26            	CALL	HEXIN
    4341/    1645 : 6F                  	LD	L,A
    4342/    1646 : 81                  	ADD	A,C
    4343/    1647 : 4F                  	LD	C,A
    4344/    1648 :                     
    4345/    1648 : 19                  	ADD	HL,DE
    4346/    1649 : CD 22 16            	call	sv_1staddr
    4347/    164C :                     
    4348/    164C : 05                  	DEC	B
    4349/    164D : 05                  	DEC	B
    4350/    164E : 05                  	DEC	B
    4351/    164F : 28 15               	JR	Z,LHS3
    4352/    1651 :                     LHS1:
    4353/    1651 : CD 27 26            	CALL	HEXIN
    4354/    1654 : F5                  	PUSH	AF
    4355/    1655 : 81                  	ADD	A,C
    4356/    1656 : 4F                  	LD	C,A		; Checksum
    4357/    1657 :                     
    4358/    1657 : 3A 1A EF            	LD	A,(RECTYP)
    4359/    165A : FE 31               	CP	'1'
    4360/    165C : 20 05               	JR	NZ,LHS2
    4361/    165E :                     
    4362/    165E : F1                  	POP	AF
    4363/    165F : 77                  	LD	(HL),A
    4364/    1660 : 23                  	INC	HL
    4365/    1661 : 18 01               	JR	LHS20
    4366/    1663 :                     LHS2:
    4367/    1663 : F1                  	POP	AF
    4368/    1664 :                     LHS20:
    4369/    1664 : 10 EB               	DJNZ	LHS1
    4370/    1666 :                     LHS3:
    4371/    1666 : CD 27 26            	CALL	HEXIN
    4372/    1669 : 81                  	ADD	A,C
    4373/    166A : FE FF               	CP	0FFH
    4374/    166C : 20 12               	JR	NZ,LHSE
    4375/    166E :                     
    4376/    166E : 3A 1A EF            	LD	A,(RECTYP)
    4377/    1671 : FE 37               	CP	'7'
    4378/    1673 : 28 AA               	JR	Z,l_end
    4379/    1675 : FE 38               	CP	'8'
    4380/    1677 : 28 A6               	JR	Z,l_end
    4381/    1679 : FE 39               	CP	'9'
    4382/    167B : 28 8F               	JR	Z, lg_jump
    4383/    167D : C3 C5 15            	JP	LH3
    4384/    1680 :                     LHSE:
    4385/    1680 : 21 8A 2C            	LD	HL,SHEMSG
    4386/    1683 : 18 97               	jr	LHSR
    4387/    1685 :                     ;;;
    4388/    1685 :                     ;;; SAVE HEX file
    4389/    1685 :                     ;;;
    4390/    1685 :                     
    4391/    1685 :                     SAVEH:
    4392/    1685 : 23                  	INC	HL
    4393/    1686 : 7E                  	LD	A,(HL)
    4394/    1687 : FE 49               	CP	'I'
    4395/    1689 : 28 04               	JR	Z,SH0
    4396/    168B : FE 53               	CP	'S'
    4397/    168D : 20 04               	JR	NZ,SH1
    4398/    168F :                     SH0:
    4399/    168F : 23                  	INC	HL
    4400/    1690 : 32 19 EF            	LD	(HEXMOD),A
    4401/    1693 :                     SH1:
    4402/    1693 : CD EC 26            	CALL	SKIPSP
    4403/    1696 : CD FC 26            	CALL	RDHEX
    4404/    1699 : B7                  	OR	A
    4405/    169A : 28 1C               	JR	Z,SHE
    4406/    169C : D5                  	PUSH	DE
    4407/    169D : DD E1               	POP	IX		; IX = Start address
    4408/    169F : CD EC 26            	CALL	SKIPSP
    4409/    16A2 : 7E                  	LD	A,(HL)
    4410/    16A3 : FE 2C               	CP	','
    4411/    16A5 : 20 11               	JR	NZ,SHE
    4412/    16A7 : 23                  	INC	HL
    4413/    16A8 : CD EC 26            	CALL	SKIPSP
    4414/    16AB : CD FC 26            	CALL	RDHEX		; DE = End address
    4415/    16AE : B7                  	OR	A
    4416/    16AF : 28 07               	JR	Z,SHE
    4417/    16B1 : CD EC 26            	CALL	SKIPSP
    4418/    16B4 : 7E                  	LD	A,(HL)
    4419/    16B5 : B7                  	OR	A
    4420/    16B6 : 28 03               	JR	Z,SH2
    4421/    16B8 :                     SHE:
    4422/    16B8 : C3 75 01            	JP	ERR
    4423/    16BB :                     
    4424/    16BB :                     SH2:
    4425/    16BB : DD E5               	PUSH	IX
    4426/    16BD : E1                  	POP	HL
    4427/    16BE : EB                  	EX	DE,HL
    4428/    16BF : 23                  	INC	HL
    4429/    16C0 : B7                  	OR	A
    4430/    16C1 : ED 52               	SBC	HL,DE		; HL = Length
    4431/    16C3 :                     SH3:
    4432/    16C3 : CD E3 16            	CALL	SHL00
    4433/    16C6 : 7C                  	LD	A,H
    4434/    16C7 : B5                  	OR	L
    4435/    16C8 : 20 F9               	JR	NZ,SH3
    4436/    16CA :                     
    4437/    16CA : 3A 19 EF            	LD	A,(HEXMOD)
    4438/    16CD : FE 49               	CP	'I'
    4439/    16CF : 20 09               	JR	NZ,SH4
    4440/    16D1 :                     	;; End record for Intel HEX
    4441/    16D1 : 21 A9 2C            	LD	HL,IHEXER
    4442/    16D4 : CD 02 26            	CALL	STROUT
    4443/    16D7 : C3 2C 01            	JP	WSTART
    4444/    16DA :                     SH4:
    4445/    16DA :                     	;; End record for Motorola S record
    4446/    16DA : 21 B7 2C            	LD	HL,SRECER
    4447/    16DD : CD 02 26            	CALL	STROUT
    4448/    16E0 : C3 2C 01            	JP	WSTART
    4449/    16E3 :                     
    4450/    16E3 :                     SHL00:
    4451/    16E3 : 0E 10               	LD	C,16
    4452/    16E5 : 7C                  	LD	A,H
    4453/    16E6 : B7                  	OR	A
    4454/    16E7 : 20 05               	JR	NZ,SHL0
    4455/    16E9 : 7D                  	LD	A,L
    4456/    16EA : B9                  	CP	C
    4457/    16EB : 30 01               	JR	NC,SHL0
    4458/    16ED : 4F                  	LD	C,A
    4459/    16EE :                     SHL0:
    4460/    16EE : 06 00               	LD	B,0
    4461/    16F0 : B7                  	OR	A
    4462/    16F1 : ED 42               	SBC	HL,BC
    4463/    16F3 : 41                  	LD	B,C
    4464/    16F4 :                     
    4465/    16F4 : 3A 19 EF            	LD	A,(HEXMOD)
    4466/    16F7 : FE 49               	CP	'I'
    4467/    16F9 : 20 30               	JR	NZ,SHLS
    4468/    16FB :                     
    4469/    16FB :                     	;; Intel HEX
    4470/    16FB : 3E 3A               	LD	A,':'
    4471/    16FD : CD E5 2E            	CALL	CONOUT
    4472/    1700 :                     
    4473/    1700 : 78                  	LD	A,B
    4474/    1701 : CD 10 26            	CALL	HEXOUT2		; Length
    4475/    1704 : 48                  	LD	C,B		; Checksum
    4476/    1705 :                     
    4477/    1705 : 7A                  	LD	A,D
    4478/    1706 : CD 10 26            	CALL	HEXOUT2
    4479/    1709 : 7A                  	LD	A,D
    4480/    170A : 81                  	ADD	A,C
    4481/    170B : 4F                  	LD	C,A
    4482/    170C :                     	
    4483/    170C : 7B                  	LD	A,E
    4484/    170D : CD 10 26            	CALL	HEXOUT2
    4485/    1710 : 7B                  	LD	A,E
    4486/    1711 : 81                  	ADD	A,C
    4487/    1712 : 4F                  	LD	C,A
    4488/    1713 :                     	
    4489/    1713 : AF                  	XOR	A
    4490/    1714 : CD 10 26            	CALL	HEXOUT2
    4491/    1717 :                     SHLI0:
    4492/    1717 : 1A                  	LD	A,(DE)
    4493/    1718 : F5                  	PUSH	AF
    4494/    1719 : CD 10 26            	CALL	HEXOUT2
    4495/    171C : F1                  	POP	AF
    4496/    171D : 81                  	ADD	A,C
    4497/    171E : 4F                  	LD	C,A
    4498/    171F :                     
    4499/    171F : 13                  	INC	DE
    4500/    1720 : 10 F5               	DJNZ	SHLI0
    4501/    1722 :                     
    4502/    1722 : 79                  	LD	A,C
    4503/    1723 : ED 44               	NEG
    4504/    1725 : CD 10 26            	CALL	HEXOUT2
    4505/    1728 : C3 4B 26            	JP	CRLF
    4506/    172B :                     
    4507/    172B :                     SHLS:
    4508/    172B :                     	;; Motorola S record
    4509/    172B : 3E 53               	LD	A,'S'
    4510/    172D : CD E5 2E            	CALL	CONOUT
    4511/    1730 : 3E 31               	LD	A,'1'
    4512/    1732 : CD E5 2E            	CALL	CONOUT
    4513/    1735 :                     
    4514/    1735 : 78                  	LD	A,B
    4515/    1736 : C6 03               	ADD	A,2+1		; DataLength + 2(Addr) + 1(Sum)
    4516/    1738 : 4F                  	LD	C,A
    4517/    1739 : CD 10 26            	CALL	HEXOUT2
    4518/    173C :                     
    4519/    173C : 7A                  	LD	A,D
    4520/    173D : CD 10 26            	CALL	HEXOUT2
    4521/    1740 : 7A                  	LD	A,D
    4522/    1741 : 81                  	ADD	A,C
    4523/    1742 : 4F                  	LD	C,A
    4524/    1743 :                     	
    4525/    1743 : 7B                  	LD	A,E
    4526/    1744 : CD 10 26            	CALL	HEXOUT2
    4527/    1747 : 7B                  	LD	A,E
    4528/    1748 : 81                  	ADD	A,C
    4529/    1749 : 4F                  	LD	C,A
    4530/    174A :                     SHLS0:
    4531/    174A : 1A                  	LD	A,(DE)
    4532/    174B : F5                  	PUSH	AF
    4533/    174C : CD 10 26            	CALL	HEXOUT2		; Data
    4534/    174F : F1                  	POP	AF
    4535/    1750 : 81                  	ADD	A,C
    4536/    1751 : 4F                  	LD	C,A
    4537/    1752 :                     
    4538/    1752 : 13                  	INC	DE
    4539/    1753 : 10 F5               	DJNZ	SHLS0
    4540/    1755 :                     
    4541/    1755 : 79                  	LD	A,C
    4542/    1756 : 2F                  	CPL
    4543/    1757 : CD 10 26            	CALL	HEXOUT2
    4544/    175A : C3 4B 26            	JP	CRLF
    4545/    175D :                     
    4546/    175D :                     ;;;
    4547/    175D :                     ;;; Register
    4548/    175D :                     ;;;
    4549/    175D :                     
    4550/    175D :                     REG:
    4551/    175D : 23                  	INC	HL
    4552/    175E : CD EC 26            	CALL	SKIPSP
    4553/    1761 : B7                  	OR	A
    4554/    1762 : 20 06               	JR	NZ,RG0
    4555/    1764 : CD E3 17            	CALL	RDUMP
    4556/    1767 : C3 2C 01            	JP	WSTART
    4557/    176A :                     RG0:
    4558/    176A : EB                  	EX	DE,HL
    4559/    176B : 21 6D 2D            	LD	HL,RNTAB
    4560/    176E :                     RG1:
    4561/    176E : BE                  	CP	(HL)
    4562/    176F : 28 0D               	JR	Z,RG2		; Character match
    4563/    1771 : 4F                  	LD	C,A
    4564/    1772 : 23                  	INC	HL
    4565/    1773 : 7E                  	LD	A,(HL)
    4566/    1774 : B7                  	OR	A
    4567/    1775 : 28 69               	JR	Z,RGE		; Found end mark
    4568/    1777 : 79                  	LD	A,C
    4569/    1778 : 01 05 00            	LD	BC,5
    4570/    177B : 09                  	ADD	HL,BC		; Next entry
    4571/    177C : 18 F0               	JR	RG1
    4572/    177E :                     RG2:
    4573/    177E : 23                  	INC	HL
    4574/    177F : 7E                  	LD	A,(HL)
    4575/    1780 : FE 0F               	CP	0FH		; Link code
    4576/    1782 : 20 09               	JR	NZ,RG3
    4577/    1784 :                     	;; Next table
    4578/    1784 : 23                  	INC	HL
    4579/    1785 : 4E                  	LD	C,(HL)
    4580/    1786 : 23                  	INC	HL
    4581/    1787 : 66                  	LD	H,(HL)
    4582/    1788 : 69                  	LD	L,C
    4583/    1789 : 13                  	INC	DE
    4584/    178A : 1A                  	LD	A,(DE)
    4585/    178B : 18 E1               	JR	RG1
    4586/    178D :                     RG3:
    4587/    178D : B7                  	OR	A
    4588/    178E : 28 50               	JR	Z,RGE		; Found end mark
    4589/    1790 :                     
    4590/    1790 : 4E                  	LD	C,(HL)		; LD C,A???
    4591/    1791 : 23                  	INC	HL
    4592/    1792 : 5E                  	LD	E,(HL)
    4593/    1793 : 23                  	INC	HL
    4594/    1794 : 56                  	LD	D,(HL)
    4595/    1795 : D5                  	PUSH	DE		; Reg storage address
    4596/    1796 : 23                  	INC	HL
    4597/    1797 : 7E                  	LD	A,(HL)
    4598/    1798 : 23                  	INC	HL
    4599/    1799 : 66                  	LD	H,(HL)
    4600/    179A : 6F                  	LD	L,A		; HL: Reg name
    4601/    179B : CD 02 26            	CALL	STROUT
    4602/    179E : 3E 3D               	LD	A,'='
    4603/    17A0 : CD E5 2E            	CALL	CONOUT
    4604/    17A3 :                     
    4605/    17A3 : 79                  	LD	A,C
    4606/    17A4 : E6 07               	AND	07H
    4607/    17A6 : FE 01               	CP	1
    4608/    17A8 : 20 08               	JR	NZ,RG4
    4609/    17AA :                     	;; 8 bit register
    4610/    17AA : E1                  	POP	HL
    4611/    17AB : 7E                  	LD	A,(HL)
    4612/    17AC : E5                  	PUSH	HL
    4613/    17AD : CD 10 26            	CALL	HEXOUT2
    4614/    17B0 : 18 0C               	JR	RG5
    4615/    17B2 :                     RG4:
    4616/    17B2 :                     	;; 16 bit register
    4617/    17B2 : E1                  	POP	HL
    4618/    17B3 : E5                  	PUSH	HL
    4619/    17B4 : 23                  	INC	HL
    4620/    17B5 : 7E                  	LD	A,(HL)
    4621/    17B6 : CD 10 26            	CALL	HEXOUT2
    4622/    17B9 : 2B                  	DEC	HL
    4623/    17BA : 7E                  	LD	A,(HL)
    4624/    17BB : CD 10 26            	CALL	HEXOUT2
    4625/    17BE :                     RG5:
    4626/    17BE : 3E 20               	LD	A,' '
    4627/    17C0 : CD E5 2E            	CALL	CONOUT
    4628/    17C3 : C5                  	PUSH	BC		; C: reg size
    4629/    17C4 : CD 62 26            	CALL	GETLIN
    4630/    17C7 : CD EC 26            	CALL	SKIPSP
    4631/    17CA : CD FC 26            	CALL	RDHEX
    4632/    17CD : B7                  	OR	A
    4633/    17CE : 28 0D               	JR	Z,RGR
    4634/    17D0 : C1                  	POP	BC
    4635/    17D1 : E1                  	POP	HL
    4636/    17D2 : 79                  	LD	A,C
    4637/    17D3 : FE 01               	CP	1
    4638/    17D5 : 20 03               	JR	NZ,RG6
    4639/    17D7 :                     	;; 8 bit register
    4640/    17D7 : 73                  	LD	(HL),E
    4641/    17D8 : 18 03               	JR	RG7
    4642/    17DA :                     RG6:
    4643/    17DA :                     	;; 16 bit register
    4644/    17DA : 73                  	LD	(HL),E
    4645/    17DB : 23                  	INC	HL
    4646/    17DC : 72                  	LD	(HL),D
    4647/    17DD :                     RG7:
    4648/    17DD :                     RGR:
    4649/    17DD : C3 2C 01            	JP	WSTART
    4650/    17E0 :                     RGE:
    4651/    17E0 : C3 75 01            	JP	ERR
    4652/    17E3 :                     
    4653/    17E3 :                     RDUMP:
    4654/    17E3 : 21 C4 2C            	LD	HL,RDTAB
    4655/    17E6 :                     RD0:
    4656/    17E6 : 5E                  	LD	E,(HL)
    4657/    17E7 : 23                  	INC	HL
    4658/    17E8 : 56                  	LD	D,(HL)
    4659/    17E9 : 23                  	INC	HL
    4660/    17EA : 7A                  	LD	A,D
    4661/    17EB : B3                  	OR	E
    4662/    17EC : CA 4B 26            	JP	Z,CRLF		; End
    4663/    17EF : D5                  	push	de
    4664/    17F0 : EB                  	EX	DE,HL
    4665/    17F1 : CD 02 26            	CALL	STROUT	; print name of register
    4666/    17F4 : EB                  	EX	DE,HL
    4667/    17F5 : D1                  	pop	de
    4668/    17F6 :                     
    4669/    17F6 :                     ; flag check
    4670/    17F6 : 3E 2D               	ld	a, RDSF_H
    4671/    17F8 : BA                  	cp	d
    4672/    17F9 : 20 07               	jr	nz, rd101
    4673/    17FB : 3E 2F               	ld	a, RDSF_L
    4674/    17FD : BB                  	cp	e
    4675/    17FE : 20 02               	jr	nz, rd101
    4676/    1800 : 18 29               	jr	rd20
    4677/    1802 :                     
    4678/    1802 :                     rd101:
    4679/    1802 : 3E 2D               	ld	a, RDSFX_H
    4680/    1804 : BA                  	cp	d
    4681/    1805 : 20 05               	jr	nz, rd10
    4682/    1807 : 3E 56               	ld	a, RDSFX_L
    4683/    1809 : BB                  	cp	e
    4684/    180A : 28 1F               	jr	z, rd20
    4685/    180C :                     
    4686/    180C :                     rd10:
    4687/    180C : 5E                  	LD	E,(HL)
    4688/    180D : 23                  	INC	HL
    4689/    180E : 56                  	LD	D,(HL)
    4690/    180F : 23                  	INC	HL
    4691/    1810 : 7E                  	LD	A,(HL)
    4692/    1811 : 23                  	INC	HL
    4693/    1812 : EB                  	EX	DE,HL
    4694/    1813 : FE 01               	CP	1
    4695/    1815 : 20 07               	JR	NZ,RD1
    4696/    1817 :                     	;; 1 byte
    4697/    1817 : 7E                  	LD	A,(HL)
    4698/    1818 : CD 10 26            	CALL	HEXOUT2
    4699/    181B : EB                  	EX	DE,HL
    4700/    181C : 18 C8               	JR	RD0
    4701/    181E :                     RD1:
    4702/    181E :                     	;; 2 byte
    4703/    181E : 23                  	INC	HL
    4704/    181F : 7E                  	LD	A,(HL)
    4705/    1820 : CD 10 26            	CALL	HEXOUT2		; High byte
    4706/    1823 : 2B                  	DEC	HL
    4707/    1824 : 7E                  	LD	A,(HL)
    4708/    1825 : CD 10 26            	CALL	HEXOUT2		; Low byte
    4709/    1828 : EB                  	EX	DE,HL
    4710/    1829 : 18 BB               	JR	RD0
    4711/    182B :                     
    4712/    182B :                     ; make flag image string
    4713/    182B :                     rd20:
    4714/    182B : 5E                  	LD	E,(HL)
    4715/    182C : 23                  	INC	HL
    4716/    182D : 56                  	LD	D,(HL)
    4717/    182E : 23                  	INC	HL
    4718/    182F : 1A                  	ld	a, (de)		; get flag values
    4719/    1830 :                     
    4720/    1830 : D5                  	push	de
    4721/    1831 : E5                  	push	hl
    4722/    1832 :                     
    4723/    1832 :                     ; make flag image
    4724/    1832 :                     
    4725/    1832 : 21 79 EF            	ld	hl, F_bit
    4726/    1835 : 01 5F 18            	ld	bc, F_bit_on
    4727/    1838 : 11 67 18            	ld	de, F_bit_off
    4728/    183B : F5                  	push	af		; adjustment SP. DO NOT DELETE THIS LINE!
    4729/    183C :                     
    4730/    183C :                     flg_loop:
    4731/    183C : F1                  	pop	af		; "push af" before loop back
    4732/    183D : CB 27               	sla	a
    4733/    183F : 30 06               	jr	nc, flg_off
    4734/    1841 : F5                  	push	af
    4735/    1842 : 0A                  	ld	a, (bc)
    4736/    1843 : 77                  	ld	(hl), a
    4737/    1844 : F1                  	pop	af
    4738/    1845 : 18 04               	jr	flg_nxt
    4739/    1847 :                     flg_off:
    4740/    1847 : F5                  	push	af
    4741/    1848 : 1A                  	ld	a, (de)
    4742/    1849 : 77                  	ld	(hl), a
    4743/    184A : F1                  	pop	af
    4744/    184B :                     
    4745/    184B :                     flg_nxt:
    4746/    184B : 03                  	inc	bc
    4747/    184C : 13                  	inc	de
    4748/    184D : 23                  	inc	hl
    4749/    184E :                     
    4750/    184E : F5                  	push	af
    4751/    184F : 7E                  	ld	a, (hl)
    4752/    1850 : B7                  	or	a		;check delimiter
    4753/    1851 : 20 E9               	jr	nz, flg_loop
    4754/    1853 :                     
    4755/    1853 : F1                  	pop	af		; restore stack position
    4756/    1854 : 21 79 EF            	ld	hl, F_bit
    4757/    1857 : CD 02 26            	call	STROUT		; print flag register for bit imaze
    4758/    185A :                     
    4759/    185A : E1                  	pop	hl
    4760/    185B : D1                  	pop	de
    4761/    185C :                     
    4762/    185C : 23                  	inc	hl
    4763/    185D : 18 87               	JR	RD0
    4764/    185F :                     
    4765/    185F : 53 5A 2E 48 2E 50   F_bit_on:	db	"SZ.H.PNC"
             1865 : 4E 43             
    4766/    1867 : 2E 2E 2E 2E 2E 2E   F_bit_off:	db	"........"
             186D : 2E 2E             
    4767/    186F :                     
    4768/    186F :                     ;--------------------------------------------------
    4769/    186F :                     ;
    4770/    186F :                     ; Minimal assemble
    4771/    186F :                     ;
    4772/    186F :                     ;--------------------------------------------------
    4773/    186F :                     
    4774/    186F : =80H                dm_bit	equ	80h
    4775/    186F :                     
    4776/    186F :                     ope_cds:
    4777/    186F :                     ; 4 bytes string
    4778/    186F : 49 4E 49 52 B9      	db	"INIR",	dm_bit | 57
    4779/    1874 : 49 4E 44 52 BB      	db	"INDR",	dm_bit | 59
    4780/    1879 : 4F 55 54 49 BD      	db	"OUTI",	dm_bit | 61
    4781/    187E : 4F 54 49 52 BE      	db	"OTIR",	dm_bit | 62
    4782/    1883 : 4F 55 54 44 BF      	db	"OUTD",	dm_bit | 63
    4783/    1888 : 4F 54 44 52 C0      	db	"OTDR",	dm_bit | 64
    4784/    188D : 48 41 4C 54 B3      	db	"HALT",	dm_bit | 51
    4785/    1892 : 52 45 54 49 AF      	db	"RETI",	dm_bit | 47
    4786/    1897 : 52 45 54 4E B0      	db	"RETN",	dm_bit | 48
    4787/    189C : 44 4A 4E 5A AC      	db	"DJNZ",	dm_bit | 44
    4788/    18A1 : 43 41 4C 4C AD      	db	"CALL",	dm_bit | 45
    4789/    18A6 : 43 50 44 52 A8      	db	"CPDR",	dm_bit | 40
    4790/    18AB : 4C 44 49 52 83      	db	"LDIR",	dm_bit | 03
    4791/    18B0 : 4C 44 44 52 85      	db	"LDDR",	dm_bit | 05
    4792/    18B5 : 50 55 53 48 88      	db	"PUSH",	dm_bit | 08
    4793/    18BA : 52 4C 43 41 8A      	db	"RLCA",	dm_bit | 10
    4794/    18BF : 52 52 43 41 8E      	db	"RRCA",	dm_bit | 14
    4795/    18C4 : 43 50 49 52 A6      	db	"CPIR",	dm_bit | 38
    4796/    18C9 :                     
    4797/    18C9 :                     ; 3 bytes string
    4798/    18C9 : 4C 44 49 82         	db	"LDI",	dm_bit | 02
    4799/    18CD : 4C 44 44 84         	db	"LDD",	dm_bit | 04
    4800/    18D1 : 45 58 58 87         	db	"EXX",	dm_bit | 07
    4801/    18D5 : 50 4F 50 89         	db	"POP",	dm_bit | 09
    4802/    18D9 : 52 4C 41 8B         	db	"RLA",	dm_bit | 11
    4803/    18DD : 52 4C 43 8C         	db	"RLC",	dm_bit | 12
    4804/    18E1 : 52 52 41 8F         	db	"RRA",	dm_bit | 15
    4805/    18E5 : 52 52 43 90         	db	"RRC",	dm_bit | 16
    4806/    18E9 : 53 4C 41 92         	db	"SLA",	dm_bit | 18
    4807/    18ED : 53 52 41 93         	db	"SRA",	dm_bit | 19
    4808/    18F1 : 53 52 4C 94         	db	"SRL",	dm_bit | 20
    4809/    18F5 : 41 44 44 95         	db	"ADD",	dm_bit | 21
    4810/    18F9 : 41 44 43 96         	db	"ADC",	dm_bit | 22
    4811/    18FD : 49 4E 43 97         	db	"INC",	dm_bit | 23
    4812/    1901 : 53 55 42 98         	db	"SUB",	dm_bit | 24
    4813/    1905 : 53 42 43 99         	db	"SBC",	dm_bit | 25
    4814/    1909 : 44 45 43 9A         	db	"DEC",	dm_bit | 26
    4815/    190D : 41 4E 44 9B         	db	"AND",	dm_bit | 27
    4816/    1911 : 58 4F 52 9D         	db	"XOR",	dm_bit | 29
    4817/    1915 : 43 50 4C 9E         	db	"CPL",	dm_bit | 30
    4818/    1919 : 4E 45 47 9F         	db	"NEG",	dm_bit | 31
    4819/    191D : 43 43 46 A0         	db	"CCF",	dm_bit | 32
    4820/    1921 : 53 43 46 A1         	db	"SCF",	dm_bit | 33
    4821/    1925 : 42 49 54 A2         	db	"BIT",	dm_bit | 34
    4822/    1929 : 53 45 54 A3         	db	"SET",	dm_bit | 35
    4823/    192D : 52 45 53 A4         	db	"RES",	dm_bit | 36
    4824/    1931 : 43 50 49 A5         	db	"CPI",	dm_bit | 37
    4825/    1935 : 43 50 44 A7         	db	"CPD",	dm_bit | 39
    4826/    1939 : 52 45 54 AE         	db	"RET",	dm_bit | 46
    4827/    193D : 52 53 54 B1         	db	"RST",	dm_bit | 49
    4828/    1941 : 4E 4F 50 B2         	db	"NOP",	dm_bit | 50
    4829/    1945 : 49 4E 49 B8         	db	"INI",	dm_bit | 56
    4830/    1949 : 49 4E 44 BA         	db	"IND",	dm_bit | 58
    4831/    194D : 4F 55 54 BC         	db	"OUT",	dm_bit | 60
    4832/    1951 : 44 41 41 C1         	db	"DAA",	dm_bit | 65
    4833/    1955 : 52 4C 44 C2         	db	"RLD",	dm_bit | 66
    4834/    1959 : 52 52 44 C3         	db	"RRD",	dm_bit | 67
    4835/    195D : 4F 52 47 C4         	db	"ORG",	dm_bit | 68
    4836/    1961 :                     
    4837/    1961 :                     ; 2 bytes string
    4838/    1961 : 45 58 86            	db	"EX",	dm_bit | 06
    4839/    1964 : 52 4C 8D            	db	"RL",	dm_bit | 13
    4840/    1967 : 52 52 91            	db	"RR",	dm_bit | 17
    4841/    196A : 4F 52 9C            	db	"OR",	dm_bit | 28
    4842/    196D : 43 50 A9            	db	"CP",	dm_bit | 41
    4843/    1970 : 4A 50 AA            	db	"JP",	dm_bit | 42
    4844/    1973 : 4A 52 AB            	db	"JR",	dm_bit | 43
    4845/    1976 : 49 4D B6            	db	"IM",	dm_bit | 54
    4846/    1979 : 49 4E B7            	db	"IN",	dm_bit | 55
    4847/    197C : 44 49 B4            	db	"DI",	dm_bit | 52
    4848/    197F : 45 49 B5            	db	"EI",	dm_bit | 53
    4849/    1982 : 4C 44 81            	db	"LD",	dm_bit | 01
    4850/    1985 : 44 42 C5            	db	"DB",	dm_bit | 69
    4851/    1988 : 44 57 C6            	db	"DW",	dm_bit | 70
    4852/    198B : 00                  	db	0	; delimiter
    4853/    198C :                     
    4854/    198C :                     operand_cds:
    4855/    198C :                     ; 4 bytes string
    4856/    198C : 28 42 43 29 9A      	db	"(BC)",	dm_bit | 26
    4857/    1991 : 28 44 45 29 9B      	db	"(DE)",	dm_bit | 27
    4858/    1996 : 28 48 4C 29 9C      	db	"(HL)",	dm_bit | 28
    4859/    199B : 28 49 58 29 9D      	db	"(IX)",	dm_bit | 29
    4860/    19A0 : 28 49 59 29 9E      	db	"(IY)",	dm_bit | 30
    4861/    19A5 : 28 53 50 29 A0      	db	"(SP)",	dm_bit | 32
    4862/    19AA :                     
    4863/    19AA :                     ; 3 bytes string
    4864/    19AA : 28 43 29 9F         	db	"(C)",	dm_bit | 31
    4865/    19AE : 41 46 27 83         	db	"AF'",	dm_bit | 3
    4866/    19B2 :                     
    4867/    19B2 :                     ; 2 bytes string
    4868/    19B2 : 41 46 82            	db	"AF",	dm_bit | 2
    4869/    19B5 : 42 43 85            	db	"BC",	dm_bit | 5
    4870/    19B8 : 44 45 88            	db	"DE",	dm_bit | 8
    4871/    19BB : 48 4C 8B            	db	"HL",	dm_bit | 11
    4872/    19BE : 49 58 8E            	db	"IX",	dm_bit | 14
    4873/    19C1 : 49 59 8F            	db	"IY",	dm_bit | 15
    4874/    19C4 : 53 50 90            	db	"SP",	dm_bit | 16
    4875/    19C7 : 4E 5A 94            	db	"NZ",	dm_bit | 20
    4876/    19CA : 4E 43 95            	db	"NC",	dm_bit | 21
    4877/    19CD : 50 4F 97            	db	"PO",	dm_bit | 23
    4878/    19D0 : 50 45 98            	db	"PE",	dm_bit | 24
    4879/    19D3 :                     
    4880/    19D3 :                     ; 1 bytes string
    4881/    19D3 : 41 81               	db	"A",  	dm_bit | 1
    4882/    19D5 : 42 84               	db	"B",	dm_bit | 4
    4883/    19D7 : 43 86               	db	"C",	dm_bit | 6
    4884/    19D9 : 44 87               	db	"D",	dm_bit | 7
    4885/    19DB : 45 89               	db	"E",	dm_bit | 9
    4886/    19DD : 48 8A               	db	"H",	dm_bit | 10
    4887/    19DF : 4C 8C               	db	"L",	dm_bit | 12
    4888/    19E1 : 49 8D               	db	"I",	dm_bit | 13
    4889/    19E3 : 52 91               	db	"R",	dm_bit | 17
    4890/    19E5 : 5A 92               	db	"Z",	dm_bit | 18
    4891/    19E7 : 4D 93               	db	"M",	dm_bit | 19
    4892/    19E9 : 50 96               	db	"P",	dm_bit | 22
    4893/    19EB : 00                  	db	0	; delimiter
    4894/    19EC :                     
    4895/    19EC :                     opr_cd1:
    4896/    19EC : 28 49 58 2B A1      	db	"(IX+",	dm_bit | 33
    4897/    19F1 : 28 49 59 2B A2      	db	"(IY+",	dm_bit | 34
    4898/    19F6 : 28 49 58 2D A4      	db	"(IX-",	dm_bit | 36
    4899/    19FB : 28 49 59 2D A5      	db	"(IY-",	dm_bit | 37
    4900/    1A00 : 00                  	db	0	; delimiter
    4901/    1A01 :                     
    4902/    1A01 :                     ;----------------------------------------------
    4903/    1A01 :                     ; A[<address>] : input line assemble mode
    4904/    1A01 :                     ; A[.]<cr> : exit assemble mode
    4905/    1A01 :                     ;----------------------------------------------
    4906/    1A01 :                     line_asm:
    4907/    1A01 : 23                  	inc	hl
    4908/    1A02 : CD 6C 25            	call	skp_sp
    4909/    1A05 : B7                  	or	a
    4910/    1A06 : 28 11               	jr	z, skpa_adr
    4911/    1A08 : CD FC 26            	call	RDHEX		; get DE: address
    4912/    1A0B : DA 75 01            	jp	c, ERR
    4913/    1A0E : ED 53 64 EF         	ld	(asm_adr), de	; set start address
    4914/    1A12 :                     
    4915/    1A12 : CD 6C 25            	call	skp_sp
    4916/    1A15 : B7                  	or	a
    4917/    1A16 : C2 75 01            	jp	nz, ERR
    4918/    1A19 :                     	
    4919/    1A19 :                     	; init work area
    4920/    1A19 :                     skpa_adr:
    4921/    1A19 : 2A 64 EF            	ld	hl, (asm_adr)
    4922/    1A1C : 22 66 EF            	ld	(tasm_adr), hl
    4923/    1A1F :                     	
    4924/    1A1F :                     	; print address
    4925/    1A1F :                     
    4926/    1A1F :                     next_asm:
    4927/    1A1F : AF                  	xor	a
    4928/    1A20 : 32 68 EF            	ld	(element_cnt), a
    4929/    1A23 : 32 6A EF            	ld	(opc_cd), a
    4930/    1A26 : 32 6B EF            	ld	(opr1_cd), a
    4931/    1A29 : 32 6C EF            	ld	(opr2_cd), a
    4932/    1A2C :                     
    4933/    1A2C : 2A 66 EF            	ld	hl, (tasm_adr)
    4934/    1A2F : CD 0B 26            	call	HEXOUT4
    4935/    1A32 : 21 A6 2C            	ld	hl, dsap
    4936/    1A35 : CD 02 26            	call	STROUT
    4937/    1A38 :                     
    4938/    1A38 :                     ;-----------------------------
    4939/    1A38 :                     ; get a line from console
    4940/    1A38 :                     ;-----------------------------
    4941/    1A38 : 21 82 EF            	ld	hl, ky_flg
    4942/    1A3B : CB CE               	set	NO_LF>>1, (hl)
    4943/    1A3D :                     
    4944/    1A3D : CD 62 26            	call	GETLIN
    4945/    1A40 :                     
    4946/    1A40 : E5                  	push	hl
    4947/    1A41 : 21 82 EF            	ld	hl, ky_flg
    4948/    1A44 : CB 8E               	res	NO_LF>>1, (hl)
    4949/    1A46 : E1                  	pop	hl
    4950/    1A47 :                     
    4951/    1A47 : CD BC 25            	call	recorrect
    4952/    1A4A : 7E                  	ld	a, (hl)
    4953/    1A4B : FE 1B               	cp	ESC
    4954/    1A4D : 28 0D               	jr	z, ext_asm
    4955/    1A4F : FE 2E               	cp	'.'
    4956/    1A51 : 28 09               	jr	z, ext_asm
    4957/    1A53 : B7                  	or	a		; NULL?
    4958/    1A54 : C2 EB 1A            	jp	nz, cont_asm
    4959/    1A57 : CD 68 1A            	call	lf_out
    4960/    1A5A : 18 C3               	jr	next_asm
    4961/    1A5C :                     
    4962/    1A5C :                     ext_asm:
    4963/    1A5C : CD 68 1A            	call	lf_out
    4964/    1A5F : 2A 66 EF            	ld	hl, (tasm_adr)
    4965/    1A62 : 22 64 EF            	ld	(asm_adr), hl	; save new address
    4966/    1A65 : C3 2C 01            	jp	WSTART		; exit assemble mode
    4967/    1A68 :                     
    4968/    1A68 :                     lf_out:
    4969/    1A68 : 3E 0A               	ld	a, LF
    4970/    1A6A : C3 E5 2E            	jp	CONOUT
    4971/    1A6D :                     
    4972/    1A6D :                     asm_err:
    4973/    1A6D : 21 3F 13            	ld	hl, com_errm
    4974/    1A70 :                     asm_err1:
    4975/    1A70 : CD 68 1A            	call	lf_out
    4976/    1A73 : CD 02 26            	call	STROUT
    4977/    1A76 : 21 97 2C            	ld	hl, ERRMSG
    4978/    1A79 : CD 02 26            	call	STROUT
    4979/    1A7C : 18 A1               	jr	next_asm
    4980/    1A7E :                     
    4981/    1A7E :                     ;-------------------------------------------------
    4982/    1A7E :                     ; post operation
    4983/    1A7E :                     ;-------------------------------------------------
    4984/    1A7E :                     cout_sp:
    4985/    1A7E : 3A 6A EF            	ld	a, (opc_cd)
    4986/    1A81 : FE 44               	cp	68
    4987/    1A83 : 28 37               	jr	z, skp_outm
    4988/    1A85 : FE 45               	cp	69
    4989/    1A87 : 28 38               	jr	z, dmp_db
    4990/    1A89 : FE 46               	cp	70
    4991/    1A8B : 28 3F               	jr	z, dmp_dw
    4992/    1A8D :                     
    4993/    1A8D : 3E 20               	ld	a, ' '
    4994/    1A8F : 0E 26               	ld	c, BUFLEN-2	; clear
    4995/    1A91 : 21 8D EF            	ld	hl, line_buf	; disassemble string buffer
    4996/    1A94 :                     cout_sp1:
    4997/    1A94 : 77                  	ld	(hl), a
    4998/    1A95 : 23                  	inc	hl
    4999/    1A96 : 0D                  	dec	c
    5000/    1A97 : 20 FB               	jr	nz, cout_sp1
    5001/    1A99 : 3E 0D               	ld	a, CR
    5002/    1A9B : 77                  	ld	(hl), a
    5003/    1A9C : 23                  	inc	hl
    5004/    1A9D : AF                  	xor	a
    5005/    1A9E : 77                  	ld	(hl), a		; set delimitor
    5006/    1A9F : CD 02 26            	call	STROUT
    5007/    1AA2 :                     
    5008/    1AA2 : 2A 66 EF            	ld	hl, (tasm_adr)	; disassemble address
    5009/    1AA5 : 11 8D EF            	ld	de, line_buf	; disassemble string buffer
    5010/    1AA8 : D5                  	push	de
    5011/    1AA9 : CD F0 08            	call	get_disasm_st
    5012/    1AAC : E1                  	pop	hl
    5013/    1AAD : CD 02 26            	call	STROUT		; cousole out result inline assemble
    5014/    1AB0 :                     cout_sp2:
    5015/    1AB0 : 2A 66 EF            	ld	hl, (tasm_adr)	; disassemble address
    5016/    1AB3 : CD E3 1A            	call	setbytec
    5017/    1AB6 : 22 66 EF            	ld	(tasm_adr), hl	; next address
    5018/    1AB9 : C3 1F 1A            	jp	next_asm
    5019/    1ABC :                     
    5020/    1ABC :                     skp_outm:
    5021/    1ABC : CD 68 1A            	call	lf_out
    5022/    1ABF : 18 EF               	jr	cout_sp2
    5023/    1AC1 :                     
    5024/    1AC1 :                     dmp_db:
    5025/    1AC1 : CD D9 1A            	call	setdsadr
    5026/    1AC4 : CD E3 1A            	call	setbytec
    5027/    1AC7 : 22 12 EF            	ld	(deaddr), hl
    5028/    1ACA : 18 08               	jr	prtdmp
    5029/    1ACC :                     
    5030/    1ACC :                     dmp_dw:
    5031/    1ACC : CD D9 1A            	call	setdsadr
    5032/    1ACF : 23                  	inc	hl
    5033/    1AD0 : 23                  	inc	hl
    5034/    1AD1 : 22 12 EF            	ld	(deaddr), hl
    5035/    1AD4 :                     prtdmp:	
    5036/    1AD4 : CD B4 07            	call	dpm
    5037/    1AD7 : 18 D7               	jr	cout_sp2
    5038/    1AD9 :                     
    5039/    1AD9 :                     setdsadr:
    5040/    1AD9 : CD 68 1A            	call	lf_out
    5041/    1ADC : 2A 66 EF            	ld	hl, (tasm_adr)
    5042/    1ADF : 22 10 EF            	ld	(dsaddr), hl
    5043/    1AE2 : C9                  	ret
    5044/    1AE3 :                     
    5045/    1AE3 :                     setbytec:
    5046/    1AE3 : 3A 69 EF            	ld	a, (byte_count)
    5047/    1AE6 : 4F                  	ld	c, a
    5048/    1AE7 : AF                  	xor	a
    5049/    1AE8 : 47                  	ld	b, a
    5050/    1AE9 : 09                  	add	hl, bc
    5051/    1AEA : C9                  	ret
    5052/    1AEB :                     
    5053/    1AEB :                     ;----------------------------
    5054/    1AEB :                     ; analize input data
    5055/    1AEB :                     ;----------------------------
    5056/    1AEB :                     cont_asm:
    5057/    1AEB : CD 45 24            	call	analize_input
    5058/    1AEE : DA 6D 1A            	jp	c, asm_err		;error
    5059/    1AF1 :                     
    5060/    1AF1 :                     ; make machine code
    5061/    1AF1 :                     
    5062/    1AF1 : 3A 68 EF            	ld	a, (element_cnt)
    5063/    1AF4 : FE 01               	cp	1
    5064/    1AF6 : CA C6 20            	jp	z, mk_e1
    5065/    1AF9 : FE 02               	cp	2
    5066/    1AFB : CA 50 21            	jp	z, mk_e2
    5067/    1AFE :                     
    5068/    1AFE :                     ;333333333333333333333333333333333333333
    5069/    1AFE :                     ;
    5070/    1AFE :                     ; make machine code,
    5071/    1AFE :                     ; element_cnt = 3 (ex. LD SP, HL)
    5072/    1AFE :                     ;
    5073/    1AFE :                     ;333333333333333333333333333333333333333
    5074/    1AFE :                     
    5075/    1AFE : =0DH                el3_um	equ	el3_stbe - el3_stb
    5076/    1AFE :                     
    5077/    1AFE : 3A 6A EF            mk_e3:	ld	a, (opc_cd)
    5078/    1B01 : 01 0D 00            	ld	bc, el3_um
    5079/    1B04 : 21 16 1B            	ld	hl, el3_stb
    5080/    1B07 : ED B1               	cpir
    5081/    1B09 : C2 6D 1A            	jp	nz, asm_err
    5082/    1B0C :                     	
    5083/    1B0C : 21 23 1B            	ld	hl, el3_jtb
    5084/    1B0F :                     
    5085/    1B0F :                     jp_each:
    5086/    1B0F : 09                  	add	hl, bc		; offset : BC = BC * 2
    5087/    1B10 : 09                  	add	hl, bc		; HL = ent_el2 + offset
    5088/    1B11 : 4E                  	ld	c, (hl)
    5089/    1B12 : 23                  	inc	hl
    5090/    1B13 : 46                  	ld	b, (hl)
    5091/    1B14 : C5                  	push	bc
    5092/    1B15 : C9                  	ret
    5093/    1B16 :                     
    5094/    1B16 : 01                  el3_stb:	db	1			; normal, DD, FD, ED
    5095/    1B17 : 06 15               		db	6, 21 			; normal, DD, FD
    5096/    1B19 : 16 19               		db	22, 25			; normal, DD, FD, ED
    5097/    1B1B : 2B                  		db	43 			; normal
    5098/    1B1C : 37 3C               		db	55, 60			; normal, ED
    5099/    1B1E : 2A 2D               		db	42, 45			; normal
    5100/    1B20 : 22 24 23            		db	34, 36, 35 		; CB, DD, FD
    5101/    1B23 :                     el3_stbe:	
    5102/    1B23 :                     
    5103/    1B23 : 4D 1B               el3_jtb:	dw	el3_35
    5104/    1B25 : 6B 1B               		dw	el3_36
    5105/    1B27 : 89 1B               		dw	el3_34
    5106/    1B29 : 0A 1C               		dw	el3_45
    5107/    1B2B : 17 1C               		dw	el3_42
    5108/    1B2D : 37 1C               		dw	el3_60
    5109/    1B2F : 40 1C               		dw	el3_55
    5110/    1B31 : 80 1C               		dw	el3_43
    5111/    1B33 : B5 1C               		dw	el3_25
    5112/    1B35 : BD 1C               		dw	el3_22
    5113/    1B37 : 36 1D               		dw	el3_21
    5114/    1B39 : B8 1D               		dw	el3_6
    5115/    1B3B : 42 1E               		dw	el3_1
    5116/    1B3D :                     
    5117/    1B3D :                     
    5118/    1B3D :                     ;
    5119/    1B3D :                     ; SET section
    5120/    1B3D :                     ;
    5121/    1B3D :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5122/    1B3D :                     
    5123/    1B3D : C0 C8 D0 D8 E0 E8   set_mcb:	db	0C0h, 0C8h, 0D0h, 0D8h, 0E0h, 0E8h, 0F0h, 0F8h
             1B43 : F0 F8             
    5124/    1B45 : C6 CE D6 DE E6 EE   set_xyt:	db	0C6h, 0CEh, 0D6h, 0DEh, 0E6h, 0EEh, 0F6h, 0FEh
             1B4B : F6 FE             
    5125/    1B4D :                     
    5126/    1B4D :                     el3_35: ; SET  ( CB, DD, FD )
    5127/    1B4D :                     
    5128/    1B4D : 21 3D 1B            	ld	hl, set_mcb
    5129/    1B50 : 22 75 EF            	ld	(cb_mcw), hl
    5130/    1B53 : 21 45 1B            	ld	hl, set_xyt
    5131/    1B56 : 22 77 EF            	ld	(cb_xyw), hl
    5132/    1B59 : 18 3A               	jr	bit_res_set
    5133/    1B5B :                     
    5134/    1B5B :                     ;
    5135/    1B5B :                     ; RES section
    5136/    1B5B :                     ;
    5137/    1B5B :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5138/    1B5B :                     
    5139/    1B5B : 80 88 90 98 A0 A8   res_mcb:	db	80h, 88h, 90h, 98h, 0A0h, 0A8h, 0B0h, 0B8h
             1B61 : B0 B8             
    5140/    1B63 : 86 8E 96 9E A6 AE   res_xyt:	db	86h, 8Eh, 96h, 9Eh, 0A6h, 0AEh, 0B6h, 0BEh
             1B69 : B6 BE             
    5141/    1B6B :                     
    5142/    1B6B :                     el3_36: ; RES  ( CB, DD, FD )
    5143/    1B6B :                     
    5144/    1B6B : 21 5B 1B            	ld	hl, res_mcb
    5145/    1B6E : 22 75 EF            	ld	(cb_mcw), hl
    5146/    1B71 : 21 63 1B            	ld	hl, res_xyt
    5147/    1B74 : 22 77 EF            	ld	(cb_xyw), hl
    5148/    1B77 : 18 1C               	jr	bit_res_set
    5149/    1B79 :                     
    5150/    1B79 :                     ;
    5151/    1B79 :                     ; BIT section
    5152/    1B79 :                     ;
    5153/    1B79 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5154/    1B79 :                     
    5155/    1B79 : =8H                 bit_mcbn	equ	bit_mcbe - bit_mcb
    5156/    1B79 : 40 48 50 58 60 68   bit_mcb:	db	40h, 48h, 50h, 58h, 60h, 68h, 70h, 78h
             1B7F : 70 78             
    5157/    1B81 :                     bit_mcbe:
    5158/    1B81 : 46 4E 56 5E 66 6E   bit_xyt:	db	46h, 4Eh, 56h, 5Eh, 66h, 6Eh, 76h, 7Eh
             1B87 : 76 7E             
    5159/    1B89 :                     
    5160/    1B89 :                     
    5161/    1B89 :                     el3_34: ; BIT  ( CB, DD, FD )
    5162/    1B89 :                     
    5163/    1B89 : 21 79 1B            	ld	hl, bit_mcb
    5164/    1B8C : 22 75 EF            	ld	(cb_mcw), hl
    5165/    1B8F : 21 81 1B            	ld	hl, bit_xyt
    5166/    1B92 : 22 77 EF            	ld	(cb_xyw), hl
    5167/    1B95 :                     
    5168/    1B95 :                     bit_res_set:
    5169/    1B95 : 3A 6B EF            	ld	a, (opr1_cd)
    5170/    1B98 : FE 19               	cp	25
    5171/    1B9A : C2 6D 1A            	jp	nz, asm_err
    5172/    1B9D :                     
    5173/    1B9D : 2A 6D EF            	ld	hl, (opr_num25)
    5174/    1BA0 : 7C                  	ld	a, h
    5175/    1BA1 : B7                  	or	a
    5176/    1BA2 : C2 6D 1A            	jp	nz, asm_err
    5177/    1BA5 : 7D                  	ld	a, l
    5178/    1BA6 : FE 08               	cp	8
    5179/    1BA8 : D2 6D 1A            	jp	nc, asm_err
    5180/    1BAB :                     
    5181/    1BAB :                     	; HL : 0 - 7
    5182/    1BAB :                     
    5183/    1BAB : 3A 6C EF            	ld	a, (opr2_cd)
    5184/    1BAE : FE 21               	cp	33
    5185/    1BB0 : 28 2C               	jr	z, bit_ixp
    5186/    1BB2 : FE 24               	cp	36
    5187/    1BB4 : 28 3A               	jr	z, bit_ixm
    5188/    1BB6 : FE 22               	cp	34
    5189/    1BB8 : 28 3B               	jr	z, bit_iyp
    5190/    1BBA : FE 25               	cp	37
    5191/    1BBC : 28 3F               	jr	z, bit_iym
    5192/    1BBE :                     ;
    5193/    1BBE :                     ; CB : bit n, [r | (hl)]
    5194/    1BBE :                     ;
    5195/    1BBE : ED 4B 75 EF         	ld	bc, (cb_mcw)
    5196/    1BC2 : 09                  	add	hl, bc
    5197/    1BC3 : 56                  	ld	d, (hl)		; get MC base
    5198/    1BC4 :                     
    5199/    1BC4 : 3A 6C EF            	ld	a, (opr2_cd)
    5200/    1BC7 : 21 15 1E            	ld	hl, r_hl_nn
    5201/    1BCA : 01 08 00            	ld	bc, bit_mcbn
    5202/    1BCD : ED B1               	cpir
    5203/    1BCF : C2 6D 1A            	jp	nz, asm_err
    5204/    1BD2 :                     
    5205/    1BD2 : 79                  	ld	a, c
    5206/    1BD3 : FE 07               	cp	7
    5207/    1BD5 : 28 03               	jr	z, el3_341
    5208/    1BD7 :                     
    5209/    1BD7 : 3E 06               	ld	a, 6
    5210/    1BD9 : 91                  	sub	c
    5211/    1BDA :                     el3_341:
    5212/    1BDA : 82                  	add	a, d		; make 2nd MC
    5213/    1BDB : C3 F1 23            	jp	el2_130
    5214/    1BDE :                     
    5215/    1BDE :                     	; HL : 0 - 7
    5216/    1BDE :                     
    5217/    1BDE :                     bit_ixp:
    5218/    1BDE : 3A 74 EF            	ld	a, (opr_num33)
    5219/    1BE1 :                     bit_ixp1:
    5220/    1BE1 : 5F                  	ld	e, a
    5221/    1BE2 : 16 DD               	ld	d, 0DDh
    5222/    1BE4 :                     
    5223/    1BE4 :                     ; adjust I/F
    5224/    1BE4 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    5225/    1BE4 :                     
    5226/    1BE4 :                     el3_342:
    5227/    1BE4 : ED 4B 77 EF         	ld	bc, (cb_xyw)
    5228/    1BE8 : 09                  	add	hl, bc
    5229/    1BE9 : 4B                  	ld	c, e		; adjust I/F
    5230/    1BEA : 5E                  	ld	e, (hl)		; 4th MC
    5231/    1BEB : 3E CB               	ld	a, 0CBh
    5232/    1BED : C3 14 24            	jp	mc_end41	; save 4byte MC
    5233/    1BF0 :                     
    5234/    1BF0 :                     bit_ixm:
    5235/    1BF0 : 3A 73 EF            	ld	a, (opr_num36)
    5236/    1BF3 : 18 EC               	jr	bit_ixp1
    5237/    1BF5 :                     
    5238/    1BF5 :                     
    5239/    1BF5 :                     bit_iyp:
    5240/    1BF5 : 3A 72 EF            	ld	a, (opr_num34)
    5241/    1BF8 :                     bit_iyp1:
    5242/    1BF8 : 5F                  	ld	e, a
    5243/    1BF9 : 16 FD               	ld	d, 0FDh
    5244/    1BFB : 18 E7               	jr	el3_342
    5245/    1BFD :                     
    5246/    1BFD :                     bit_iym:
    5247/    1BFD : 3A 71 EF            	ld	a, (opr_num37)
    5248/    1C00 : 18 F6               	jr	bit_iyp1
    5249/    1C02 :                     
    5250/    1C02 :                     ;
    5251/    1C02 :                     ; CALL section
    5252/    1C02 :                     ; ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
    5253/    1C02 :                     ;
    5254/    1C02 : EC E4 F4 D4 C4 FC   call_mc1t:	db	0ECh, 0E4h, 0F4h, 0D4h, 0C4h, 0FCh, 0CCh, 0DCh
             1C08 : CC DC             
    5255/    1C0A :                     
    5256/    1C0A :                     el3_45: ; CALL ( normal )
    5257/    1C0A :                     
    5258/    1C0A : 11 02 1C            	ld	de, call_mc1t
    5259/    1C0D : 18 0B               	jr	el3_421
    5260/    1C0F :                     ;
    5261/    1C0F :                     ; JP section
    5262/    1C0F :                     ; ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
    5263/    1C0F :                     ;
    5264/    1C0F : =8H                 jp_mc1tm	equ	jp_mc1te - jp_mc1t
    5265/    1C0F : EA E2 F2 D2 C2 FA   jp_mc1t:	db	0EAh, 0E2h, 0F2h, 0D2h, 0C2h, 0FAh, 0CAh, 0DAh
             1C15 : CA DA             
    5266/    1C17 :                     jp_mc1te:
    5267/    1C17 :                     
    5268/    1C17 :                     el3_42: ; JP   ( normal )
    5269/    1C17 :                     
    5270/    1C17 : 11 0F 1C            	ld	de, jp_mc1t
    5271/    1C1A :                     
    5272/    1C1A :                     el3_421:
    5273/    1C1A : 21 62 22            	ld	hl, ret_no
    5274/    1C1D : 01 08 00            	ld	bc, jp_mc1tm
    5275/    1C20 : 3A 6B EF            	ld	a, (opr1_cd)
    5276/    1C23 : ED B1               	cpir
    5277/    1C25 : C2 6D 1A            	jp	nz, asm_err
    5278/    1C28 :                     
    5279/    1C28 : 3A 6C EF            	ld	a, (opr2_cd)
    5280/    1C2B : FE 19               	cp	25
    5281/    1C2D : C2 6D 1A            	jp	nz, asm_err
    5282/    1C30 :                     
    5283/    1C30 : 62                  	ld	h, d		; DE : MC target table
    5284/    1C31 : 6B                  	ld	l, e		; DE : MC target table
    5285/    1C32 : 09                  	add	hl, bc
    5286/    1C33 : 7E                  	ld	a, (hl)		; get 1st MC
    5287/    1C34 : C3 E5 21            	jp	el2_451
    5288/    1C37 :                     
    5289/    1C37 :                     ;
    5290/    1C37 :                     ; OUT section
    5291/    1C37 :                     ;
    5292/    1C37 : =6H                 in_selm		equ	ld_e2_tbl1 - in_selt
    5293/    1C37 :                     
    5294/    1C37 :                     el3_60: ; OUT  ( normal, ED )
    5295/    1C37 :                     
    5296/    1C37 : 11 D3 41            	ld	de, 41D3H
    5297/    1C3A : ED 4B 6B EF         	ld	bc, (opr1_cd)	; c = (opr1_cd), b = (opr2_cd)
    5298/    1C3E : 18 0B               	jr	el3_550
    5299/    1C40 :                     
    5300/    1C40 :                     ;
    5301/    1C40 :                     ; IN section
    5302/    1C40 :                     ;
    5303/    1C40 :                     el3_55: ; IN   ( normal, ED )
    5304/    1C40 :                     
    5305/    1C40 : 11 DB 40            	ld	de, 40DBH
    5306/    1C43 : 3A 6B EF            	ld	a, (opr1_cd)
    5307/    1C46 : 47                  	ld	b, a
    5308/    1C47 : 3A 6C EF            	ld	a, (opr2_cd)
    5309/    1C4A : 4F                  	ld	c, a
    5310/    1C4B :                     
    5311/    1C4B :                     el3_550:
    5312/    1C4B : 79                  	ld	a, c
    5313/    1C4C : FE 23               	cp	35
    5314/    1C4E : 28 1F               	jr	z, in_a_nn
    5315/    1C50 : FE 1F               	cp	31
    5316/    1C52 : C2 6D 1A            	jp	nz, asm_err
    5317/    1C55 :                     
    5318/    1C55 : 78                  	ld	a, b
    5319/    1C56 : FE 01               	cp	1
    5320/    1C58 : 28 0F               	jr	z, el3_551	; passing search
    5321/    1C5A :                     	
    5322/    1C5A : 21 FF 1D            	ld	hl, in_selt
    5323/    1C5D : 01 06 00            	ld	bc, in_selm
    5324/    1C60 : CD A4 1C            	call	mkmc_sh
    5325/    1C63 : DA 6D 1A            	jp	c, asm_err
    5326/    1C66 : 7A                  	ld	a, d
    5327/    1C67 : 18 03               	jr	el3_552
    5328/    1C69 :                     	
    5329/    1C69 :                     el3_551:
    5330/    1C69 : 7A                  	ld	a, d
    5331/    1C6A : C6 38               	add	a, 38h		; get 2nd MC
    5332/    1C6C :                     el3_552:
    5333/    1C6C : C3 3F 24            	jp	el2_5411
    5334/    1C6F :                     
    5335/    1C6F :                     in_a_nn:
    5336/    1C6F : 2A 6F EF            	ld	hl, (opr_num35)
    5337/    1C72 : 7C                  	ld	a, h
    5338/    1C73 : B7                  	or	a
    5339/    1C74 : C2 6D 1A            	jp	nz, asm_err
    5340/    1C77 : 7D                  	ld	a, l
    5341/    1C78 : F5                  	push	af		; adjust I/F
    5342/    1C79 : 7B                  	ld	a, e		; 1st MC
    5343/    1C7A : 18 25               	jr	el3_431		; save 2byte MC (el2_441)
    5344/    1C7C :                     	
    5345/    1C7C :                     ;
    5346/    1C7C :                     ; JR section
    5347/    1C7C :                     ;
    5348/    1C7C : 14 12 15 06         jr_cct:	db	20, 18, 21, 6
    5349/    1C80 :                     
    5350/    1C80 :                     el3_43: ; JR   ( normal )
    5351/    1C80 :                     
    5352/    1C80 : 21 7C 1C            	ld	hl, jr_cct
    5353/    1C83 : 01 04 00            	ld	bc, 4
    5354/    1C86 : 16 20               	ld	d, 20h		; base MC
    5355/    1C88 : 3A 6B EF            	ld	a, (opr1_cd)
    5356/    1C8B : CD A4 1C            	call	mkmc_sh
    5357/    1C8E : DA 6D 1A            	jp	c, asm_err
    5358/    1C91 :                     
    5359/    1C91 : 3A 6C EF            	ld	a, (opr2_cd)
    5360/    1C94 : FE 19               	cp	25		; number?
    5361/    1C96 : C2 6D 1A            	jp	nz, asm_err
    5362/    1C99 :                     
    5363/    1C99 : CD 8E 25            	call	calc_reladr
    5364/    1C9C : DA 6D 1A            	jp	c, asm_err
    5365/    1C9F :                     	
    5366/    1C9F : F5                  	push	af		; adjust I/F
    5367/    1CA0 : 7A                  	ld	a, d		; adjust I/F
    5368/    1CA1 :                     el3_431:
    5369/    1CA1 : C3 07 22            	jp	el2_441		; save 2byte MC
    5370/    1CA4 :                     ;
    5371/    1CA4 :                     ; hl : search table
    5372/    1CA4 :                     ; bc : loop counter
    5373/    1CA4 :                     ; d  : base MC 
    5374/    1CA4 :                     ;
    5375/    1CA4 :                     ; output:
    5376/    1CA4 :                     ;	  CF=1 : error
    5377/    1CA4 :                     ;	  CF=0 : D = MC
    5378/    1CA4 :                     mkmc_sh:
    5379/    1CA4 : ED A1               	cpi
    5380/    1CA6 : 28 0C               	jr	z, mkmc_shed
    5381/    1CA8 :                     	
    5382/    1CA8 : 5F                  	ld	e, a	; save a
    5383/    1CA9 : 7A                  	ld	a, d
    5384/    1CAA : C6 08               	add	a, 8
    5385/    1CAC : 57                  	ld	d, a
    5386/    1CAD :                     
    5387/    1CAD : 79                  	ld	a, c
    5388/    1CAE : B0                  	or	b
    5389/    1CAF : 7B                  	ld	a, e	; restore a
    5390/    1CB0 : 20 F2               	jr	nz, mkmc_sh
    5391/    1CB2 : 37                  	scf
    5392/    1CB3 : C9                  	ret
    5393/    1CB4 :                     
    5394/    1CB4 :                     mkmc_shed:
    5395/    1CB4 : C9                  	ret
    5396/    1CB5 :                     
    5397/    1CB5 :                     ;
    5398/    1CB5 :                     ; ADC section
    5399/    1CB5 :                     ;
    5400/    1CB5 :                     
    5401/    1CB5 :                     el3_25: ; SBC  ( normal, DD, FD, ED )
    5402/    1CB5 :                     
    5403/    1CB5 : 11 9F 42            	ld	de, 429fh
    5404/    1CB8 : 3E DE               	ld	a, 0DEh
    5405/    1CBA : 08                  	ex	af, af'
    5406/    1CBB : 18 06               	jr	el3_221
    5407/    1CBD :                     ;
    5408/    1CBD :                     ; ADC section
    5409/    1CBD :                     ;
    5410/    1CBD :                     ; defined other section
    5411/    1CBD :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5412/    1CBD :                     ; ld_rr_:	db	25
    5413/    1CBD :                     ; ex_sr_:	db	33, 36, 34, 37
    5414/    1CBD :                     ; r_hl_nne:
    5415/    1CBD :                     
    5416/    1CBD : =9H                 adc_MC	equ	ex_sr_ - r_hl_nn
    5417/    1CBD : =4H                 adc_3MC	equ	r_hl_nne - ex_sr_
    5418/    1CBD :                     
    5419/    1CBD :                     el3_22: ; ADC  ( normal, DD, FD, ED )
    5420/    1CBD :                     
    5421/    1CBD : 11 8F 4A            	ld	de, 4a8fh
    5422/    1CC0 : 3E CE               	ld	a, 0CEh
    5423/    1CC2 : 08                  	ex	af, af'
    5424/    1CC3 :                     
    5425/    1CC3 :                     el3_221:
    5426/    1CC3 : 3A 6B EF            	ld	a, (opr1_cd)
    5427/    1CC6 : FE 01               	cp	1		; A?
    5428/    1CC8 : 28 2A               	jr	z, adc_a_
    5429/    1CCA : FE 0B               	cp	11		; HL?
    5430/    1CCC : C2 6D 1A            	jp	nz, asm_err
    5431/    1CCF :                     
    5432/    1CCF :                     ; adc hl,[ BC | DE | HL | SP ]
    5433/    1CCF :                     
    5434/    1CCF : 3A 6C EF            	ld	a, (opr2_cd)
    5435/    1CD2 : FE 05               	cp	5
    5436/    1CD4 : 28 19               	jr	z, adc_hl_bc
    5437/    1CD6 : FE 08               	cp	8
    5438/    1CD8 : 28 11               	jr	z, adc_hl_de
    5439/    1CDA : FE 0B               	cp	11
    5440/    1CDC : 28 09               	jr	z, adc_hl_hl
    5441/    1CDE : FE 10               	cp	16
    5442/    1CE0 : C2 6D 1A            	jp	nz, asm_err
    5443/    1CE3 :                     
    5444/    1CE3 :                     adc_hl_sp:
    5445/    1CE3 : 3E 30               	ld	a, 30h
    5446/    1CE5 : 18 09               	jr	adc_hl_
    5447/    1CE7 :                     adc_hl_hl:
    5448/    1CE7 : 3E 20               	ld	a, 20h
    5449/    1CE9 : 18 05               	jr	adc_hl_
    5450/    1CEB :                     adc_hl_de:
    5451/    1CEB : 3E 10               	ld	a, 10h
    5452/    1CED : 18 01               	jr	adc_hl_
    5453/    1CEF :                     adc_hl_bc:
    5454/    1CEF : AF                  	xor	a
    5455/    1CF0 :                     adc_hl_:
    5456/    1CF0 : 82                  	add	a, d		; make 2nd MC
    5457/    1CF1 :                     
    5458/    1CF1 : C3 3F 24            	jp	el2_5411
    5459/    1CF4 :                     
    5460/    1CF4 :                     adc_a_:
    5461/    1CF4 : 3A 6C EF            	ld	a, (opr2_cd)
    5462/    1CF7 : 21 15 1E            	ld	hl, r_hl_nn
    5463/    1CFA : 01 09 00            	ld	bc, adc_MC
    5464/    1CFD : ED B1               	cpir
    5465/    1CFF : 20 18               	jr	nz, chk_adc3mc
    5466/    1D01 :                     
    5467/    1D01 : 79                  	ld	a, c
    5468/    1D02 : FE 08               	cp	8
    5469/    1D04 : 28 10               	jr	z, adc_a_a
    5470/    1D06 : B7                  	or	a
    5471/    1D07 : 28 05               	jr	z, adc_a_n
    5472/    1D09 : 7B                  	ld	a, e
    5473/    1D0A : 91                  	sub	c		; make MC 1
    5474/    1D0B :                     adc_a_x:
    5475/    1D0B : C3 D9 20            	jp	st_mc11
    5476/    1D0E :                     	
    5477/    1D0E :                     adc_a_n:
    5478/    1D0E : 2A 6D EF            	ld	hl, (opr_num25)
    5479/    1D11 : 08                  	ex	af, af'		; get 1st MC
    5480/    1D12 : 57                  	ld	d, a		; adjust I/F
    5481/    1D13 : C3 D2 1E            	jp	ld_r251
    5482/    1D16 :                     
    5483/    1D16 :                     adc_a_a:
    5484/    1D16 :                     ;	inc	e
    5485/    1D16 : 7B                  	ld	a, e
    5486/    1D17 : 18 F2               	jr	adc_a_x
    5487/    1D19 :                     
    5488/    1D19 :                     chk_adc3mc:
    5489/    1D19 : 21 1E 1E            	ld	hl, ex_sr_
    5490/    1D1C : 01 04 00            	ld	bc, adc_3MC
    5491/    1D1F : ED B1               	cpir
    5492/    1D21 : C2 6D 1A            	jp	nz, asm_err
    5493/    1D24 :                     
    5494/    1D24 : 21 71 EF            	ld	hl, opr_num37
    5495/    1D27 : 09                  	add	hl, bc
    5496/    1D28 : 56                  	ld	d, (hl)		; 3rd MC
    5497/    1D29 :                     
    5498/    1D29 : 79                  	ld	a, c
    5499/    1D2A : 0E FD               	ld	c, 0FDH		; 1st MC
    5500/    1D2C : FE 02               	cp	2
    5501/    1D2E : 38 02               	jr	c, adc_fd
    5502/    1D30 :                     
    5503/    1D30 : 0E DD               	ld	c, 0DDH		; 1st MC
    5504/    1D32 :                     
    5505/    1D32 :                     adc_fd:
    5506/    1D32 : 1D                  	dec	e		; get 2nd MC
    5507/    1D33 : C3 15 1F            	jp	ld_bc_n42	; save 3MC
    5508/    1D36 :                     ;
    5509/    1D36 :                     ; ADD section
    5510/    1D36 :                     ;
    5511/    1D36 :                     el3_21: ; ADD  ( normal, DD, FD )
    5512/    1D36 :                     
    5513/    1D36 : 11 87 09            	ld	de, 0987h
    5514/    1D39 : 3E C6               	ld	a, 0C6h
    5515/    1D3B : 08                  	ex	af, af'
    5516/    1D3C :                     
    5517/    1D3C : 3A 6C EF            	ld	a, (opr2_cd)
    5518/    1D3F : 47                  	ld	b, a
    5519/    1D40 : 3A 6B EF            	ld	a, (opr1_cd)
    5520/    1D43 : FE 01               	cp	1
    5521/    1D45 : 28 AD               	jr	z, adc_a_
    5522/    1D47 : FE 0B               	cp	11
    5523/    1D49 : 28 47               	jr	z, add_hl_
    5524/    1D4B : FE 0E               	cp	14
    5525/    1D4D : 28 09               	jr	z, add_ix_
    5526/    1D4F : FE 0F               	cp	15
    5527/    1D51 : C2 6D 1A            	jp	nz, asm_err
    5528/    1D54 :                     ;;
    5529/    1D54 :                     ;;
    5530/    1D54 :                     add_iy_:
    5531/    1D54 : 0E FD               	ld	c, 0FDh
    5532/    1D56 : 18 02               	jr	el3_211
    5533/    1D58 :                     ;;
    5534/    1D58 :                     ;;
    5535/    1D58 :                     add_ix_:
    5536/    1D58 : 0E DD               	ld	c, 0DDh
    5537/    1D5A :                     el3_211:
    5538/    1D5A : 78                  	ld	a, b
    5539/    1D5B : FE 05               	cp	5
    5540/    1D5D : 28 19               	jr	z, add_xy_bc
    5541/    1D5F : FE 08               	cp	8
    5542/    1D61 : 28 19               	jr	z, add_xy_de
    5543/    1D63 : FE 0E               	cp	14
    5544/    1D65 : 28 19               	jr	z, add_ix_ix
    5545/    1D67 : FE 0F               	cp	15
    5546/    1D69 : CA 8A 1D            	jp	z, add_iy_iy
    5547/    1D6C : FE 10               	cp	16
    5548/    1D6E : C2 6D 1A            	jp	nz, asm_err
    5549/    1D71 :                     add_xy_sp:
    5550/    1D71 : 3E 39               	ld	a, 39h
    5551/    1D73 :                     el3_212:
    5552/    1D73 : F5                  	push	af		; adjust I/F
    5553/    1D74 : 79                  	ld	a, c
    5554/    1D75 : C3 07 22            	jp	el2_441
    5555/    1D78 :                     
    5556/    1D78 :                     add_xy_bc:
    5557/    1D78 : 3E 09               	ld	a, 9h
    5558/    1D7A : 18 F7               	jr	el3_212
    5559/    1D7C :                     add_xy_de:
    5560/    1D7C : 3E 19               	ld	a, 19h
    5561/    1D7E : 18 F3               	jr	el3_212
    5562/    1D80 :                     add_ix_ix:
    5563/    1D80 : 79                  	ld	a, c
    5564/    1D81 : FE DD               	cp	0ddh
    5565/    1D83 : C2 6D 1A            	jp	nz, asm_err
    5566/    1D86 :                     add_xy_xy:
    5567/    1D86 : 3E 29               	ld	a, 29h
    5568/    1D88 : 18 E9               	jr	el3_212
    5569/    1D8A :                     add_iy_iy:
    5570/    1D8A : 79                  	ld	a, c
    5571/    1D8B : FE FD               	cp	0fdh
    5572/    1D8D : C2 6D 1A            	jp	nz, asm_err
    5573/    1D90 : 18 F4               	jr	add_xy_xy
    5574/    1D92 :                     
    5575/    1D92 :                     ;;
    5576/    1D92 :                     ;;
    5577/    1D92 :                     add_hl_:
    5578/    1D92 : 78                  	ld	a, b
    5579/    1D93 : FE 05               	cp	5
    5580/    1D95 : 28 12               	jr	z, add_hl_bc
    5581/    1D97 : FE 08               	cp	8
    5582/    1D99 : 28 13               	jr	z, add_hl_de
    5583/    1D9B : FE 0B               	cp	11
    5584/    1D9D : 28 14               	jr	z, add_hl_hl
    5585/    1D9F : FE 10               	cp	16
    5586/    1DA1 : C2 6D 1A            	jp	nz, asm_err
    5587/    1DA4 :                     add_hl_sp:
    5588/    1DA4 : 3E 39               	ld	a, 39h
    5589/    1DA6 : C3 0B 1D            	jp	adc_a_x
    5590/    1DA9 :                     add_hl_bc:
    5591/    1DA9 : 3E 09               	ld	a, 09h
    5592/    1DAB : C3 0B 1D            	jp	adc_a_x
    5593/    1DAE :                     add_hl_de:
    5594/    1DAE : 3E 19               	ld	a, 19h
    5595/    1DB0 : C3 0B 1D            	jp	adc_a_x
    5596/    1DB3 :                     add_hl_hl:
    5597/    1DB3 : 3E 29               	ld	a, 29h
    5598/    1DB5 : C3 0B 1D            	jp	adc_a_x
    5599/    1DB8 :                     
    5600/    1DB8 :                     ;
    5601/    1DB8 :                     ; EX section
    5602/    1DB8 :                     ;
    5603/    1DB8 :                     
    5604/    1DB8 :                     el3_6:  ; EX   ( normal, DD, FD )
    5605/    1DB8 :                     
    5606/    1DB8 : 3A 6C EF            	ld	a, (opr2_cd)
    5607/    1DBB : 47                  	ld	b, a
    5608/    1DBC : 3A 6B EF            	ld	a, (opr1_cd)
    5609/    1DBF : FE 02               	cp	2
    5610/    1DC1 : 28 26               	jr	z, ex_af_
    5611/    1DC3 : FE 08               	cp	8
    5612/    1DC5 : 28 2C               	jr	z, ex_de_
    5613/    1DC7 : FE 20               	cp	32
    5614/    1DC9 : C2 6D 1A            	jp	nz, asm_err
    5615/    1DCC :                     
    5616/    1DCC :                     ; ex (sp),
    5617/    1DCC : 78                  	ld	a, b
    5618/    1DCD : 1E E3               	ld	e, 0E3h
    5619/    1DCF :                     
    5620/    1DCF : FE 0B               	cp	11		; hl
    5621/    1DD1 : 28 13               	jr	z, ex_sp_hl
    5622/    1DD3 : FE 0E               	cp	14
    5623/    1DD5 : 16 DD               	ld	d, 0ddh
    5624/    1DD7 : 28 07               	jr	z, ex_sp_ix
    5625/    1DD9 : FE 0F               	cp	15
    5626/    1DDB : C2 6D 1A            	jp	nz, asm_err
    5627/    1DDE : 16 FD               	ld	d, 0fdh
    5628/    1DE0 :                     ex_sp_ix:
    5629/    1DE0 : 7B                  	ld	a, e
    5630/    1DE1 : F5                  	push	af		; adjust I/F
    5631/    1DE2 : 7A                  	ld	a, d
    5632/    1DE3 : C3 07 22            	jp	el2_441
    5633/    1DE6 :                     
    5634/    1DE6 :                     ex_sp_hl:
    5635/    1DE6 : 7B                  	ld	a, e
    5636/    1DE7 : 18 12               	jr	el3_61
    5637/    1DE9 :                     
    5638/    1DE9 :                     ex_af_:
    5639/    1DE9 : 78                  	ld	a, b
    5640/    1DEA : FE 03               	cp	3
    5641/    1DEC : C2 6D 1A            	jp	nz, asm_err
    5642/    1DEF : 3E 08               	ld	a, 08h		; 1st MC
    5643/    1DF1 : 18 08               	jr	el3_61
    5644/    1DF3 :                     
    5645/    1DF3 :                     ex_de_:
    5646/    1DF3 : 78                  	ld	a, b
    5647/    1DF4 : FE 0B               	cp	11		; hl
    5648/    1DF6 : C2 6D 1A            	jp	nz, asm_err
    5649/    1DF9 : 3E EB               	ld	a, 0ebh		; 1st MC
    5650/    1DFB :                     el3_61:
    5651/    1DFB : C3 D9 20            	jp	st_mc11
    5652/    1DFE :                     
    5653/    1DFE :                     ;
    5654/    1DFE :                     ; LD section
    5655/    1DFE :                     ;
    5656/    1DFE :                     
    5657/    1DFE :                     ; ld_en1 = 7 (1, 4, 6, 7, 9, 10, 12)
    5658/    1DFE :                     ; ld_en2 = 5 (5, 8, 11, 14, 15)
    5659/    1DFE :                     ; ld_en3 = 4 (33, 36, 34, 37 )
    5660/    1DFE :                     ; ld_en4 =  7 (13, 16, 17, 26, 27, 28, 35)
    5661/    1DFE : =7H                 ld_en1		equ	ld_e2_tbl1 - ld_e2_tbl
    5662/    1DFE : =5H                 ld_en2		equ	ld_e2_tbl2 - ld_e2_tbl1
    5663/    1DFE : =4H                 ld_en3		equ	ld_e2_tbl3 - ld_e2_tbl2
    5664/    1DFE : =7H                 ld_en4		equ	ld_e2_tble - ld_e2_tbl3
    5665/    1DFE :                     
    5666/    1DFE : 01                  ld_e2_tbl:	db	1
    5667/    1DFF : 04 06 07 09 0A 0C   in_selt:	db	4, 6, 7, 9, 10, 12
    5668/    1E05 : 05 08 0B 0E 0F      ld_e2_tbl1:	db	5, 8, 11, 14, 15
    5669/    1E0A : 21 24 22 25         ld_e2_tbl2:	db	33, 36, 34, 37
    5670/    1E0E : 0D                  ld_e2_tbl3:	db	13
    5671/    1E0F : 10                  		db	16
    5672/    1E10 : 11                  		db	17
    5673/    1E11 : 1A                  		db	26
    5674/    1E12 : 1B                  		db	27
    5675/    1E13 : 1C                  		db	28
    5676/    1E14 : 23                  		db	35
    5677/    1E15 :                     ld_e2_tble:
    5678/    1E15 :                     
    5679/    1E15 : =0DH                rhlnnxy		equ	r_hl_nne - r_hl_nn
    5680/    1E15 : =8H                 ld_rrn		equ	ld_rr_ -  r_hl_nn
    5681/    1E15 : =0AH                ld_rxyn_sp	equ	lda_spe - ld_rr_
    5682/    1E15 :                     
    5683/    1E15 : =5H                 m_num		equ	r_hl_nne - ld_rr_	; except No.0 - 4  (IX+,IY+,IX-,IY-,nn)
    5684/    1E15 :                     
    5685/    1E15 : 01 04 06 07 09 0A   r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
             1E1B : 0C 1C             
    5686/    1E1D : 19                  ld_rr_:		db	25
    5687/    1E1E : 21 24 22 25         ex_sr_:		db	33, 36, 34, 37
    5688/    1E22 :                     r_hl_nne:
    5689/    1E22 : 1A                  lda_sp:		db	26 ; LD A (BC)
    5690/    1E23 : 1B                  		db	27 ; LD A (DE)
    5691/    1E24 : 0D                  		db	13 ; LD A I
    5692/    1E25 : 11                  		db	17 ; LD A R
    5693/    1E26 : 23                  		db	35 ; LD A (1234H)
    5694/    1E27 :                     lda_spe:
    5695/    1E27 :                     
    5696/    1E27 : 68                  ld1_base:	db	68h	; L
    5697/    1E28 : 60                  		db	60h	; H
    5698/    1E29 : 58                  		db	58h	; E
    5699/    1E2A : 50                  		db	50h	; D
    5700/    1E2B : 48                  		db	48h	; C
    5701/    1E2C : 40                  		db	40h	; B
    5702/    1E2D : 78                  		db	78h	; A
    5703/    1E2E :                     
    5704/    1E2E : 8A 1E               ld_r_jt:	dw	ld_r35 ; LD A (1234H)
    5705/    1E30 : 9B 1E               		dw	ld_r17 ; LD A R
    5706/    1E32 : A0 1E               		dw	ld_r13 ; LD A I
    5707/    1E34 : A4 1E               		dw	ld_r27 ; LD A (DE)
    5708/    1E36 : A9 1E               		dw	ld_r26 ; LD A (BC)
    5709/    1E38 : AE 1E               		dw	ld_r37
    5710/    1E3A : BC 1E               		dw	ld_r34
    5711/    1E3C : C1 1E               		dw	ld_r36
    5712/    1E3E : C9 1E               		dw	ld_r33
    5713/    1E40 : CE 1E               		dw	ld_r25
    5714/    1E42 :                     
    5715/    1E42 :                     ; LD XXXX, XXXX
    5716/    1E42 :                     el3_1:
    5717/    1E42 : 3A 6B EF            	ld	a, (opr1_cd)
    5718/    1E45 : 21 FE 1D            	ld	hl, ld_e2_tbl
    5719/    1E48 : 01 07 00            	ld	bc, ld_en1
    5720/    1E4B : ED B1               	cpir
    5721/    1E4D : C2 E0 1E            	jp	nz, el3_11
    5722/    1E50 :                     	
    5723/    1E50 : 21 27 1E            	ld	hl, ld1_base
    5724/    1E53 : 09                  	add	hl, bc
    5725/    1E54 : 56                  	ld	d, (hl)		; met MC base code
    5726/    1E55 :                     
    5727/    1E55 : 3A 6C EF            	ld	a, (opr2_cd)
    5728/    1E58 : 21 15 1E            	ld	hl, r_hl_nn
    5729/    1E5B : 01 08 00            	ld	bc, ld_rrn
    5730/    1E5E : ED B1               	cpir
    5731/    1E60 : 20 0C               	jr	nz, el3_125
    5732/    1E62 :                     	
    5733/    1E62 : 79                  	ld	a, c
    5734/    1E63 : FE 07               	cp	7		; A param?
    5735/    1E65 : 28 03               	jr	z, el3_12
    5736/    1E67 : 3E 06               	ld	a, 6
    5737/    1E69 : 91                  	sub	c		; make B, C, D, E, H, L, (HL) param
    5738/    1E6A :                     el3_12:
    5739/    1E6A : B2                  	or	d		; make MC
    5740/    1E6B : C3 D9 20            	jp	st_mc11	
    5741/    1E6E :                     
    5742/    1E6E :                     
    5743/    1E6E :                     el3_125:
    5744/    1E6E : 21 1D 1E            	ld	hl, ld_rr_
    5745/    1E71 : 01 0A 00            	ld	bc, ld_rxyn_sp
    5746/    1E74 : ED B1               	cpir
    5747/    1E76 : C2 6D 1A            	jp	nz, asm_err
    5748/    1E79 :                     
    5749/    1E79 : 79                  	ld	a, c
    5750/    1E7A : FE 05               	cp	5		; check LD A, special
    5751/    1E7C : 30 06               	jr	nc, el3_126
    5752/    1E7E :                     
    5753/    1E7E : 7A                  	ld	a, d
    5754/    1E7F : FE 78               	cp	78h		; LD A ?
    5755/    1E81 : C2 6D 1A            	jp	nz, asm_err	; err, if B, C, D, E, H, L, (HL)
    5756/    1E84 :                     
    5757/    1E84 :                     el3_126:
    5758/    1E84 : 21 2E 1E            	ld	hl, ld_r_jt
    5759/    1E87 : C3 0F 1B            	jp	jp_each
    5760/    1E8A :                     
    5761/    1E8A :                     ld_r35: ; LD A,(1234H)
    5762/    1E8A : 3E 3A               	ld	a, 3ah		; 1st MC
    5763/    1E8C :                     
    5764/    1E8C : 2A 66 EF            	ld	hl, (tasm_adr)
    5765/    1E8F : 77                  	ld	(hl), a
    5766/    1E90 : 23                  	inc	hl
    5767/    1E91 : ED 5B 6F EF         	ld	de, (opr_num35)
    5768/    1E95 : 73                  	ld	(hl), e
    5769/    1E96 : 23                  	inc	hl
    5770/    1E97 : 72                  	ld	(hl), d
    5771/    1E98 : C3 F1 21            	jp	mc_end3
    5772/    1E9B :                     
    5773/    1E9B :                     ld_r17: ; LD A,R
    5774/    1E9B : 3E 5F               	ld	a, 5fh
    5775/    1E9D :                     ld_r171:
    5776/    1E9D : C3 3F 24            	jp	el2_5411
    5777/    1EA0 :                     	
    5778/    1EA0 :                     ld_r13: ; LD A,I
    5779/    1EA0 : 3E 57               	ld	a, 57h
    5780/    1EA2 : 18 F9               	jr	ld_r171
    5781/    1EA4 :                     
    5782/    1EA4 :                     ld_r27: ; LD A,(DE)
    5783/    1EA4 : 3E 1A               	ld	a, 1ah
    5784/    1EA6 : C3 D9 20            	jp	st_mc11
    5785/    1EA9 :                     	
    5786/    1EA9 :                     ld_r26: ; LD A,(BC)
    5787/    1EA9 : 3E 0A               	ld	a, 0ah
    5788/    1EAB : C3 D9 20            	jp	st_mc11
    5789/    1EAE :                     
    5790/    1EAE :                     ld_r37:	; LD r,(IY-nn)
    5791/    1EAE : 3A 71 EF            	ld	a, (opr_num37)
    5792/    1EB1 :                     ld_r371:
    5793/    1EB1 : 4F                  	ld	c, a
    5794/    1EB2 : 1E FD               	ld	e, 0FDH
    5795/    1EB4 :                     ld_r372:
    5796/    1EB4 : 3E 06               	ld	a, 6
    5797/    1EB6 : B2                  	or	d		; make 2nd MC
    5798/    1EB7 : 57                  	ld	d, a		; adjust I/F
    5799/    1EB8 : 7B                  	ld	a, e		; adjust I/F
    5800/    1EB9 : C3 FC 22            	jp	cp_xy1
    5801/    1EBC :                     
    5802/    1EBC :                     ld_r34: ; LD r,(IY+nn)
    5803/    1EBC : 3A 72 EF            	ld	a, (opr_num34)
    5804/    1EBF : 18 F0               	jr	ld_r371
    5805/    1EC1 :                     
    5806/    1EC1 :                     ld_r36: ; LD r,(IX-nn)
    5807/    1EC1 : 3A 73 EF            	ld	a, (opr_num36)
    5808/    1EC4 :                     ld_r361:
    5809/    1EC4 : 4F                  	ld	c, a
    5810/    1EC5 : 1E DD               	ld	e, 0DDH
    5811/    1EC7 : 18 EB               	jr	ld_r372
    5812/    1EC9 :                     
    5813/    1EC9 :                     ld_r33: ; LD r,(IX+nn)
    5814/    1EC9 : 3A 74 EF            	ld	a, (opr_num33)
    5815/    1ECC : 18 F6               	jr	ld_r361
    5816/    1ECE :                     
    5817/    1ECE :                     ld_r25: ; LD r, nn
    5818/    1ECE : 7A                  	ld	a, d		; get 1st MC base
    5819/    1ECF : D6 3A               	sub	3ah		; get 1st MC
    5820/    1ED1 : 57                  	ld	d, a
    5821/    1ED2 :                     
    5822/    1ED2 :                     ld_r251:
    5823/    1ED2 : 2A 6D EF            	ld	hl, (opr_num25)
    5824/    1ED5 : 7C                  	ld	a, h
    5825/    1ED6 : B7                  	or	a
    5826/    1ED7 : C2 6D 1A            	jp	nz, asm_err
    5827/    1EDA : 7D                  	ld	a, l
    5828/    1EDB : F5                  	push	af		; adjust I/F
    5829/    1EDC : 7A                  	ld	a, d		; adjust I/F
    5830/    1EDD : C3 07 22            	jp	el2_441
    5831/    1EE0 :                     
    5832/    1EE0 :                     ;
    5833/    1EE0 :                     ; LD rp16, nnnn
    5834/    1EE0 :                     ; LD rp16, (nnnn)
    5835/    1EE0 :                     ; rp16 : BC, DE, HL, IX, IY
    5836/    1EE0 :                     ; ld_e2_tbl1:	db	5, 8, 11, 14, 15
    5837/    1EE0 :                     
    5838/    1EE0 :                     el3_11:
    5839/    1EE0 :                     ;	hl = ld_e2_tbl1
    5840/    1EE0 : 01 05 00            	ld	bc, ld_en2
    5841/    1EE3 : ED B1               	cpir
    5842/    1EE5 : 20 74               	jr	nz, el3_1_2
    5843/    1EE7 : 79                  	ld	a, c
    5844/    1EE8 : B7                  	or	a
    5845/    1EE9 : 28 6C               	jr	z, ld_iy_n4
    5846/    1EEB : FE 01               	cp	1
    5847/    1EED : 28 4E               	jr	z, ld_ix_n4
    5848/    1EEF : FE 02               	cp	2
    5849/    1EF1 : 28 35               	jr	z, ld_hl_n4
    5850/    1EF3 : FE 03               	cp	3
    5851/    1EF5 : 28 29               	jr	z, ld_de_n4
    5852/    1EF7 :                     
    5853/    1EF7 :                     
    5854/    1EF7 :                     ; LD BC, nnnn; LD BC, (nnnn)
    5855/    1EF7 :                     ld_bc_n4:
    5856/    1EF7 : 16 ED               	ld	d, 0EDH		; 1st MC
    5857/    1EF9 : 1E 4B               	ld	e, 4bh		; 2nd MC
    5858/    1EFB : 0E 01               	ld	c, 1		; 1st MC
    5859/    1EFD :                     
    5860/    1EFD :                     ld_bc_n40:
    5861/    1EFD : 3A 6C EF            	ld	a, (opr2_cd)
    5862/    1F00 : FE 19               	cp	25
    5863/    1F02 : 28 0A               	jr	z, ld_bc_n41
    5864/    1F04 :                     
    5865/    1F04 : 7B                  	ld	a, e		; 2nd MC
    5866/    1F05 : 21 6F EF            	ld	hl, opr_num35
    5867/    1F08 : 4E                  	ld	c, (hl)		; 3rd MC
    5868/    1F09 : 23                  	inc	hl
    5869/    1F0A : 5E                  	ld	e, (hl)		; 4th MC
    5870/    1F0B : C3 14 24            	jp	mc_end41
    5871/    1F0E :                     
    5872/    1F0E :                     ld_bc_n41:
    5873/    1F0E : 21 6D EF            	ld	hl, opr_num25
    5874/    1F11 : 5E                  	ld	e, (hl)		; 2rd MC
    5875/    1F12 : 23                  	inc	hl
    5876/    1F13 : 56                  	ld	d, (hl)		; 3rd MC
    5877/    1F14 : 79                  	ld	a, c		; 1st MC
    5878/    1F15 :                     
    5879/    1F15 :                     ld_bc_n42:
    5880/    1F15 : 2A 66 EF            	ld	hl, (tasm_adr)
    5881/    1F18 : 71                  	ld	(hl), c		; save 1st MC
    5882/    1F19 : 23                  	inc	hl
    5883/    1F1A : 73                  	ld	(hl), e
    5884/    1F1B : 23                  	inc	hl
    5885/    1F1C : 72                  	ld	(hl), d
    5886/    1F1D : C3 F1 21            	jp	mc_end3
    5887/    1F20 :                     	
    5888/    1F20 :                     ; LD DE, nnnn; LD DE, (nnnn)
    5889/    1F20 :                     ld_de_n4:
    5890/    1F20 : 16 ED               	ld	d, 0EDH		; 1st MC
    5891/    1F22 : 1E 5B               	ld	e, 5bh		; 2nd MC
    5892/    1F24 : 0E 11               	ld	c, 11h		; 1st MC
    5893/    1F26 : 18 D5               	jr	ld_bc_n40
    5894/    1F28 :                     
    5895/    1F28 :                     ; LD HL, nnnn; LD HL, (nnnn)
    5896/    1F28 :                     ld_hl_n4:
    5897/    1F28 : 0E 21               	ld	c, 21h
    5898/    1F2A : ED 5B 6D EF         	ld	de, (opr_num25)
    5899/    1F2E : 3A 6C EF            	ld	a, (opr2_cd)
    5900/    1F31 : FE 19               	cp	25
    5901/    1F33 : 28 E0               	jr	z, ld_bc_n42
    5902/    1F35 : 0E 2A               	ld	c, 2Ah
    5903/    1F37 : ED 5B 6F EF         	ld	de, (opr_num35)
    5904/    1F3B : 18 D8               	jr	ld_bc_n42
    5905/    1F3D :                     
    5906/    1F3D :                     ; LD IX, nnnn; LD IX, (nnnn)
    5907/    1F3D :                     ld_ix_n4:
    5908/    1F3D : 16 DD               	ld	d, 0DDh		; 1st MC
    5909/    1F3F :                     
    5910/    1F3F :                     ld_ix_n40:
    5911/    1F3F : 0E 21               	ld	c, 21h
    5912/    1F41 : 21 6D EF            	ld	hl, opr_num25
    5913/    1F44 :                     
    5914/    1F44 : 3A 6C EF            	ld	a, (opr2_cd)
    5915/    1F47 : FE 19               	cp	25
    5916/    1F49 : 28 05               	jr	z, ld_ix_n42
    5917/    1F4B :                     
    5918/    1F4B : 0E 2A               	ld	c, 2Ah
    5919/    1F4D : 21 6F EF            	ld	hl, opr_num35
    5920/    1F50 :                     
    5921/    1F50 :                     ld_ix_n42:
    5922/    1F50 : 79                  	ld	a, c		; 2nd MC
    5923/    1F51 : 4E                  	ld	c, (hl)		; 3rd MC
    5924/    1F52 : 23                  	inc	hl
    5925/    1F53 : 5E                  	ld	e, (hl)		; 4th MC
    5926/    1F54 : C3 14 24            	jp	mc_end41
    5927/    1F57 :                     
    5928/    1F57 :                     ; LD IY, nnnn; LD IY, (nnnn)
    5929/    1F57 :                     ld_iy_n4:
    5930/    1F57 : 16 FD               	ld	d, 0FDh		; 1st MC
    5931/    1F59 : 18 E4               	jr	ld_ix_n40
    5932/    1F5B :                     
    5933/    1F5B :                     ;
    5934/    1F5B :                     ; LD ([IX|IY][+|-]nn), [r|nn]
    5935/    1F5B :                     ;
    5936/    1F5B :                     ;ld_e2_tbl2:	db	33, 36, 34, 37
    5937/    1F5B :                     ; LD (IX | IY +|- nn), r | nn
    5938/    1F5B :                     el3_1_2:
    5939/    1F5B :                     ;	hl = ld_e2_tbl2
    5940/    1F5B : 01 04 00            	ld	bc, ld_en3
    5941/    1F5E : ED B1               	cpir
    5942/    1F60 : 20 3F               	jr	nz, el3_13
    5943/    1F62 :                     	
    5944/    1F62 : 21 71 EF            	ld	hl, opr_num37
    5945/    1F65 : 09                  	add	hl, bc
    5946/    1F66 : 56                  	ld	d, (hl)		; get 3rd MC
    5947/    1F67 :                     
    5948/    1F67 : 79                  	ld	a, c
    5949/    1F68 : 1E FD               	ld	e, 0FDh		; 1st MC
    5950/    1F6A : FE 02               	cp	2
    5951/    1F6C : 38 02               	jr	c, el3_121
    5952/    1F6E : 1E DD               	ld	e, 0DDh		; 1st MC
    5953/    1F70 :                     
    5954/    1F70 :                     ; reg_A = (opr2_cd)
    5955/    1F70 :                     ; if (reg_A = 25) 2nd_MC = 36h
    5956/    1F70 :                     ; else {
    5957/    1F70 :                     ;     if (Reg_C = 6) 2nd_MC =77h
    5958/    1F70 :                     ;     else 2nd_MC = 75h - reg_C
    5959/    1F70 :                     ; }
    5960/    1F70 :                     el3_121: ; check element No.3
    5961/    1F70 : 3A 6C EF            	ld	a, (opr2_cd)
    5962/    1F73 : FE 19               	cp	25
    5963/    1F75 : 28 1A               	jr	z, ld_xynln
    5964/    1F77 :                     
    5965/    1F77 : 21 FE 1D            	ld	hl, ld_e2_tbl
    5966/    1F7A : 01 07 00            	ld	bc, ld_en1
    5967/    1F7D : ED B1               	cpir
    5968/    1F7F : C2 6D 1A            	jp	nz, asm_err
    5969/    1F82 :                     
    5970/    1F82 : 79                  	ld	a, c
    5971/    1F83 : FE 06               	cp	6
    5972/    1F85 : 3E 77               	ld	a, 077h		; a : 2nd MC
    5973/    1F87 : 28 03               	jr	z, mc2_77
    5974/    1F89 :                     
    5975/    1F89 : 3E 75               	ld	a, 75h
    5976/    1F8B : 91                  	sub	c	; a : 2nd MC
    5977/    1F8C :                     
    5978/    1F8C :                      ; adjust 1: c, 2: e, 3: d
    5979/    1F8C :                     mc2_77:
    5980/    1F8C : 4B                  	ld	c, e		; adjust I/F
    5981/    1F8D : 5F                  	ld	e, a		; adjust I/F
    5982/    1F8E : C3 15 1F            	jp	ld_bc_n42
    5983/    1F91 :                     
    5984/    1F91 :                     ld_xynln: ; 4byte MC 
    5985/    1F91 :                     	  ; LD ([IX|IY] [+|-]), nn
    5986/    1F91 :                     	  ; 2nd MC = 36h
    5987/    1F91 :                     
    5988/    1F91 : 2A 6D EF            	ld	hl, (opr_num25)
    5989/    1F94 : 7C                  	ld	a, h
    5990/    1F95 : B7                  	or	a
    5991/    1F96 : C2 6D 1A            	jp	nz, asm_err
    5992/    1F99 :                     
    5993/    1F99 :                     ; adjust I/F
    5994/    1F99 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    5995/    1F99 :                     
    5996/    1F99 : 3E 36               	ld	a, 36h		; 2nd MC
    5997/    1F9B : 4A                  	ld	c, d		; 3rd MC
    5998/    1F9C : 53                  	ld	d, e		; 1st MC
    5999/    1F9D : 5D                  	ld	e, l		; 4th MC
    6000/    1F9E : C3 14 24            	jp	mc_end41
    6001/    1FA1 :                     
    6002/    1FA1 :                     ;
    6003/    1FA1 :                     ; 35 : ld (nnnn), reg
    6004/    1FA1 :                     ; 28 : ld (hl), r | nn
    6005/    1FA1 :                     ; 16 : ld SP, hl | ix | iy | nnnn | (nnnn)
    6006/    1FA1 :                     ; 27 : LD (DE), A
    6007/    1FA1 :                     ; 26 : LD (BC), A
    6008/    1FA1 :                     ; 17 : LD R, A
    6009/    1FA1 :                     ; 13 : LD I, A
    6010/    1FA1 :                     ;
    6011/    1FA1 :                     el3_13:
    6012/    1FA1 :                     ;	hl = ld_e2_tbl3
    6013/    1FA1 : 01 07 00            	ld	bc, ld_en4
    6014/    1FA4 : ED B1               	cpir
    6015/    1FA6 : C2 6D 1A            	jp	nz, asm_err
    6016/    1FA9 : 21 AF 1F            	ld	hl, el3_14
    6017/    1FAC : C3 0F 1B            	jp	jp_each
    6018/    1FAF :                     
    6019/    1FAF :                     ; jump table
    6020/    1FAF : CB 1F               el3_14:		dw	el3_s35
    6021/    1FB1 : 00 20               		dw	el3_s28
    6022/    1FB3 : 6D 20               		dw	el3_s27
    6023/    1FB5 : 71 20               		dw	el3_s26
    6024/    1FB7 : 76 20               		dw	el3_s17
    6025/    1FB9 : 2F 20               		dw	el3_s16
    6026/    1FBB : 7B 20               		dw	el3_s13
    6027/    1FBD :                     
    6028/    1FBD : =7H                 ldnr_n	equ	ldnr_c - ldnr_t
    6029/    1FBD :                     
    6030/    1FBD : 01 0B 05 08 10 0E   ldnr_t:		db	1, 11, 5, 8, 16, 14, 15
             1FC3 : 0F                
    6031/    1FC4 : 22 22 73 53 43 22   ldnr_c:		db	22h, 22h, 73h, 53h, 43h, 22h, 32h
             1FCA : 32                
    6032/    1FCB :                     
    6033/    1FCB :                     el3_s35: ; ld (nnnn), reg
    6034/    1FCB :                     
    6035/    1FCB : 3A 6C EF            	ld	a, (opr2_cd)
    6036/    1FCE :                     
    6037/    1FCE : 21 BD 1F            	ld	hl, ldnr_t
    6038/    1FD1 : 01 07 00            	ld	bc, ldnr_n
    6039/    1FD4 : ED B1               	cpir
    6040/    1FD6 : C2 6D 1A            	jp	nz, asm_err
    6041/    1FD9 :                     
    6042/    1FD9 : 21 C4 1F            	ld	hl, ldnr_c
    6043/    1FDC : 09                  	add	hl, bc
    6044/    1FDD : 79                  	ld	a, c
    6045/    1FDE : 4E                  	ld	c, (hl)		; 1st MC
    6046/    1FDF :                     
    6047/    1FDF : 2A 6F EF            	ld	hl, (opr_num35)
    6048/    1FE2 : FE 05               	cp	5
    6049/    1FE4 : 38 05               	jr	c, el3_s351
    6050/    1FE6 :                     
    6051/    1FE6 :                      ; adjust 1: c, 2: e, 3: d
    6052/    1FE6 :                     
    6053/    1FE6 : 5D                  	ld	e, l			; 2nd MC
    6054/    1FE7 : 54                  	ld	d, h			; 3rd MC
    6055/    1FE8 : C3 15 1F            	jp	ld_bc_n42
    6056/    1FEB :                     
    6057/    1FEB :                     el3_s351:
    6058/    1FEB : FE 02               	cp	2
    6059/    1FED : 38 08               	jr	c, el3_s352
    6060/    1FEF :                      ; ED
    6061/    1FEF :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6062/    1FEF :                     
    6063/    1FEF : 16 ED               	ld	d, 0EDH			; 1st MC
    6064/    1FF1 :                     el3_s353:
    6065/    1FF1 : 79                  	ld	a, c			; 2nd MC
    6066/    1FF2 : 4D                  	ld	c, l			; 3rd MC
    6067/    1FF3 : 5C                  	ld	e, h			; 4th mc
    6068/    1FF4 : C3 14 24            	jp	mc_end41
    6069/    1FF7 :                     
    6070/    1FF7 :                     el3_s352: ; DD, FD
    6071/    1FF7 : 16 FD               	ld	d, 0FDh			; 1st MC
    6072/    1FF9 : B7                  	or	a
    6073/    1FFA : 28 F5               	jr	z, el3_s353
    6074/    1FFC : 16 DD               	ld	d, 0DDh			; 1st MC
    6075/    1FFE : 18 F1               	jr	el3_s353
    6076/    2000 :                     
    6077/    2000 :                     ; ld (hl), r | nn
    6078/    2000 :                     el3_s28:
    6079/    2000 : 3A 6C EF            	ld	a, (opr2_cd)
    6080/    2003 : FE 19               	cp	25
    6081/    2005 : 28 19               	jr	z, el3_s281
    6082/    2007 : FE 01               	cp	1
    6083/    2009 : 28 11               	jr	z, el3_s282
    6084/    200B : 21 FF 1D            	ld	hl, ld_e2_tbl + 1
    6085/    200E : 01 06 00            	ld	bc, ld_en1 - 1
    6086/    2011 : ED B1               	cpir
    6087/    2013 : C2 6D 1A            	jp	nz, asm_err
    6088/    2016 : 3E 75               	ld	a, 75h
    6089/    2018 : 91                  	sub	c
    6090/    2019 :                     el3_s283:
    6091/    2019 : C3 D9 20            	jp	st_mc11
    6092/    201C :                     
    6093/    201C :                     el3_s282: ; LD (HL), A
    6094/    201C : 3E 77               	ld	a, 77h
    6095/    201E : 18 F9               	jr	el3_s283
    6096/    2020 :                     
    6097/    2020 :                     el3_s281: ; LD (HL), nn
    6098/    2020 : 2A 6D EF            	ld	hl, (opr_num25)
    6099/    2023 : 7C                  	ld	a, h
    6100/    2024 : B7                  	or	a
    6101/    2025 : C2 6D 1A            	jp	nz, asm_err
    6102/    2028 :                     
    6103/    2028 : 7D                  	ld	a, l
    6104/    2029 : F5                  	push	af		; adjust I/F
    6105/    202A : 3E 36               	ld	a, 36h		; 1st MC
    6106/    202C : C3 07 22            	jp	el2_441
    6107/    202F :                     
    6108/    202F :                     el3_s16: ; ld SP, hl | ix | iy | nnnn | (nnnn)
    6109/    202F :                     
    6110/    202F : 3A 6C EF            	ld	a, (opr2_cd)
    6111/    2032 : FE 0B               	cp	11
    6112/    2034 : 28 1D               	jr	z, el3_s161
    6113/    2036 : FE 0E               	cp	14
    6114/    2038 : 28 1D               	jr	z, el3_s162
    6115/    203A : FE 0F               	cp	15
    6116/    203C : 28 1D               	jr	z, el3_s163
    6117/    203E : FE 19               	cp	25
    6118/    2040 : 28 22               	jr	z, el3_s164
    6119/    2042 : FE 23               	cp	35
    6120/    2044 : C2 6D 1A            	jp	nz, asm_err
    6121/    2047 :                     
    6122/    2047 :                     ; LD SP, (nnnn)
    6123/    2047 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6124/    2047 :                     
    6125/    2047 : 16 ED               	ld	d, 0edh		; 1st MC
    6126/    2049 : 3E 7B               	ld	a, 7bh		; 2nd MC
    6127/    204B : 2A 6F EF            	ld	hl, (opr_num35)
    6128/    204E : 4D                  	ld	c, l		; 3rd MC
    6129/    204F : 5C                  	ld	e, h		; 4th MC
    6130/    2050 : C3 14 24            	jp	mc_end41
    6131/    2053 :                     	
    6132/    2053 :                     
    6133/    2053 :                     el3_s161: ; LD SP, HL
    6134/    2053 : 3E F9               	ld	a, 0f9h
    6135/    2055 : 18 1C               	jr	el3_s261
    6136/    2057 :                     
    6137/    2057 :                     el3_s162: ; LD SP, IX
    6138/    2057 : 16 DD               	ld	d, 0DDh
    6139/    2059 : 18 02               	jr	el3_s1631
    6140/    205B :                     	
    6141/    205B :                     el3_s163: ; LD SP, IY
    6142/    205B : 16 FD               	ld	d, 0FDh
    6143/    205D :                     el3_s1631:
    6144/    205D : 3E F9               	ld	a, 0f9h
    6145/    205F : F5                  	push	af		; adjust I/F
    6146/    2060 : 7A                  	ld	a, d
    6147/    2061 : C3 07 22            	jp	el2_441
    6148/    2064 :                     
    6149/    2064 :                     el3_s164: ; LD SP, nnnn
    6150/    2064 :                     ; adjust 1: c, 2: e, 3: d
    6151/    2064 :                     
    6152/    2064 : 0E 31               	ld	c, 31h		; 1st MC
    6153/    2066 : ED 5B 6D EF         	ld	de, (opr_num25)	; e: 2nd MC, d: 3rd MC
    6154/    206A : C3 15 1F            	jp	ld_bc_n42
    6155/    206D :                     
    6156/    206D :                     el3_s27: ; LD (DE), A
    6157/    206D : 3E 12               	ld	a, 12h		; set MC
    6158/    206F : 18 02               	jr	el3_s261
    6159/    2071 :                     	
    6160/    2071 :                     el3_s26: ; LD (BC), A
    6161/    2071 : 3E 02               	ld	a, 2h		; set MC
    6162/    2073 :                     el3_s261:
    6163/    2073 : C3 D9 20            	jp	st_mc11
    6164/    2076 :                     	
    6165/    2076 :                     el3_s17: ; LD R, A
    6166/    2076 : 3E 4F               	ld	a, 4fh		; set 2nd MC
    6167/    2078 : C3 3F 24            	jp	el2_5411
    6168/    207B :                     
    6169/    207B :                     el3_s13: ; LD I, A
    6170/    207B : 3E 47               	ld	a, 47h		; set 2nd MC
    6171/    207D : C3 3F 24            	jp	el2_5411
    6172/    2080 :                     
    6173/    2080 :                     ;1111111111111111111111111111111111
    6174/    2080 :                     ;
    6175/    2080 :                     ; element count = 1 
    6176/    2080 :                     ;
    6177/    2080 :                     ;1111111111111111111111111111111111
    6178/    2080 :                     
    6179/    2080 : =0EH                e1s	equ	e1_e - e1_s
    6180/    2080 : =15H                e1s1	equ	e1_e1 - e1_s1
    6181/    2080 :                     
    6182/    2080 :                     e1_s: ;------------------------------------------------
    6183/    2080 : 07 0A 0B 0E 0F 1E   elem1_cd:	db	7, 10, 11, 14, 15, 30, 32
             2086 : 20                
    6184/    2087 : 21 2E 32 33 34 35   		db	33, 46, 50, 51, 52, 53, 65
             208D : 41                
    6185/    208E :                     e1_e: ;------------------------------------------------
    6186/    208E :                     
    6187/    208E : 27 FB F3 76 00 C9   elem1_opcd:	db	27H, 0FBH, 0F3H, 76H, 00H, 0C9H, 37H
             2094 : 37                
    6188/    2095 : 3F 2F 1F 0F 17 07   		db	3FH, 2FH, 1FH, 0FH, 17H, 07H, 0D9H
             209B : D9                
    6189/    209C :                     
    6190/    209C :                     e1_s1: ; ----------------------------------------------
    6191/    209C : 27 28 25 26 3A 3B   elem1_cd1:	db	39, 40, 37, 38, 58, 59, 56
             20A2 : 38                
    6192/    20A3 : 39 04 05 02 03 1F   		db	57, 4,  5,  2,  3,  31, 64
             20A9 : 40                
    6193/    20AA : 3E 3F 3D 2F 30 42   		db	62, 63, 61, 47, 48, 66, 67
             20B0 : 43                
    6194/    20B1 :                     e1_e1: ; ----------------------------------------------
    6195/    20B1 :                     
    6196/    20B1 : 67 6F 45 4D A3 AB   elem1_opcd1:	db	 67h,  6Fh,  45h,  4Dh, 0A3h, 0ABh, 0B3h
             20B7 : B3                
    6197/    20B8 : BB 44 B0 A0 B8 A8   		db	0BBh,  44h, 0B0h, 0A0h, 0B8h, 0A8h, 0B2h
             20BE : B2                
    6198/    20BF : A2 BA AA B1 A1 B9   		db	0A2h, 0BAh, 0AAh, 0B1h, 0A1h, 0B9h, 0A9h
             20C5 : A9                
    6199/    20C6 :                     
    6200/    20C6 :                     ;
    6201/    20C6 :                     ; make machine code,
    6202/    20C6 :                     ; element_cnt = 1 (ex. NOP)
    6203/    20C6 :                     ; output : 1 byte Machine code
    6204/    20C6 :                     ;
    6205/    20C6 :                     mk_e1:	; 1byte MC
    6206/    20C6 : 3A 6A EF            	ld	a, (opc_cd)
    6207/    20C9 : 01 0E 00            	ld	bc, e1s
    6208/    20CC : 21 80 20            	ld	hl, elem1_cd
    6209/    20CF : ED B1               	cpir
    6210/    20D1 : C2 E5 20            	jp	nz, mk_e11
    6211/    20D4 :                     	
    6212/    20D4 : 21 8E 20            	ld	hl, elem1_opcd
    6213/    20D7 :                     
    6214/    20D7 :                     st_mc1:
    6215/    20D7 : 09                  	add	hl, bc
    6216/    20D8 :                     	; get MC
    6217/    20D8 : 7E                  	ld	a, (hl)
    6218/    20D9 :                     st_mc11:
    6219/    20D9 : 2A 66 EF            	ld	hl, (tasm_adr)
    6220/    20DC : 77                  	ld	(hl), a
    6221/    20DD : 3E 01               	ld	a, 1
    6222/    20DF :                     
    6223/    20DF :                     mc_end:
    6224/    20DF : 32 69 EF            	ld	(byte_count), a	; set MC bytes
    6225/    20E2 : C3 7E 1A            	jp	cout_sp
    6226/    20E5 :                     
    6227/    20E5 :                     mk_e11: ; 2byte MC (0EDh, XX)
    6228/    20E5 : 01 15 00            	ld	bc, e1s1
    6229/    20E8 : 21 9C 20            	ld	hl, elem1_cd1
    6230/    20EB : ED B1               	cpir
    6231/    20ED : C2 6D 1A            	jp	nz, asm_err
    6232/    20F0 :                     	
    6233/    20F0 : 2A 66 EF            	ld	hl, (tasm_adr)
    6234/    20F3 : 3E ED               	ld	a, 0EDH
    6235/    20F5 : 77                  	ld	(hl), a		; set MC No.1
    6236/    20F6 : 23                  	inc	hl
    6237/    20F7 : EB                  	ex	de, hl
    6238/    20F8 :                     
    6239/    20F8 : 21 B1 20            	ld	hl, elem1_opcd1
    6240/    20FB : 09                  	add	hl, bc
    6241/    20FC :                     	; get MC
    6242/    20FC : 7E                  	ld	a, (hl)
    6243/    20FD : 12                  	ld	(de), a		; set MC No.2
    6244/    20FE :                     
    6245/    20FE :                     mc_end2:
    6246/    20FE : 3E 02               	ld	a, 2
    6247/    2100 : 18 DD               	jr	mc_end
    6248/    2102 :                     
    6249/    2102 :                     ;2222222222222222222222222222222222222222222222
    6250/    2102 :                     ;
    6251/    2102 :                     ; element count = 2 
    6252/    2102 :                     ;
    6253/    2102 :                     ;2222222222222222222222222222222222222222222222
    6254/    2102 :                     
    6255/    2102 : =1AH                e2s	equ	e2_e - e2_s
    6256/    2102 :                     
    6257/    2102 :                     e2_s:
    6258/    2102 :                     elem2_cd:
    6259/    2102 : 08 09               	db	8, 9			; DD, FD
    6260/    2104 : 17 1A               	db	23, 26			; DD, FD
    6261/    2106 : 18 1B 1C 1D 29      	db	24, 27, 28 ,29, 41	; DD, FD
    6262/    210B : 2A                  	db	42			; DD, FD
    6263/    210C : 2E                  	db	46
    6264/    210D : 31                  	db	49
    6265/    210E : 2B                  	db	43
    6266/    210F : 2C                  	db	44
    6267/    2110 : 2D                  	db	45
    6268/    2111 :                     ; CB
    6269/    2111 : 0C                  	db	12			; DD, FD
    6270/    2112 : 10                  	db	16			; DD, FD
    6271/    2113 : 0D                  	db	13			; DD, FD
    6272/    2114 : 11                  	db	17			; DD, FD
    6273/    2115 : 12                  	db	18			; DD, FD
    6274/    2116 : 13                  	db	19			; DD, FD
    6275/    2117 : 14                  	db	20			; DD, FD
    6276/    2118 :                     ; ED
    6277/    2118 : 36                  	db	54			; ED
    6278/    2119 : 44                  	db	68			; ORG
    6279/    211A : 45                  	db	69			; DB
    6280/    211B : 46                  	db	70			; DW
    6281/    211C :                     e2_e:
    6282/    211C :                     
    6283/    211C :                     ent_el2:
    6284/    211C : 64 21               	dw	el2_70		; DW
    6285/    211E : 79 21               	dw	el2_69		; DB
    6286/    2120 : B2 21               	dw	el2_68		; ORG
    6287/    2122 : 23 24               	dw	el2_54		; IM
    6288/    2124 : BD 23               	dw	el2_20		; SRL
    6289/    2126 : C2 23               	dw	el2_19		; SRA
    6290/    2128 : C7 23               	dw	el2_18		; SLA
    6291/    212A : CC 23               	dw	el2_17		; RR
    6292/    212C : D1 23               	dw	el2_13		; RL
    6293/    212E : D6 23               	dw	el2_16		; RRC
    6294/    2130 : DB 23               	dw	el2_12		; RLC
    6295/    2132 :                     
    6296/    2132 : DB 21               	dw	el2_45		; CALL nnnn
    6297/    2134 : F6 21               	dw	el2_44		; DJNZ e
    6298/    2136 : 11 22               	dw	el2_43		; jR e
    6299/    2138 : 24 22               	dw	el2_49		; RST nn
    6300/    213A : 4E 22               	dw	el2_46		; RET CC
    6301/    213C : 72 22               	dw	el2_42		; JP (HL), JP nnnn
    6302/    213E :                     
    6303/    213E :                     ; code base 0a0h, or 00h, 08h, 10h, 18h
    6304/    213E : AC 22               	dw	el2_41		; CP
    6305/    2140 : B0 22               	dw	el2_29		; XOR
    6306/    2142 : B4 22               	dw	el2_28		; OR
    6307/    2144 : B8 22               	dw	el2_27		; AND
    6308/    2146 :                     
    6309/    2146 : BC 22               	dw	el2_24		; SUB
    6310/    2148 :                     
    6311/    2148 : 3E 23               	dw	el2_26		; DEC
    6312/    214A : 43 23               	dw	el2_23		; INC
    6313/    214C :                     
    6314/    214C : 85 23               	dw	el2_9		; POP
    6315/    214E : 89 23               	dw	el2_8		; PUSH
    6316/    2150 :                     
    6317/    2150 :                     ;
    6318/    2150 :                     ; make machine code,
    6319/    2150 :                     ; element_cnt = 2 (ex. PUSH AF)
    6320/    2150 :                     ; output : 1 to 3 bytes Machine code
    6321/    2150 :                     ;
    6322/    2150 :                     
    6323/    2150 :                     mk_e2:
    6324/    2150 : 3A 6A EF            	ld	a, (opc_cd)
    6325/    2153 : 01 1A 00            	ld	bc, e2s
    6326/    2156 : 21 02 21            	ld	hl, elem2_cd
    6327/    2159 : ED B1               	cpir
    6328/    215B : C2 6D 1A            	jp	nz, asm_err
    6329/    215E :                     	
    6330/    215E : 21 1C 21            	ld	hl, ent_el2
    6331/    2161 : C3 0F 1B            	jp	jp_each
    6332/    2164 :                     
    6333/    2164 :                     el2_70: ; DW
    6334/    2164 : 3A 6B EF            	ld	a, (opr1_cd)
    6335/    2167 : FE 19               	cp	25
    6336/    2169 : C2 6D 1A            	jp	nz, asm_err
    6337/    216C :                     
    6338/    216C : 2A 66 EF            	ld	hl, (tasm_adr)
    6339/    216F : ED 4B 6D EF         	ld	bc, (opr_num25)
    6340/    2173 : 71                  	ld	(hl), c
    6341/    2174 : 23                  	inc	hl
    6342/    2175 : 70                  	ld	(hl), b
    6343/    2176 : C3 FE 20            	jp	mc_end2
    6344/    2179 :                     
    6345/    2179 :                     el2_69: ; DB
    6346/    2179 : 3A 6B EF            	ld	a, (opr1_cd)
    6347/    217C : FE 19               	cp	25
    6348/    217E : 28 20               	jr	z, el2_691
    6349/    2180 : FE 26               	cp	38
    6350/    2182 : C2 6D 1A            	jp	nz, asm_err
    6351/    2185 :                     	
    6352/    2185 : 2A 6D EF            	ld	hl, (opr_num25)
    6353/    2188 :                     
    6354/    2188 : AF                  	xor	a
    6355/    2189 : 4F                  	ld	c, a
    6356/    218A : ED 5B 66 EF         	ld	de, (tasm_adr)
    6357/    218E :                     
    6358/    218E :                     el2_692:
    6359/    218E : 7E                  	ld	a, (hl)
    6360/    218F : FE 22               	cp	'"'
    6361/    2191 : 28 09               	jr	z, cpstrend
    6362/    2193 : B7                  	or	a
    6363/    2194 : 28 06               	jr	z, cpstrend
    6364/    2196 :                     
    6365/    2196 : 12                  	ld	(de), a
    6366/    2197 : 23                  	inc	hl
    6367/    2198 : 13                  	inc	de
    6368/    2199 : 0C                  	inc	c
    6369/    219A : 18 F2               	jr	el2_692
    6370/    219C :                     
    6371/    219C :                     cpstrend:
    6372/    219C : 79                  	ld	a, c
    6373/    219D : C3 DF 20            	jp	mc_end
    6374/    21A0 :                     
    6375/    21A0 :                     el2_691:
    6376/    21A0 : ED 4B 6D EF         	ld	bc, (opr_num25)
    6377/    21A4 : 78                  	ld	a, b
    6378/    21A5 : B7                  	or	a
    6379/    21A6 : C2 6D 1A            	jp	nz, asm_err
    6380/    21A9 :                     
    6381/    21A9 : 2A 66 EF            	ld	hl, (tasm_adr)
    6382/    21AC : 71                  	ld	(hl), c
    6383/    21AD : 3E 01               	ld	a, 1
    6384/    21AF : C3 DF 20            	jp	mc_end
    6385/    21B2 :                     
    6386/    21B2 :                     el2_68: ; ORG
    6387/    21B2 : 3A 6B EF            	ld	a, (opr1_cd)
    6388/    21B5 : FE 19               	cp	25
    6389/    21B7 : C2 6D 1A            	jp	nz, asm_err
    6390/    21BA :                     
    6391/    21BA : =>TRUE              	IF SuperMEZ80 = 0
    6392/    21BA : AF                  	xor	a
    6393/    21BB : 2A 6D EF            	ld	hl, (opr_num25)
    6394/    21BE : 01 00 C0            	ld	bc, RAM_B
    6395/    21C1 : ED 42               	sbc	hl, bc
    6396/    21C3 : DA 6D 1A            	jp	c, asm_err
    6397/    21C6 :                     
    6398/    21C6 : 01 00 F0            	ld	bc, RAM_B + RAM_SIZ
    6399/    21C9 : 2A 6D EF            	ld	hl, (opr_num25)
    6400/    21CC : ED 42               	sbc	hl, bc
    6401/    21CE : D2 6D 1A            	jp	nc, asm_err
    6402/    21D1 : [6391]              	ENDIF
    6403/    21D1 :                     
    6404/    21D1 :                     okram:
    6405/    21D1 : 2A 6D EF            	ld	hl, (opr_num25)
    6406/    21D4 : 22 66 EF            	ld	(tasm_adr), hl
    6407/    21D7 : AF                  	xor	a
    6408/    21D8 : C3 DF 20            	jp	mc_end
    6409/    21DB :                     
    6410/    21DB :                     ; CALL nnnn
    6411/    21DB :                     el2_45:
    6412/    21DB : 3A 6B EF            	ld	a, (opr1_cd)
    6413/    21DE : FE 19               	cp	25
    6414/    21E0 : C2 6D 1A            	jp	nz, asm_err
    6415/    21E3 :                     
    6416/    21E3 : 3E CD               	ld	a, 0CDH
    6417/    21E5 :                     
    6418/    21E5 :                     el2_451:
    6419/    21E5 : 2A 66 EF            	ld	hl, (tasm_adr)
    6420/    21E8 : 77                  	ld	(hl), a		; save op_code
    6421/    21E9 : 23                  	inc	hl
    6422/    21EA : ED 5B 6D EF         	ld	de, (opr_num25)
    6423/    21EE : 73                  	ld	(hl), e
    6424/    21EF : 23                  	inc	hl
    6425/    21F0 : 72                  	ld	(hl), d
    6426/    21F1 :                     
    6427/    21F1 :                     mc_end3:
    6428/    21F1 : 3E 03               	ld	a, 3
    6429/    21F3 : C3 DF 20            	jp	mc_end
    6430/    21F6 :                     
    6431/    21F6 :                     ; DJNZ relative number
    6432/    21F6 :                     el2_44:
    6433/    21F6 : 3A 6B EF            	ld	a, (opr1_cd)
    6434/    21F9 : FE 19               	cp	25
    6435/    21FB : C2 6D 1A            	jp	nz, asm_err
    6436/    21FE :                     
    6437/    21FE : CD 8E 25            	call	calc_reladr
    6438/    2201 : DA 6D 1A            	jp	c, asm_err
    6439/    2204 : F5                  	push	af
    6440/    2205 : 3E 10               	ld	a, 10H
    6441/    2207 :                     el2_441:
    6442/    2207 : 2A 66 EF            	ld	hl, (tasm_adr)
    6443/    220A : 77                  	ld	(hl), a		; save op_code
    6444/    220B : 23                  	inc	hl
    6445/    220C : F1                  	pop	af
    6446/    220D : 77                  	ld	(hl), a
    6447/    220E : C3 FE 20            	jp	mc_end2
    6448/    2211 :                     
    6449/    2211 :                     ;ovr_msg:
    6450/    2211 :                     ;	db	"Over. ", 0
    6451/    2211 :                     
    6452/    2211 :                     ; JR e
    6453/    2211 :                     el2_43:
    6454/    2211 : 3A 6B EF            	ld	a, (opr1_cd)
    6455/    2214 : FE 19               	cp	25
    6456/    2216 : C2 6D 1A            	jp	nz, asm_err
    6457/    2219 : CD 8E 25            	call	calc_reladr
    6458/    221C : DA 6D 1A            	jp	c, asm_err
    6459/    221F : F5                  	push	af
    6460/    2220 : 3E 18               	ld	a, 18H
    6461/    2222 : 18 E3               	jr	el2_441
    6462/    2224 :                     
    6463/    2224 :                     ; RST
    6464/    2224 :                     el2_49:
    6465/    2224 : 2A 6D EF            	ld	hl, (opr_num25)
    6466/    2227 : 7C                  	ld	a, h
    6467/    2228 : B7                  	or	a
    6468/    2229 : C2 6D 1A            	jp	nz, asm_err
    6469/    222C : 7D                  	ld	a, l
    6470/    222D : 21 3E 22            	ld	hl, rst_no
    6471/    2230 : 01 08 00            	ld	bc, 8
    6472/    2233 : ED B1               	cpir
    6473/    2235 : C2 6D 1A            	jp	nz, asm_err
    6474/    2238 :                     
    6475/    2238 : 21 46 22            	ld	hl, rst_cd
    6476/    223B : C3 D7 20            	jp	st_mc1		; get and store MC code
    6477/    223E :                     
    6478/    223E : 00 08 10 18 20 28   rst_no:	db	0, 8, 10H, 18H, 20H, 28H, 30H, 38H
             2244 : 30 38             
    6479/    2246 : FF F7 EF E7 DF D7   rst_cd:	db	0FFH, 0F7H, 0EFH, 0E7H, 0DFH, 0D7H, 0CFH, 0C7H
             224C : CF C7             
    6480/    224E :                     
    6481/    224E :                     ;ill_num:	db	"Ill-No. ", 0
    6482/    224E :                     
    6483/    224E :                     ; RET CC
    6484/    224E :                     el2_46:
    6485/    224E : 3A 6B EF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6486/    2251 : 21 62 22            	ld	hl, ret_no
    6487/    2254 : 01 08 00            	ld	bc, 8
    6488/    2257 : ED B1               	cpir
    6489/    2259 : C2 6D 1A            	jp	nz, asm_err
    6490/    225C :                     
    6491/    225C : 21 6A 22            	ld	hl, ret_cd
    6492/    225F : C3 D7 20            	jp	st_mc1		; get and store MC code
    6493/    2262 :                     
    6494/    2262 : 06 12 13 14 15 16   ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
             2268 : 17 18             
    6495/    226A : E8 E0 F0 D0 C0 F8   ret_cd:	db	0E8H, 0E0H, 0F0H, 0D0H, 0C0H, 0F8H, 0C8H, 0D8H
             2270 : C8 D8             
    6496/    2272 :                     
    6497/    2272 :                     ; JP (HL), JP nnnn, JP (IX), JP (IY)
    6498/    2272 :                     el2_42:
    6499/    2272 : 3A 6B EF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6500/    2275 : FE 19               	cp	25
    6501/    2277 : 28 21               	jr	z, jpnnnn	; JP nnnn
    6502/    2279 : 2E E9               	ld	l, 0E9H
    6503/    227B : FE 1C               	cp	28		; (HL)?
    6504/    227D : 28 17               	jr	z, jphl
    6505/    227F : FE 1D               	cp	29		; (IX)?
    6506/    2281 : 28 0C               	jr	z, jpix
    6507/    2283 : FE 1E               	cp	30		; (IY)?
    6508/    2285 : C2 6D 1A            	jp	nz, asm_err
    6509/    2288 :                     
    6510/    2288 :                     ; JP (IY)
    6511/    2288 : 7D                  	ld	a, l
    6512/    2289 : F5                  	push	af
    6513/    228A : 3E FD               	ld	a, 0FDH
    6514/    228C : C3 07 22            	jp	el2_441
    6515/    228F :                     
    6516/    228F :                     ; JP (IX)
    6517/    228F :                     jpix:
    6518/    228F : 7D                  	ld	a, l
    6519/    2290 : F5                  	push	af
    6520/    2291 : 3E DD               	ld	a, 0DDH
    6521/    2293 : C3 07 22            	jp	el2_441
    6522/    2296 :                     
    6523/    2296 :                     ; JP (HL)
    6524/    2296 :                     jphl:
    6525/    2296 : 7D                  	ld	a, l
    6526/    2297 : C3 D9 20            	jp	st_mc11		; set JP (HL) MC code
    6527/    229A :                     
    6528/    229A :                     ; JP nnnn
    6529/    229A :                     jpnnnn:
    6530/    229A : 3E C3               	ld	a, 0c3h
    6531/    229C : C3 E5 21            	jp	el2_451		; save OP and jmp address
    6532/    229F :                     
    6533/    229F :                     ;
    6534/    229F :                     ; CP, XOR, OR, AND, SUB section
    6535/    229F :                     ;
    6536/    229F :                     ; (defined already)
    6537/    229F :                     ;rhlnnxy	equ	r_hl_nne - r_hl_nn
    6538/    229F :                     ;m_num		equ	5	; except No.0 - 4  (IX+,IY+,IX-,IY-,nnnn)
    6539/    229F :                     ;r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    6540/    229F :                     ;		db	25
    6541/    229F :                     ;ex_sr_:	db	33, 36, 34, 37
    6542/    229F :                     ;r_hl_nne:
    6543/    229F :                     ;
    6544/    229F : 06 06 06 06 46      base1:		db	06H, 06H, 06H, 06H, 46h
    6545/    22A4 : 06 05 04 03 02 01   		db	06H, 05H, 04H, 03H, 02H, 01H, 00H, 07H
             22AA : 00 07             
    6546/    22AC :                     
    6547/    22AC :                     el2_41: ; CP
    6548/    22AC : 16 B8               	ld	d, 0b8h
    6549/    22AE : 18 0E               	jr	and_cp
    6550/    22B0 :                     
    6551/    22B0 :                     el2_29: ; XOR
    6552/    22B0 : 16 A8               	ld	d, 0a8h
    6553/    22B2 : 18 0A               	jr	and_cp
    6554/    22B4 :                     
    6555/    22B4 :                     el2_28: ; OR
    6556/    22B4 : 16 B0               	ld	d, 0b0h
    6557/    22B6 : 18 06               	jr	and_cp
    6558/    22B8 :                     
    6559/    22B8 :                     el2_27: ; AND
    6560/    22B8 : 16 A0               	ld	d, 0a0h
    6561/    22BA : 18 02               	jr	and_cp
    6562/    22BC :                     
    6563/    22BC :                     el2_24: ; SUB
    6564/    22BC : 16 90               	ld	d, 090h
    6565/    22BE :                     
    6566/    22BE :                     and_cp:
    6567/    22BE : 3A 6B EF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6568/    22C1 : 21 15 1E            	ld	hl, r_hl_nn
    6569/    22C4 : 01 0D 00            	ld	bc, rhlnnxy
    6570/    22C7 : ED B1               	cpir
    6571/    22C9 : C2 6D 1A            	jp	nz, asm_err
    6572/    22CC :                     
    6573/    22CC : 21 9F 22            	ld	hl, base1
    6574/    22CF : 09                  	add	hl, bc
    6575/    22D0 : 7E                  	ld	a, (hl)
    6576/    22D1 : B2                  	or	a, d		; make code operand1
    6577/    22D2 : 57                  	ld	d, a		; save operand1
    6578/    22D3 : 79                  	ld	a, c
    6579/    22D4 : FE 05               	cp	m_num		; check IX+,IY+,IX-,IY-,nnnn
    6580/    22D6 : DA DD 22            	jp	c, el2_410
    6581/    22D9 : 7A                  	ld	a, d		; restore
    6582/    22DA : C3 D9 20            	jp	st_mc11
    6583/    22DD :                     	
    6584/    22DD :                     ; IX+,IY+,IX-,IY-,nnnn
    6585/    22DD :                     el2_410:
    6586/    22DD : FE 04               	cp	4 		; cp nn ?
    6587/    22DF : 38 0E               	jr	c, cp_ixiy	; no, IX+,IY+,IX-,IY-
    6588/    22E1 :                     
    6589/    22E1 :                     ; CP nn
    6590/    22E1 : 2A 6D EF            	ld	hl, (opr_num25)
    6591/    22E4 : 7C                  	ld	a, h
    6592/    22E5 : B7                  	or	a
    6593/    22E6 : C2 6D 1A            	jp	nz, asm_err
    6594/    22E9 :                     
    6595/    22E9 : 7D                  	ld	a, l
    6596/    22EA :                     el2_411:
    6597/    22EA : F5                  	push	af		; adjust save I/F
    6598/    22EB : 7A                  	ld	a, d		; restore cp opecode
    6599/    22EC : C3 07 22            	jp	el2_441
    6600/    22EF :                     	
    6601/    22EF :                     ; CP (IX+nn), CP (IY+nn), CP (IX-nn), CP (IY-nn)
    6602/    22EF :                     
    6603/    22EF :                     cp_ixiy:
    6604/    22EF : FE 02               	cp	2
    6605/    22F1 : 3E FD               	ld	a, 0FDH
    6606/    22F3 : 38 02               	jr	c, cp_iy
    6607/    22F5 : 3E DD               	ld	a, 0DDH
    6608/    22F7 :                     cp_iy:
    6609/    22F7 : 21 71 EF            	ld	hl, opr_num37
    6610/    22FA : 09                  	add	hl, bc
    6611/    22FB : 4E                  	ld	c, (hl)
    6612/    22FC :                     cp_xy1:	
    6613/    22FC : 2A 66 EF            	ld	hl, (tasm_adr)
    6614/    22FF : 77                  	ld	(hl), a		; save op_code
    6615/    2300 : 7A                  	ld	a, d		; restore 2nd operand
    6616/    2301 : 23                  	inc	hl
    6617/    2302 : 77                  	ld	(hl), a
    6618/    2303 : 23                  	inc	hl
    6619/    2304 : 71                  	ld	(hl), c
    6620/    2305 : C3 F1 21            	jp	mc_end3
    6621/    2308 :                     
    6622/    2308 :                     ;
    6623/    2308 :                     ; DEC, INC section
    6624/    2308 :                     ;
    6625/    2308 :                     
    6626/    2308 : =12H                di_nbs		equ	d_i_tbe - d_i_tb
    6627/    2308 : =6H                 di_ixynum	equ	d_i_tbe - dix_tbl
    6628/    2308 : =4H                 di_ixnnum	equ	d_i_tbe - dixn_tbl
    6629/    2308 : =2H                 di_iynnum	equ	d_i_tbe - diyn_tbl
    6630/    2308 :                     
    6631/    2308 : 01 04 05 06 07 08   d_i_tb:		db	1, 4, 5, 6, 7, 8
    6632/    230E : 09 0A 0B 0C 10 1C   		db	9, 10, 11, 12, 16, 28
    6633/    2314 : 0E 0F               dix_tbl:	db	14, 15		; IX, IY
    6634/    2316 : 21 24               dixn_tbl:	db	33, 36		; IX+nn, IX-nn
    6635/    2318 : 22 25               diyn_tbl:	db	34, 37		; IY+nn, IY-nn
    6636/    231A :                     d_i_tbe:
    6637/    231A :                     
    6638/    231A : 35 35               DEC_opr:	db	35h, 35h	; IY-, IY+
    6639/    231C : 35 35               		db	35h, 35h	; IX-, IX+
    6640/    231E : 2B 2B               		db	2bh, 2bh 	; IY, IX
    6641/    2320 : 35 3B 2D 2B 25 1D   		db	35h, 3Bh, 2Dh, 2Bh, 25h, 1Dh
    6642/    2326 : 1B 15 0D 0B 05 3D   		db	1Bh, 15h, 0Dh, 0Bh, 05h, 3Dh
    6643/    232C :                     
    6644/    232C : 34 34               INC_opr:	db	34h, 34h	; IY-, IY+
    6645/    232E : 34 34               		db	34h, 34h	; IX-, IX+
    6646/    2330 : 23 23               		db	23h, 23h	; IY,  IX
    6647/    2332 : 34 33 2C 23 24 1C   		db	34h, 33h, 2Ch, 23h, 24h, 1Ch
    6648/    2338 : 13 14 0C 03 04 3C   		db	13h, 14h, 0Ch, 03h, 04h, 3Ch
    6649/    233E :                     
    6650/    233E :                     el2_26: ; DEC
    6651/    233E : 11 1A 23            	ld	de, DEC_opr
    6652/    2341 : 18 03               	jr	el2_di
    6653/    2343 :                     
    6654/    2343 :                     el2_23: ; INC
    6655/    2343 : 11 2C 23            	ld	de, INC_opr
    6656/    2346 :                     
    6657/    2346 :                     el2_di:
    6658/    2346 : 3A 6B EF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6659/    2349 : 21 08 23            	ld	hl, d_i_tb
    6660/    234C : 01 12 00            	ld	bc, di_nbs
    6661/    234F : ED B1               	cpir
    6662/    2351 : 62                  	ld	h, d
    6663/    2352 : 6B                  	ld	l, e
    6664/    2353 : C2 6D 1A            	jp	nz, asm_err
    6665/    2356 :                     
    6666/    2356 : 79                  	ld	a, c
    6667/    2357 : 16 FD               	ld	d, 0FDH		; set IY extended OP
    6668/    2359 : FE 06               	cp	di_ixynum
    6669/    235B : D2 D7 20            	jp	nc, st_mc1	; 1 MC code
    6670/    235E :                     
    6671/    235E : 09                  	add	hl, bc
    6672/    235F : 7E                  	ld	a, (hl)		; get 2nd operand
    6673/    2360 : 5F                  	ld	e, a		; save
    6674/    2361 : 79                  	ld	a, c
    6675/    2362 : FE 04               	cp	di_ixnnum
    6676/    2364 : 38 08               	jr	c, di_3mc
    6677/    2366 :                     	
    6678/    2366 :                     	; 2 MC. : INC IX, IY, DEC IX, IY
    6679/    2366 :                     	
    6680/    2366 : 28 02               	jr	z, di_iy
    6681/    2368 : 16 DD               	ld	d, 0DDH		; set IX extended OP
    6682/    236A :                     di_iy:
    6683/    236A : 7B                  	ld	a, e		; restoe 2nd operand
    6684/    236B : C3 EA 22            	jp	el2_411		; 2 MC (IX, IY)
    6685/    236E :                     
    6686/    236E :                     	; 3 MC. : INC (IX+nn) etc,.
    6687/    236E :                     di_3mc:
    6688/    236E : FE 02               	cp	di_iynnum	; IY+-nn?
    6689/    2370 : 38 02               	jr	c, di_3mc1
    6690/    2372 : 16 DD               	ld	d, 0DDH		; set IX extended OP
    6691/    2374 :                     di_3mc1:
    6692/    2374 : 7A                  	ld	a, d		; adjust I/F
    6693/    2375 : 53                  	ld	d, e		; adjust I/F
    6694/    2376 : C3 F7 22            	jp	cp_iy		; make 3 MC
    6695/    2379 :                     	
    6696/    2379 :                     ;
    6697/    2379 :                     ; PUSH, POP section
    6698/    2379 :                     ;
    6699/    2379 :                     
    6700/    2379 : =6H                 pp_no		equ	pp_tble - pp_tbl
    6701/    2379 : =2H                 pp_ixiy		equ	pp_tble - pp_ixy
    6702/    2379 :                     
    6703/    2379 : 02 05 08 0B         pp_tbl:		db	2, 5, 8, 11
    6704/    237D : 0E 0F               pp_ixy:		db	14, 15
    6705/    237F :                     pp_tble:	
    6706/    237F :                     
    6707/    237F : E0 E0               pp_base:	db	0E0h, 0E0h ; IY, IX
    6708/    2381 : E0 D0 C0 F0         		db	0E0h, 0D0h, 0C0h, 0f0h
    6709/    2385 :                     
    6710/    2385 :                     el2_9:  ; POP
    6711/    2385 : 16 01               	ld	d, 01h		; base code for pop operand
    6712/    2387 : 18 02               	jr	el2_81
    6713/    2389 :                     
    6714/    2389 :                     el2_8:  ; PUSH
    6715/    2389 : 16 05               	ld	d, 05h
    6716/    238B :                     
    6717/    238B :                     el2_81:
    6718/    238B : 21 79 23            	ld	hl, pp_tbl
    6719/    238E : 01 06 00            	ld	bc, pp_no
    6720/    2391 : 3A 6B EF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6721/    2394 : ED B1               	cpir
    6722/    2396 : C2 6D 1A            	jp	nz, asm_err
    6723/    2399 :                     
    6724/    2399 : 21 7F 23            	ld	hl, pp_base
    6725/    239C : 09                  	add	hl, bc
    6726/    239D : 7E                  	ld	a, (hl)
    6727/    239E : B2                  	or	d		; make opecode
    6728/    239F : 57                  	ld	d, a		; save
    6729/    23A0 :                     
    6730/    23A0 : 79                  	ld	a, c
    6731/    23A1 : FE 02               	cp	pp_ixiy
    6732/    23A3 : 7A                  	ld	a, d		; restore
    6733/    23A4 : D2 D9 20            	jp	nc, st_mc11	; 1 MC code
    6734/    23A7 :                     
    6735/    23A7 : 1E FD               	ld	e, 0FDH		; set IY extended OP
    6736/    23A9 : 79                  	ld	a, c
    6737/    23AA : B7                  	or	a		; IY
    6738/    23AB : 28 02               	jr	z, el2_82
    6739/    23AD : 1E DD               	ld	e, 0DDH		; set IX code
    6740/    23AF :                     el2_82:
    6741/    23AF : 7A                  	ld	a, d
    6742/    23B0 : F5                  	push	af		; adjust I/F
    6743/    23B1 : 7B                  	ld	a, e		; adjust I/F
    6744/    23B2 : C3 07 22            	jp	el2_441		; make 2 MC
    6745/    23B5 :                     
    6746/    23B5 :                     ;
    6747/    23B5 :                     ; SRL, SRA, SLA, RR, RL, RRC, RLC section
    6748/    23B5 :                     ;
    6749/    23B5 :                     
    6750/    23B5 :                     
    6751/    23B5 :                     ; already defined
    6752/    23B5 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    6753/    23B5 :                     ;		db	25
    6754/    23B5 :                     ; ex_sr_:		db	33, 36, 34, 37
    6755/    23B5 :                     
    6756/    23B5 : =8H                 sr_num		equ	8
    6757/    23B5 : =4H                 ex_sr_num	equ	ld_en3
    6758/    23B5 :                     
    6759/    23B5 :                     ;SRL_cd:	db	3Eh, 3Dh, 3Ch, 3Bh, 3Ah, 39h, 38h, 3Fh
    6760/    23B5 :                     ;SRA_cd:	db	2Eh, 2Dh, 2Ch, 2Bh, 2Ah, 29h, 28h, 2Fh
    6761/    23B5 :                     ;RR_cd:		db	1Eh, 1Dh, 1Ch, 1Bh, 1Ah, 19h, 18h, 1Fh
    6762/    23B5 :                     ;RRC_cd:	db	0Eh, 0Dh, 0Ch, 0Bh, 0Ah, 09h, 08h, 0Fh
    6763/    23B5 :                     ;SLA_cd:	db	26h, 25h, 24h, 23h, 22h, 21h, 20h, 27h
    6764/    23B5 :                     ;RL_cd:		db	16h, 15h, 14h, 13h, 12h, 11h, 10h, 17h
    6765/    23B5 :                     ;RLC_cd:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
    6766/    23B5 :                     ;RLC_cd:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
    6767/    23B5 :                     
    6768/    23B5 : =0H                 RLC_or	equ	0
    6769/    23B5 : =10H                RL_or	equ	10h
    6770/    23B5 : =20H                SLA_or	equ	20h
    6771/    23B5 : =8H                 RRC_or	equ	08h
    6772/    23B5 : =18H                RR_or	equ	18h
    6773/    23B5 : =28H                SRA_or	equ	28h
    6774/    23B5 : =38H                SRL_or	equ	38h
    6775/    23B5 :                     
    6776/    23B5 : 06 05 04 03 02 01   SR_base:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
             23BB : 00 07             
    6777/    23BD :                     
    6778/    23BD :                     
    6779/    23BD :                     
    6780/    23BD :                     el2_20:	; SRL
    6781/    23BD : 11 3E 38            	ld	de, (SRL_or << 8) | 3Eh
    6782/    23C0 : 18 1C               	jr	sr_lookfor
    6783/    23C2 :                     el2_19:	; SRA
    6784/    23C2 : 11 2E 28            	ld	de, (SRA_or << 8) | 2Eh
    6785/    23C5 : 18 17               	jr	sr_lookfor
    6786/    23C7 :                     el2_18:	; SLA
    6787/    23C7 : 11 26 20            	ld	de, (SLA_or << 8) | 26h
    6788/    23CA : 18 12               	jr	sr_lookfor
    6789/    23CC :                     el2_17:	; RR
    6790/    23CC : 11 1E 18            	ld	de, (RR_or << 8) | 1Eh
    6791/    23CF : 18 0D               	jr	sr_lookfor
    6792/    23D1 :                     el2_13:	; RL
    6793/    23D1 : 11 16 10            	ld	de, (RL_or << 8) | 16h
    6794/    23D4 : 18 08               	jr	sr_lookfor
    6795/    23D6 :                     el2_16:	; RRC
    6796/    23D6 : 11 0E 08            	ld	de, (RRC_or << 8) | 0Eh
    6797/    23D9 : 18 03               	jr	sr_lookfor
    6798/    23DB :                     el2_12:	; RLC
    6799/    23DB : 11 06 00            	ld	de, (RLC_or << 8) | 06h
    6800/    23DE :                     
    6801/    23DE :                     sr_lookfor:
    6802/    23DE : 3A 6B EF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6803/    23E1 : 21 15 1E            	ld	hl, r_hl_nn
    6804/    23E4 : 01 08 00            	ld	bc, sr_num
    6805/    23E7 : ED B1               	cpir
    6806/    23E9 : 20 0C               	jr	nz, nxt_sr
    6807/    23EB :                     
    6808/    23EB : 21 B5 23            	ld	hl, SR_base
    6809/    23EE : 09                  	add	hl, bc
    6810/    23EF : 7E                  	ld	a, (hl)
    6811/    23F0 : B2                  	or	d		; make 2nd opcode
    6812/    23F1 :                     
    6813/    23F1 :                     el2_130:
    6814/    23F1 : F5                  	push	af		; adjust I/F
    6815/    23F2 : 3E CB               	ld	a, 0cbh		; set OP code
    6816/    23F4 : C3 07 22            	jp	el2_441
    6817/    23F7 :                     
    6818/    23F7 :                     nxt_sr:
    6819/    23F7 : 21 1E 1E            	ld	hl, ex_sr_
    6820/    23FA : 01 04 00            	ld	bc, ex_sr_num
    6821/    23FD : ED B1               	cpir
    6822/    23FF : C2 6D 1A            	jp	nz, asm_err
    6823/    2402 :                     
    6824/    2402 : 16 FD               	ld	d, 0FDh		; for IY
    6825/    2404 : 79                  	ld	a, c
    6826/    2405 : FE 02               	cp	2
    6827/    2407 : 38 02               	jr	c, sr_iy1
    6828/    2409 : 16 DD               	ld	d, 0DDh		; for IX
    6829/    240B :                     
    6830/    240B :                     sr_iy1:	; D: opecode, E : code operand4
    6831/    240B :                     
    6832/    240B : 21 71 EF            	ld	hl, opr_num37
    6833/    240E : 09                  	add	hl, bc
    6834/    240F : 4E                  	ld	c, (hl)
    6835/    2410 : 23                  	inc	hl
    6836/    2411 : 46                  	ld	b, (hl)
    6837/    2412 : 3E CB               	ld	a, 0CBH
    6838/    2414 :                     
    6839/    2414 :                     mc_end41:
    6840/    2414 : 2A 66 EF            	ld	hl, (tasm_adr)
    6841/    2417 : 72                  	ld	(hl), d		; save 1st MC
    6842/    2418 : 23                  	inc	hl
    6843/    2419 : 77                  	ld	(hl), a		; save 2nd MC 
    6844/    241A : 23                  	inc	hl
    6845/    241B : 71                  	ld	(hl), c		; save 3rd MC (8bit litelal)
    6846/    241C : 23                  	inc	hl
    6847/    241D : 73                  	ld	(hl), e		; save 4th MC
    6848/    241E :                     mc_end4:
    6849/    241E : 3E 04               	ld	a, 4
    6850/    2420 : C3 DF 20            	jp	mc_end
    6851/    2423 :                     
    6852/    2423 :                     ;
    6853/    2423 :                     ; IM section
    6854/    2423 :                     ;
    6855/    2423 :                     el2_54:	; IM
    6856/    2423 : 3A 6E EF            	ld	a, (opr_num25+1)	; get high byte
    6857/    2426 : B7                  	or	a
    6858/    2427 : C2 6D 1A            	jp	nz, asm_err
    6859/    242A : 3A 6D EF            	ld	a, (opr_num25)		; get low byte
    6860/    242D : FE 03               	cp	3
    6861/    242F : D2 6D 1A            	jp	nc, asm_err
    6862/    2432 :                     
    6863/    2432 : 0E 46               	ld	c, 046h		; IM 0
    6864/    2434 : B7                  	or	a
    6865/    2435 : 28 07               	jr	z, el2_541
    6866/    2437 :                     
    6867/    2437 : 0E 56               	ld	c, 056h		; IM 1
    6868/    2439 : 3D                  	dec	a
    6869/    243A : 28 02               	jr	z, el2_541
    6870/    243C : 0E 5E               	ld	c, 05Eh		; IM 2
    6871/    243E :                     
    6872/    243E :                     el2_541:
    6873/    243E : 79                  	ld	a, c
    6874/    243F :                     
    6875/    243F :                     el2_5411:
    6876/    243F : F5                  	push	af		; adjust I/F
    6877/    2440 : 3E ED               	ld	a, 0EDh		; set MC 1
    6878/    2442 : C3 07 22            	jp	el2_441
    6879/    2445 :                     
    6880/    2445 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    6881/    2445 :                     ; get opecode
    6882/    2445 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    6883/    2445 :                     analize_input:
    6884/    2445 : CD 08 25            	call	sch_opecode
    6885/    2448 : D8                  	ret	c		; error return
    6886/    2449 : 32 6A EF            	ld	(opc_cd), a	; save code number of opecode
    6887/    244C : CD 7F 24            	call	inc_element
    6888/    244F :                     
    6889/    244F : 7E                  	ld	a, (hl)
    6890/    2450 : B7                  	or	a
    6891/    2451 : C8                  	ret	z		; no operand
    6892/    2452 : FE 20               	cp	a, ' '		; check opecode delimiter
    6893/    2454 : C2 7D 24            	jp	nz, sx_err	; not space then syntax error
    6894/    2457 :                     
    6895/    2457 :                     	; get code of operand 1
    6896/    2457 :                     
    6897/    2457 : CD 87 24            	call	analize_opr
    6898/    245A : D8                  	ret	c		; error
    6899/    245B : 32 6B EF            	ld	(opr1_cd), a	; save operand code to opr1
    6900/    245E : 08                  	ex	af, af'
    6901/    245F : CD 7F 24            	call	inc_element
    6902/    2462 : 08                  	ex	af, af'
    6903/    2463 : FE 26               	cp	38		; check operand code 38:='"'
    6904/    2465 : C8                  	ret	z
    6905/    2466 : 7E                  	ld	a, (hl)
    6906/    2467 : B7                  	or	a
    6907/    2468 : C8                  	ret	z		; no operand2
    6908/    2469 : FE 2C               	cp	a, ','		; check opecode delimiter
    6909/    246B : 20 10               	jr	nz, sx_err
    6910/    246D :                     
    6911/    246D :                     	; get code of operand 2
    6912/    246D :                     
    6913/    246D : CD 87 24            	call	analize_opr
    6914/    2470 : D8                  	ret	c		; error
    6915/    2471 : 32 6C EF            	ld	(opr2_cd), a	; save operand code to opr1
    6916/    2474 : CD 7F 24            	call	inc_element
    6917/    2477 :                     
    6918/    2477 : 7E                  	ld	a, (hl)
    6919/    2478 : B7                  	or	a
    6920/    2479 : 20 02               	jr	nz, sx_err	; error end
    6921/    247B : C9                  	ret
    6922/    247C :                     
    6923/    247C :                     an_err:
    6924/    247C : F1                  	pop	af
    6925/    247D :                     sx_err:
    6926/    247D : 37                  	scf
    6927/    247E : C9                  	ret
    6928/    247F :                     
    6929/    247F :                     inc_element:
    6930/    247F : 3A 68 EF            	ld	a, (element_cnt)
    6931/    2482 : 3C                  	inc	a
    6932/    2483 : 32 68 EF            	ld	(element_cnt), a
    6933/    2486 : C9                  	ret
    6934/    2487 :                     
    6935/    2487 :                     ;------------------------
    6936/    2487 :                     ; HL : input buffer
    6937/    2487 :                     ;------------------------
    6938/    2487 :                     analize_opr:
    6939/    2487 : 23                  	inc	hl		; HL : top of operand strings point
    6940/    2488 : CD FE 24            	call	sch_operand1
    6941/    248B : D0                  	ret	nc		; match, then retrun
    6942/    248C :                     	
    6943/    248C :                     	; search (IX+, (IY+, (IX-, (IY-
    6944/    248C :                     
    6945/    248C : CD 03 25            	call	sch_operand1_1
    6946/    248F : 38 40               	jr	c, nxt_a1	; jump, in not match
    6947/    2491 :                     
    6948/    2491 :                     	; analize "nn)"
    6949/    2491 :                     
    6950/    2491 : F5                  	push	af		; save operand code
    6951/    2492 : CD 31 25            	call	get_number	; DE : binary
    6952/    2495 : DA 7C 24            	jp	c, an_err
    6953/    2498 :                     	
    6954/    2498 : 7A                  	ld	a, d
    6955/    2499 : B7                  	or	a
    6956/    249A : 20 E0               	jr	nz, an_err	; over 255
    6957/    249C :                     	
    6958/    249C : 7E                  	ld	a, (hl)
    6959/    249D : FE 29               	cp	')'
    6960/    249F : 20 DB               	jr	nz, an_err
    6961/    24A1 :                     
    6962/    24A1 : 23                  	inc	hl
    6963/    24A2 : F1                  	pop	af		; restore operand code
    6964/    24A3 :                     
    6965/    24A3 : F5                  	push	af
    6966/    24A4 : FE 21               	cp 	33		; IX+?
    6967/    24A6 : 20 05               	jr	nz, nxt_a2
    6968/    24A8 : 01 74 EF            	ld	bc, opr_num33
    6969/    24AB : 18 07               	jr	nxt_a21
    6970/    24AD :                     
    6971/    24AD :                     nxt_a2:
    6972/    24AD : FE 22               	cp 	34		; IY+?
    6973/    24AF : 20 0B               	jr	nz, nxt_a3
    6974/    24B1 : 01 72 EF            	ld	bc, opr_num34
    6975/    24B4 :                     
    6976/    24B4 :                     nxt_a21:
    6977/    24B4 : 7B                  	ld	a, e
    6978/    24B5 : FE 80               	cp	80H
    6979/    24B7 : 30 C3               	jr	nc, an_err
    6980/    24B9 :                     
    6981/    24B9 :                     nxt_a22:
    6982/    24B9 : 02                  	ld	(bc),a		; save binary
    6983/    24BA : F1                  	pop	af
    6984/    24BB : C9                  	ret
    6985/    24BC :                     	
    6986/    24BC :                     nxt_a3:
    6987/    24BC : FE 24               	cp 	36		; IX-?
    6988/    24BE : 20 0C               	jr	nz, nxt_a4
    6989/    24C0 : 01 73 EF            	ld	bc, opr_num36
    6990/    24C3 :                     
    6991/    24C3 :                     nxt_a31:
    6992/    24C3 : 7B                  	ld	a, e
    6993/    24C4 : FE 81               	cp	81H
    6994/    24C6 : 30 B4               	jr	nc, an_err
    6995/    24C8 : ED 44               	neg
    6996/    24CA : 18 ED               	jr	nxt_a22
    6997/    24CC :                     	
    6998/    24CC :                     nxt_a4:	; IY-
    6999/    24CC : 01 71 EF            	ld	bc, opr_num37
    7000/    24CF : 18 F2               	jr	nxt_a31
    7001/    24D1 :                     
    7002/    24D1 :                     ; check '('
    7003/    24D1 :                     nxt_a1:
    7004/    24D1 : 7E                  	ld	a, (hl)
    7005/    24D2 : FE 28               	cp	'('
    7006/    24D4 : 20 12               	jr	nz, chk_strings
    7007/    24D6 :                     	
    7008/    24D6 :                     	; get number
    7009/    24D6 :                     	
    7010/    24D6 : 23                  	inc	hl
    7011/    24D7 : CD 31 25            	call	get_number
    7012/    24DA : D8                  	ret	c		; error number
    7013/    24DB :                     
    7014/    24DB : 7E                  	ld	a, (hl)
    7015/    24DC : FE 29               	cp	')'
    7016/    24DE : 20 9D               	jr	nz, sx_err
    7017/    24E0 :                     
    7018/    24E0 : 23                  	inc	hl
    7019/    24E1 : ED 53 6F EF         	ld	(opr_num35),de	; save binary
    7020/    24E5 : 3E 23               	ld	a, 35		; set operand code
    7021/    24E7 : C9                  	ret			; normal end
    7022/    24E8 :                     
    7023/    24E8 :                     chk_strings:
    7024/    24E8 : FE 22               	cp	'"'
    7025/    24EA : 20 07               	jr	nz, only_num
    7026/    24EC : 23                  	inc	hl
    7027/    24ED : 22 6D EF            	ld	(opr_num25), hl
    7028/    24F0 : 3E 26               	ld	a, 38
    7029/    24F2 : C9                  	ret
    7030/    24F3 :                     
    7031/    24F3 :                     only_num:
    7032/    24F3 : CD 31 25            	call	get_number
    7033/    24F6 : D8                  	ret	c		; error number
    7034/    24F7 : ED 53 6D EF         	ld	(opr_num25),de	; save binary
    7035/    24FB : 3E 19               	ld	a, 25		; set operand code
    7036/    24FD : C9                  	ret			; normal end
    7037/    24FE :                     
    7038/    24FE :                     ;------------------
    7039/    24FE :                     ; HL : input buffer
    7040/    24FE :                     ;------------------
    7041/    24FE :                     sch_operand1:
    7042/    24FE : 11 8C 19            	ld	de, operand_cds
    7043/    2501 : 18 0B               	jr	sh_0
    7044/    2503 :                     
    7045/    2503 :                     ;------------------
    7046/    2503 :                     ; HL : input buffer
    7047/    2503 :                     ; search (IX+, (IY+, (IX-, (IY-
    7048/    2503 :                     ;------------------
    7049/    2503 :                     sch_operand1_1:
    7050/    2503 : 11 EC 19            	ld	de, opr_cd1
    7051/    2506 : 18 06               	jr	sh_0
    7052/    2508 :                     
    7053/    2508 :                     ;----------------------------------------------------------
    7054/    2508 :                     ; Search code number of opecode from input strings
    7055/    2508 :                     ; 
    7056/    2508 :                     ; output:
    7057/    2508 :                     ; if mach opecode ; HL : next point of input strings
    7058/    2508 :                     ;		    A  : a code number of opecode
    7059/    2508 :                     ; not mach	  ; CF = 1
    7060/    2508 :                     ;----------------------------------------------------------
    7061/    2508 :                     sch_opecode:
    7062/    2508 : 21 8D EF            	ld	hl, line_buf
    7063/    250B : 11 6F 18            	ld	de, ope_cds
    7064/    250E :                     
    7065/    250E :                     sh_0:
    7066/    250E : E5                  	push	hl
    7067/    250F :                     sh_1:
    7068/    250F : 1A                  	ld	a, (de)
    7069/    2510 : BE                  	cp	(hl)
    7070/    2511 : 20 04               	jr	nz, sch_next
    7071/    2513 :                     	
    7072/    2513 :                     	; match
    7073/    2513 : 23                  	inc	hl
    7074/    2514 : 13                  	inc	de
    7075/    2515 : 18 F8               	jr	sh_1
    7076/    2517 :                     
    7077/    2517 :                     sch_next:
    7078/    2517 : E6 80               	and	dm_bit		; delimiter?
    7079/    2519 : 20 0E               	jr	nz, ok_match
    7080/    251B :                     	
    7081/    251B :                     skip_next:
    7082/    251B : 13                  	inc	de
    7083/    251C : 1A                  	ld	a, (de)
    7084/    251D : E6 80               	and	dm_bit
    7085/    251F : 28 FA               	jr	z, skip_next
    7086/    2521 :                     
    7087/    2521 :                     	; detect delimiter string
    7088/    2521 :                     
    7089/    2521 : 13                  	inc	de		; next search strings
    7090/    2522 :                     	
    7091/    2522 : 1A                  	ld	a, (de)
    7092/    2523 : B7                  	or	a		; tabel end?
    7093/    2524 : 28 08               	jr	z, n_end	; yes, no match return
    7094/    2526 :                     
    7095/    2526 : E1                  	pop	hl
    7096/    2527 : 18 E5               	jr	sh_0		; search again
    7097/    2529 :                     
    7098/    2529 :                     	; match opecode strings
    7099/    2529 :                     	; a : opecode number
    7100/    2529 :                     
    7101/    2529 :                     ok_match:
    7102/    2529 : 1A                  	ld	a, (de)
    7103/    252A : E6 7F               	and	a, 7Fh		; mask dm_bit, get code of opecode
    7104/    252C : D1                  	pop	de		; discard top string address
    7105/    252D : C9                  	ret
    7106/    252E :                     	
    7107/    252E :                     ; no opecode strings maching
    7108/    252E :                     n_end:
    7109/    252E : E1                  	pop	hl
    7110/    252F : 37                  	scf
    7111/    2530 : C9                  	ret
    7112/    2531 :                     
    7113/    2531 :                     ;---------------------
    7114/    2531 :                     ; HL : string buffer
    7115/    2531 :                     ;
    7116/    2531 :                     ; output : de or CF
    7117/    2531 :                     ;----------------------
    7118/    2531 :                     get_number:
    7119/    2531 :                     
    7120/    2531 : 11 B0 EF            	ld	de, num_string
    7121/    2534 : 0E 00               	ld	c, 0
    7122/    2536 :                     	
    7123/    2536 :                     ; check first character
    7124/    2536 :                     
    7125/    2536 : CD 73 25            	call	dec_chr		; check decimal chrarcter
    7126/    2539 : D8                  	ret	c		; no number inputs detect
    7127/    253A :                     
    7128/    253A :                     ;  detect 1st number( only 0 to 9 )
    7129/    253A :                     
    7130/    253A : 12                  	ld	(de), a		; save to buffer
    7131/    253B : 13                  	inc	de
    7132/    253C : 23                  	inc	hl
    7133/    253D : 0C                  	inc	c
    7134/    253E :                     
    7135/    253E :                     ; check 2nd, 3rd, 4th, 5th number string
    7136/    253E :                     
    7137/    253E :                     lop_gnum:
    7138/    253E : CD 7D 25            	call	hex_chr
    7139/    2541 : 38 0B               	jr	c, ck_endmk	; no number inputs detect
    7140/    2543 :                     
    7141/    2543 :                     ; detect 2nd, 3rd, 4th, 5th number (include A to F)
    7142/    2543 :                     
    7143/    2543 : 12                  	ld	(de), a		; save to buffer
    7144/    2544 : 13                  	inc	de
    7145/    2545 : 23                  	inc	hl
    7146/    2546 : 0C                  	inc	c
    7147/    2547 : 79                  	ld	a, c
    7148/    2548 : FE 07               	cp	NUMLEN		; buffer check
    7149/    254A : 28 2F               	jr	z, no_num	; overfllow. error return
    7150/    254C : 18 F0               	jr	lop_gnum
    7151/    254E :                     
    7152/    254E :                     ck_endmk:
    7153/    254E : 08                  	ex	af, af'
    7154/    254F : AF                  	xor	a
    7155/    2550 : 12                  	ld	(de), a		; set delimiter
    7156/    2551 : 08                  	ex	af, af'
    7157/    2552 : FE 48               	cp	'H'		; check hex?
    7158/    2554 : 28 0B               	jr	z, bi_hex
    7159/    2556 :                     
    7160/    2556 :                     ;	get binary from decimal string
    7161/    2556 :                     ;bi_dec:
    7162/    2556 : E5                  	push	hl
    7163/    2557 : 21 B0 EF            	ld	hl, num_string
    7164/    255A : CD B3 02            	call	GET_dNUM	; return bc
    7165/    255D : E1                  	pop	hl
    7166/    255E : 50                  	ld	d, b		; set binary to DE
    7167/    255F : 59                  	ld	e, c		; set binary to DE
    7168/    2560 : C9                  	ret
    7169/    2561 :                     
    7170/    2561 :                     ;	ret	nc		; if CF =1, try hex to bin
    7171/    2561 :                     ;	dec	hl		; adjust hl pointer
    7172/    2561 :                     
    7173/    2561 :                     	;hex to binary
    7174/    2561 :                     bi_hex:
    7175/    2561 : 23                  	inc	hl
    7176/    2562 : E5                  	push	hl
    7177/    2563 : 21 B0 EF            	ld	hl, num_string
    7178/    2566 : CD FC 26            	call	RDHEX		; get binary to DE
    7179/    2569 : E1                  	pop	hl
    7180/    256A : B7                  	or	a		; clear CF
    7181/    256B : C9                  	ret
    7182/    256C :                     
    7183/    256C :                     ;--------------------------
    7184/    256C :                     ; skip sp
    7185/    256C :                     ;--------------------------
    7186/    256C :                     skp_sp:
    7187/    256C : 7E                  	ld	a, (hl)
    7188/    256D : FE 20               	cp	' '
    7189/    256F : C0                  	ret	nz
    7190/    2570 : 23                  	inc	hl
    7191/    2571 : 18 F9               	jr	skp_sp
    7192/    2573 :                     
    7193/    2573 :                     ;--------------------------
    7194/    2573 :                     ; check decimal char
    7195/    2573 :                     ;--------------------------
    7196/    2573 :                     dec_chr:
    7197/    2573 : 7E                  	ld	a, (hl)
    7198/    2574 : FE 3A               	cp	':'
    7199/    2576 : 30 03               	jr	nc, no_num
    7200/    2578 : FE 30               	cp	'0'
    7201/    257A : D0                  	ret	nc
    7202/    257B :                     	
    7203/    257B : 37                  no_num:	scf
    7204/    257C : C9                  	ret
    7205/    257D :                     
    7206/    257D :                     ;--------------------------
    7207/    257D :                     ; check HEX char
    7208/    257D :                     ;--------------------------
    7209/    257D :                     hex_chr:
    7210/    257D : 7E                  	ld	a, (hl)
    7211/    257E : FE 30               	cp	'0'
    7212/    2580 : D8                  	ret	c	; error return
    7213/    2581 : FE 3A               	cp	'9'+1
    7214/    2583 : 38 07               	jr	c, dec_num
    7215/    2585 : FE 41               	cp	'A'
    7216/    2587 : D8                  	ret	c	; error return
    7217/    2588 : FE 47               	cp	'F'+1
    7218/    258A : 30 EF               	jr	nc, no_num
    7219/    258C :                     dec_num:
    7220/    258C : B7                  	or	a	; clear carry
    7221/    258D : C9                  	ret
    7222/    258E :                     
    7223/    258E :                     ;--------------------------------------
    7224/    258E :                     ; 2 byte machine code branch
    7225/    258E :                     ; - 2nd byte is Relative address
    7226/    258E :                     ; - output a = (e-2) relative number
    7227/    258E :                     ;          CF=1 : target address error
    7228/    258E :                     ;--------------------------------------
    7229/    258E :                     calc_reladr:
    7230/    258E : E5                  	push	hl
    7231/    258F : D5                  	push	de
    7232/    2590 :                     
    7233/    2590 : ED 5B 66 EF         	ld	de, (tasm_adr)	; base address
    7234/    2594 : 13                  	inc	de
    7235/    2595 : 13                  	inc	de
    7236/    2596 : 2A 6D EF            	ld	hl, (opr_num25)	; target address
    7237/    2599 : AF                  	xor	a
    7238/    259A : ED 52               	sbc	hl, de
    7239/    259C : 38 0D               	jr	c, cal_1	; CF=1 :target address is lower
    7240/    259E :                     
    7241/    259E : 7C                  	ld	a, h
    7242/    259F : B7                  	or	a
    7243/    25A0 : 20 17               	jr	nz, adr_ovr
    7244/    25A2 :                     
    7245/    25A2 : 7D                  	ld	a, l
    7246/    25A3 : FE 80               	cp	80H
    7247/    25A5 : 30 12               	jr	nc, adr_ovr
    7248/    25A7 : B7                  	or	a
    7249/    25A8 :                     
    7250/    25A8 :                     cal_01:
    7251/    25A8 : D1                  	pop	de
    7252/    25A9 : E1                  	pop	hl
    7253/    25AA : C9                  	ret
    7254/    25AB :                     
    7255/    25AB :                     cal_1:
    7256/    25AB : 7C                  	ld	a, h
    7257/    25AC : FE FF               	cp	0ffh
    7258/    25AE : 20 09               	jr	nz, adr_ovr
    7259/    25B0 : 7D                  	ld	a, l
    7260/    25B1 : ED 44               	neg
    7261/    25B3 : FE 81               	cp	81h
    7262/    25B5 : 7D                  	ld	a, l
    7263/    25B6 : 3F                  	ccf
    7264/    25B7 : 18 EF               	jr	cal_01
    7265/    25B9 :                     
    7266/    25B9 :                     adr_ovr:
    7267/    25B9 : 37                  	scf
    7268/    25BA : 18 EC               	jr	cal_01
    7269/    25BC :                     
    7270/    25BC :                     ;-----------------------------
    7271/    25BC :                     ;
    7272/    25BC :                     ; Recorrect input strings
    7273/    25BC :                     ;
    7274/    25BC :                     ;-----------------------------
    7275/    25BC :                     recorrect:
    7276/    25BC : E5                  	push	hl
    7277/    25BD : D5                  	push	de
    7278/    25BE : C5                  	push	bc
    7279/    25BF :                     
    7280/    25BF : 21 8D EF            	ld	hl, line_buf
    7281/    25C2 : 54                  	ld	d, h
    7282/    25C3 : 5D                  	ld	e, l
    7283/    25C4 :                     
    7284/    25C4 : 0E 20               	ld	c, ' '		; space delimitor. (opecode and operand)
    7285/    25C6 : CD 6C 25            	call	skp_sp
    7286/    25C9 : CD E1 25            	call	recorr
    7287/    25CC : B7                  	or	a
    7288/    25CD : 28 0E               	jr	z, gle_end
    7289/    25CF :                     
    7290/    25CF : 0E 00               	ld	c, 0		; end delimitor. (end strings)
    7291/    25D1 : 23                  	inc	hl
    7292/    25D2 : CD 6C 25            	call	skp_sp
    7293/    25D5 : B7                  	or	a
    7294/    25D6 : 28 03               	jr	z, gle_end1
    7295/    25D8 : CD E1 25            	call	recorr
    7296/    25DB :                     
    7297/    25DB :                     gle_end1:
    7298/    25DB : 1B                  	dec	de
    7299/    25DC : 12                  	ld	(de), a		; replace space to 0
    7300/    25DD :                     gle_end:
    7301/    25DD : C1                  	pop	bc
    7302/    25DE : D1                  	pop	de
    7303/    25DF : E1                  	pop	hl
    7304/    25E0 : C9                  	ret
    7305/    25E1 :                     
    7306/    25E1 :                     ; extract space from input buffer
    7307/    25E1 :                     recorr:
    7308/    25E1 : 06 00               	ld	b, 0
    7309/    25E3 :                     recorr1:
    7310/    25E3 : 12                  	ld	(de), a
    7311/    25E4 : 13                  	inc	de
    7312/    25E5 : B7                  	or	a
    7313/    25E6 : C8                  	ret	z
    7314/    25E7 : B9                  	cp	c
    7315/    25E8 : C8                  	ret	z
    7316/    25E9 :                     
    7317/    25E9 :                     next_char:
    7318/    25E9 : FE 22               	cp	'"'
    7319/    25EB : 20 06               	jr	nz, nxchr
    7320/    25ED :                     
    7321/    25ED : 08                  	ex	af, af'		;'
    7322/    25EE : 78                  	ld	a, b
    7323/    25EF : EE 01               	xor	a, 1
    7324/    25F1 : 47                  	ld	b, a		; toggle '"' flag
    7325/    25F2 : 08                  	ex	af, af'		;'
    7326/    25F3 :                     ;"	
    7327/    25F3 :                     nxchr:
    7328/    25F3 : 23                  	inc	hl
    7329/    25F4 : 7E                  	ld	a, (hl)
    7330/    25F5 : B9                  	cp	c
    7331/    25F6 : 28 EB               	jr	z, recorr1
    7332/    25F8 : CB 40               	bit	0, b
    7333/    25FA : 20 E7               	jr	nz, recorr1
    7334/    25FC :                     
    7335/    25FC : FE 20               	cp	' '
    7336/    25FE : 28 E9               	jr	z, next_char
    7337/    2600 : 18 E1               	jr	recorr1
    7338/    2602 :                     	
    7339/    2602 :                     ;;;
    7340/    2602 :                     ;;; Other support routines
    7341/    2602 :                     ;;;
    7342/    2602 :                     
    7343/    2602 :                     STROUT:
    7344/    2602 : 7E                  	LD	A,(HL)
    7345/    2603 : A7                  	AND	A
    7346/    2604 : C8                  	RET	Z
    7347/    2605 : CD E5 2E            	CALL	CONOUT
    7348/    2608 : 23                  	INC	HL
    7349/    2609 : 18 F7               	JR	STROUT
    7350/    260B :                     
    7351/    260B :                     ; input:  HL
    7352/    260B :                     ; output: 4 hex_char output console
    7353/    260B :                     
    7354/    260B :                     HEXOUT4:
    7355/    260B : 7C                  	LD	A,H
    7356/    260C : CD 10 26            	CALL	HEXOUT2
    7357/    260F : 7D                  	LD	A,L
    7358/    2610 :                     
    7359/    2610 :                     ; input:  A
    7360/    2610 :                     ; output: 2 hex_char output console
    7361/    2610 :                     HEXOUT2:
    7362/    2610 : F5                  	PUSH	AF
    7363/    2611 : 1F                  	RRA
    7364/    2612 : 1F                  	RRA
    7365/    2613 : 1F                  	RRA
    7366/    2614 : 1F                  	RRA
    7367/    2615 : CD 19 26            	CALL	HEXOUT1
    7368/    2618 : F1                  	POP	AF
    7369/    2619 :                     
    7370/    2619 :                     ; input:  A
    7371/    2619 :                     ; output: 1 hex_char output console
    7372/    2619 :                     HEXOUT1:
    7373/    2619 : E6 0F               	AND	0FH
    7374/    261B : C6 30               	ADD	A,'0'
    7375/    261D : FE 3A               	CP	'9'+1
    7376/    261F : DA E5 2E            	JP	C,CONOUT
    7377/    2622 : C6 07               	ADD	A,'A'-'9'-1
    7378/    2624 : C3 E5 2E            	JP	CONOUT
    7379/    2627 :                     
    7380/    2627 :                     HEXIN:
    7381/    2627 : AF                  	XOR	A
    7382/    2628 : CD 2F 26            	CALL	HI0
    7383/    262B : 07                  	RLCA
    7384/    262C : 07                  	RLCA
    7385/    262D : 07                  	RLCA
    7386/    262E : 07                  	RLCA
    7387/    262F :                     HI0:
    7388/    262F : C5                  	PUSH	BC
    7389/    2630 : 4F                  	LD	C,A
    7390/    2631 : CD D4 2E            	CALL	CONIN
    7391/    2634 : FE 30               	CP	'0'
    7392/    2636 : 38 11               	JR	C,HIR
    7393/    2638 : FE 3A               	CP	'9'+1
    7394/    263A : 38 0A               	JR	C,HI1
    7395/    263C : FE 41               	CP	'A'
    7396/    263E : 38 09               	JR	C,HIR
    7397/    2640 : FE 47               	CP	'F'+1
    7398/    2642 : 30 05               	JR	NC,HIR
    7399/    2644 : D6 07               	SUB	'A'-'9'-1
    7400/    2646 :                     HI1:
    7401/    2646 : D6 30               	SUB	'0'
    7402/    2648 : B1                  	OR	C
    7403/    2649 :                     HIR:
    7404/    2649 : C1                  	POP	BC
    7405/    264A : C9                  	RET
    7406/    264B :                     	
    7407/    264B :                     CRLF:
    7408/    264B : 3E 0D               	LD	A,CR
    7409/    264D : CD E5 2E            	CALL	CONOUT
    7410/    2650 : 3E 0A               	LD	A,LF
    7411/    2652 : C3 E5 2E            	JP	CONOUT
    7412/    2655 :                     
    7413/    2655 :                     CLR_CRT:
    7414/    2655 : E5                  	PUSH	HL
    7415/    2656 : 21 5E 26            	LD	HL, ESC_CRT_CLR
    7416/    2659 : CD 02 26            	CALL	STROUT
    7417/    265C : E1                  	POP	HL
    7418/    265D : C9                  	RET
    7419/    265E :                     	
    7420/    265E :                     ESC_CRT_CLR:
    7421/    265E : 1B                  	db	01BH
    7422/    265F : 5B 32               	db	"[2"
    7423/    2661 : 00                  	db	0
    7424/    2662 :                     
    7425/    2662 :                     GETLIN:
    7426/    2662 : 21 8D EF            	LD	HL,INBUF
    7427/    2665 : 06 28               	ld	b, BUFLEN
    7428/    2667 :                     
    7429/    2667 :                     GL0:	; input hl
    7430/    2667 :                     
    7431/    2667 : D5                  	PUSH	de
    7432/    2668 : E5                  	push	hl
    7433/    2669 : 58                  	ld	e, b	; E: buffer length
    7434/    266A : 1D                  	dec	e	; buffer lenght -1
    7435/    266B : 06 00               	LD	B,0
    7436/    266D :                     
    7437/    266D :                     GL00:
    7438/    266D : CD D4 2E            	CALL	CONIN
    7439/    2670 : FE 0D               	CP	CR
    7440/    2672 : 28 5A               	JR	Z,GLE
    7441/    2674 : FE 0A               	CP	LF
    7442/    2676 : 28 56               	JR	Z,GLE
    7443/    2678 : FE 08               	CP	BS
    7444/    267A : 28 3B               	JR	Z,GLB
    7445/    267C : FE 7F               	CP	DEL
    7446/    267E : 28 37               	JR	Z,GLB
    7447/    2680 : FE 22               	cp	'"'
    7448/    2682 : 20 0A               	jr	nz, GL001
    7449/    2684 : F5                  	push	af
    7450/    2685 : 3A 82 EF            	ld	a, (ky_flg)
    7451/    2688 : EE 04               	xor	NO_UPPER	; toggle UPPER or NO UPPER
    7452/    268A : 32 82 EF            	ld	(ky_flg), a
    7453/    268D : F1                  	pop	af
    7454/    268E :                     
    7455/    268E : FE 20               GL001:	CP	' '
    7456/    2690 : 38 DB               	JR	C,GL00
    7457/    2692 : FE 80               	CP	80H
    7458/    2694 : 30 D7               	JR	NC,GL00
    7459/    2696 : 4F                  	LD	C,A
    7460/    2697 : 78                  	LD	A,B
    7461/    2698 : BB                  	CP	e	; buffer full check
    7462/    2699 : 30 D2               	JR	NC,GL00	; Too long
    7463/    269B : 04                  	INC	B
    7464/    269C : 79                  	LD	A,C
    7465/    269D : CD E5 2E            	CALL	CONOUT
    7466/    26A0 : FE 61               	cp	'a'
    7467/    26A2 : 38 0F               	jr	c, GL1
    7468/    26A4 : FE 7B               	cp	'z'+1
    7469/    26A6 : 30 0B               	jr	nc, GL1
    7470/    26A8 :                     
    7471/    26A8 : E5                  	push	hl
    7472/    26A9 : 21 82 EF            	ld	hl, ky_flg
    7473/    26AC : CB 56               	bit	NO_UPPER>>1, (hl)
    7474/    26AE : 20 02               	jr	nz, skip_upper
    7475/    26B0 : E6 DF               	and	0DFH	; make upper code
    7476/    26B2 :                     skip_upper:
    7477/    26B2 : E1                  	pop	hl
    7478/    26B3 :                     GL1:
    7479/    26B3 : 77                  	LD	(HL),A
    7480/    26B4 : 23                  	INC	HL
    7481/    26B5 : 18 B6               	JR	GL00
    7482/    26B7 :                     GLB:
    7483/    26B7 : 78                  	LD	A,B
    7484/    26B8 : A7                  	AND	A
    7485/    26B9 : 28 B2               	JR	Z,GL00
    7486/    26BB : 05                  	DEC	B
    7487/    26BC : 2B                  	DEC	HL
    7488/    26BD : 3E 08               	LD	A,08H
    7489/    26BF : CD E5 2E            	CALL	CONOUT
    7490/    26C2 : 3E 20               	LD	A,' '
    7491/    26C4 : CD E5 2E            	CALL	CONOUT
    7492/    26C7 : 3E 08               	LD	A,08H
    7493/    26C9 : CD E5 2E            	CALL	CONOUT
    7494/    26CC : 18 9F               	JR	GL00
    7495/    26CE :                     GLE:
    7496/    26CE : E5                  	push	hl
    7497/    26CF : 21 82 EF            	ld	hl, ky_flg
    7498/    26D2 : CB 46               	bit	NO_CR>>1, (hl)
    7499/    26D4 : 20 05               	jr	nz, skip_cr
    7500/    26D6 : 3E 0D               	ld	a, CR
    7501/    26D8 : CD E5 2E            	call	CONOUT
    7502/    26DB :                     skip_cr:
    7503/    26DB : CB 4E               	bit	NO_LF>>1, (hl)
    7504/    26DD : 20 05               	jr	nz, skip_lf
    7505/    26DF : 3E 0A               	ld	a, LF
    7506/    26E1 : CD E5 2E            	call	CONOUT
    7507/    26E4 :                     skip_lf:
    7508/    26E4 : CB 96               	res	NO_UPPER>>1,(HL)	; set upper flag
    7509/    26E6 : E1                  	pop	hl
    7510/    26E7 : 36 00               	LD	(HL),00H
    7511/    26E9 :                     
    7512/    26E9 : E1                  	pop	hl
    7513/    26EA : D1                  	POP	de
    7514/    26EB : C9                  	RET
    7515/    26EC :                     
    7516/    26EC :                     SKIPSP:
    7517/    26EC : 7E                  	LD	A,(HL)
    7518/    26ED : FE 20               	CP	' '
    7519/    26EF : C0                  	RET	NZ
    7520/    26F0 : 23                  	INC	HL
    7521/    26F1 : 18 F9               	JR	SKIPSP
    7522/    26F3 :                     
    7523/    26F3 :                     UPPER:
    7524/    26F3 : FE 61               	CP	'a'
    7525/    26F5 : D8                  	RET	C
    7526/    26F6 : FE 7B               	CP	'z'+1
    7527/    26F8 : D0                  	RET	NC
    7528/    26F9 : C6 E0               	ADD	A,'A'-'a'
    7529/    26FB : C9                  	RET
    7530/    26FC :                     
    7531/    26FC :                     RDHEX:
    7532/    26FC : 0E 00               	LD	C,0
    7533/    26FE : 11 00 00            	LD	DE,0
    7534/    2701 :                     RH0:
    7535/    2701 : 7E                  	LD	A,(HL)
    7536/    2702 : FE 30               	CP	'0'
    7537/    2704 : 38 2C               	JR	C,RHE
    7538/    2706 : FE 3A               	CP	'9'+1
    7539/    2708 : 38 0A               	JR	C,RH1
    7540/    270A : FE 41               	CP	'A'
    7541/    270C : 38 24               	JR	C,RHE
    7542/    270E : FE 47               	CP	'F'+1
    7543/    2710 : 30 20               	JR	NC,RHE
    7544/    2712 : D6 07               	SUB	'A'-'9'-1
    7545/    2714 :                     RH1:
    7546/    2714 : D6 30               	SUB	'0'
    7547/    2716 : 17                  	RLA
    7548/    2717 : 17                  	RLA
    7549/    2718 : 17                  	RLA
    7550/    2719 : 17                  	RLA
    7551/    271A : 17                  	RLA
    7552/    271B : CB 13               	RL	E
    7553/    271D : CB 12               	RL	D
    7554/    271F : 17                  	RLA
    7555/    2720 : CB 13               	RL	E
    7556/    2722 : CB 12               	RL	D
    7557/    2724 : 17                  	RLA
    7558/    2725 : CB 13               	RL	E
    7559/    2727 : CB 12               	RL	D
    7560/    2729 : 17                  	RLA
    7561/    272A : CB 13               	RL	E
    7562/    272C : CB 12               	RL	D
    7563/    272E : 23                  	INC	HL
    7564/    272F : 0C                  	INC	C
    7565/    2730 : 18 CF               	JR	RH0
    7566/    2732 :                     RHE:
    7567/    2732 : 79                  	ld	a, c
    7568/    2733 : B7                  	or	a
    7569/    2734 : 28 06               	jr	z, rhe1
    7570/    2736 : FE 05               	cp	5
    7571/    2738 : 30 02               	jr	nc, rhe1
    7572/    273A : B7                  	or	a	; clear carry
    7573/    273B : C9                  	ret
    7574/    273C :                     	
    7575/    273C :                     rhe1:
    7576/    273C : 37                  	scf	; set carry
    7577/    273D : C9                  	RET
    7578/    273E :                     
    7579/    273E :                     ;;;
    7580/    273E :                     ;;; API Handler
    7581/    273E :                     ;;:   C : API entory NO.
    7582/    273E :                     ;;;
    7583/    273E :                     
    7584/    273E :                     RST30H_IN:
    7585/    273E :                     
    7586/    273E : E5                  	PUSH	HL
    7587/    273F : C5                  	PUSH	BC
    7588/    2740 : 21 5B 27            	LD	HL,APITBL
    7589/    2743 : 06 00               	LD	B,0
    7590/    2745 : 09                  	ADD	HL,BC
    7591/    2746 : 09                  	ADD	HL,BC
    7592/    2747 :                     
    7593/    2747 : 01 87 27            	ld	bc, APITBL_E
    7594/    274A : B7                  	or	a
    7595/    274B : E5                  	push	hl
    7596/    274C : ED 42               	sbc	hl, bc
    7597/    274E : E1                  	pop	hl
    7598/    274F : 30 07               	jr	nc, no_api	; request No. is not exist
    7599/    2751 :                     
    7600/    2751 : 46                  	LD	B,(HL)
    7601/    2752 : 23                  	INC	HL
    7602/    2753 : 66                  	LD	H,(HL)
    7603/    2754 : 68                  	LD	L,B
    7604/    2755 :                     
    7605/    2755 : C1                  	POP	BC
    7606/    2756 : E3                  	EX	(SP),HL		; Restore HL, jump address on stack top
    7607/    2757 :                     no_operate:
    7608/    2757 : C9                  	RET
    7609/    2758 :                     
    7610/    2758 :                     no_api:
    7611/    2758 : C1                  	pop	bc
    7612/    2759 : E1                  	pop	hl
    7613/    275A : C9                  	ret
    7614/    275B :                     
    7615/    275B :                     APITBL:
    7616/    275B : 7E 00               	DW	CSTART		; 00: CSTART
    7617/    275D : 87 27               	DW	API01		; 01: WSTART
    7618/    275F : E5 2E               	DW	CONOUT		; 02: CONOUT
    7619/    2761 : 02 26               	DW	STROUT		; 03: STROUT
    7620/    2763 : D4 2E               	DW	CONIN		; 04: CONIN
    7621/    2765 : DF 2E               	DW	CONST		; 05: CONST
    7622/    2767 : C9 27               	DW	API06		; 06: PSPEC
    7623/    2769 : 0B 26               	DW	HEXOUT4		; 07: CONOUT HEX4bytes: input HL
    7624/    276B : 10 26               	DW	HEXOUT2		; 08: CONOUT HEX2bytes: input A
    7625/    276D : 19 26               	DW	HEXOUT1		; 09: CONOUT HEX1byte : input A
    7626/    276F : 55 26               	DW	CLR_CRT		; 10: Clear screen (ESC+[2)
    7627/    2771 : 67 26               	DW	GL0		; 11: GET a line.  input HL : input buffer address)
    7628/    2773 :                     				;                         B : buffer length
    7629/    2773 :                     				;                  output B : length of strings
    7630/    2773 : EC 26               	DW	SKIPSP		; 12: SKIP Spase
    7631/    2775 : 4B 26               	DW	CRLF		; 13: CONOUT CRLF
    7632/    2777 : F3 26               	DW	UPPER		; 14: Lower to UPPER
    7633/    2779 : FC 26               	DW	RDHEX		; 15: get hex number from chr buffer
    7634/    277B :                     				;     input  HL : hex string buffer
    7635/    277B :                     				;     output DE : hex number
    7636/    277B :                     				;            CF=1 : error, C, A = hex counts(1-4)
    7637/    277B : 9C 29               	DW	DEC_STR		; 16: get decimal srtings
    7638/    277D :                     				; input hl : return strings buffer addr.
    7639/    277D :                     				;       de : 16bit binary
    7640/    277D : D2 29               	DW	DIV16_8		; 17; division 16bit / 8bit
    7641/    277F : 48 2A               	DW	MUL_8		; 18: multiply 8bit * 8bit
    7642/    2781 : =>TRUE              	IF RAM12K
    7643/    2781 : 00 29               	DW	STOPW		; 19: stopwatch
    7644/    2783 : =>FALSE             	ELSE
    7645/    2783 :                     	DW	no_operate	; 19: no operation : if RAM12K=0
    7646/    2783 : [7642]              	ENDIF
    7647/    2783 : F0 08               	dw	get_disasm_st	; 20: dis assemble string
    7648/    2785 :                     				;     input: HL buffer. need 42bytes
    7649/    2785 :                     				;     output : DE : next MC address
    7650/    2785 :                     				;              A  : disassembled MC size
    7651/    2785 : B3 02               	dw	GET_dNUM	; 21: get number from decimal strings
    7652/    2787 :                     				;     input HL : string buffer
    7653/    2787 :                     				;     Return
    7654/    2787 :                     				;        CF =1 : Error
    7655/    2787 :                     				;        BC: Calculation result
    7656/    2787 :                     APITBL_E:
    7657/    2787 :                     
    7658/    2787 :                     	;; WSTART from API
    7659/    2787 :                     API01:
    7660/    2787 : 31 00 EF            	LD	SP,STACKM	; reset SP for monitor
    7661/    278A :                     
    7662/    278A :                     ; check stop by bp and trace operation
    7663/    278A :                     
    7664/    278A : 3A 60 EF            	ld	a, (tmpb_f)
    7665/    278D : B7                  	or	a
    7666/    278E : 28 06               	jr	z, ws_chk1
    7667/    2790 : 21 61 EF            	ld	hl, tmpb_op
    7668/    2793 : CD B8 28            	call	rstr_tpt
    7669/    2796 :                     ws_chk1:
    7670/    2796 : 3A 50 EF            	ld	a, (tpt1_f)
    7671/    2799 : B7                  	or	a
    7672/    279A : 28 06               	jr	z, ws_chk2
    7673/    279C : 21 51 EF            	ld	hl, tpt1_op
    7674/    279F : CD B8 28            	call	rstr_tpt
    7675/    27A2 :                     
    7676/    27A2 :                     ws_chk2:
    7677/    27A2 : 3A 54 EF            	ld	a, (tpt2_f)
    7678/    27A5 : B7                  	or	a
    7679/    27A6 : 28 06               	jr	z, ws_chk3
    7680/    27A8 : 21 55 EF            	ld	hl, tpt2_op
    7681/    27AB : CD B8 28            	call	rstr_tpt
    7682/    27AE :                     ws_chk3:
    7683/    27AE : 3A 5C EF            	ld	a, (bpt2_f)
    7684/    27B1 : B7                  	or	a
    7685/    27B2 : 28 06               	jr	z, ws_chk4
    7686/    27B4 : 21 5D EF            	ld	hl, bpt2_op
    7687/    27B7 : CD C4 28            	call	rstr_bpt
    7688/    27BA :                     ws_chk4:
    7689/    27BA : 3A 58 EF            	ld	a, (bpt1_f)
    7690/    27BD : B7                  	or	a
    7691/    27BE : 28 06               	jr	z, ws_chk5
    7692/    27C0 : 21 59 EF            	ld	hl, bpt1_op
    7693/    27C3 : CD C4 28            	call	rstr_bpt
    7694/    27C6 :                     ws_chk5:
    7695/    27C6 : C3 8E 28            	JP	backTomon
    7696/    27C9 :                     
    7697/    27C9 :                     	;; PSPEC
    7698/    27C9 :                     API06:
    7699/    27C9 : AF                  	XOR	A
    7700/    27CA : C9                  	RET
    7701/    27CB :                     
    7702/    27CB :                     ;;;
    7703/    27CB :                     ;;; Break Point
    7704/    27CB :                     ;;; trace Point
    7705/    27CB :                     ;;; go, stop point
    7706/    27CB :                     ;;; operation handler
    7707/    27CB :                     ;;
    7708/    27CB :                     RST38H_IN:
    7709/    27CB : F5                  	PUSH	AF
    7710/    27CC : ED 5F               	LD	A,R
    7711/    27CE : 32 35 EF            	LD	(REGR),A
    7712/    27D1 : ED 57               	LD	A,I
    7713/    27D3 : 32 34 EF            	LD	(REGI),A
    7714/    27D6 : 22 22 EF            	LD	(REGHL),HL
    7715/    27D9 : ED 53 20 EF         	LD	(REGDE),DE
    7716/    27DD : ED 43 1E EF         	LD	(REGBC),BC
    7717/    27E1 : E1                  	POP	HL
    7718/    27E2 : 22 1C EF            	LD	(REGAF),HL
    7719/    27E5 : 08                  	EX	AF,AF'		;'
    7720/    27E6 : F5                  	PUSH	AF
    7721/    27E7 : D9                  	EXX
    7722/    27E8 : 22 2A EF            	LD	(REGHLX),HL
    7723/    27EB : ED 53 28 EF         	LD	(REGDEX),DE
    7724/    27EF : ED 43 26 EF         	LD	(REGBCX),BC
    7725/    27F3 : E1                  	POP	HL
    7726/    27F4 : 22 24 EF            	LD	(REGAFX),HL
    7727/    27F7 : DD 22 2C EF         	LD	(REGIX),IX
    7728/    27FB : FD 22 2E EF         	LD	(REGIY),IY
    7729/    27FF : E1                  	POP	HL
    7730/    2800 : 2B                  	DEC	HL
    7731/    2801 : 22 32 EF            	LD	(REGPC),HL
    7732/    2804 : ED 73 30 EF         	LD	(REGSP),SP
    7733/    2808 :                     
    7734/    2808 :                     ; check bp and trace operation
    7735/    2808 :                     
    7736/    2808 : 31 00 EF            	LD	SP,STACKM	; reset SP for monitor
    7737/    280B : AF                  	xor	a
    7738/    280C : 57                  	ld	d, a
    7739/    280D : 5F                  	ld	e, a		;clear msg pointer
    7740/    280E :                     
    7741/    280E :                     
    7742/    280E :                     ; check go, end operation
    7743/    280E : 3A 60 EF            	ld	a, (tmpb_f)
    7744/    2811 : B7                  	or	a
    7745/    2812 : 28 09               	jr	z, chk_bp
    7746/    2814 : 11 EE 28            	ld	de, stpBrk_msg
    7747/    2817 : 21 61 EF            	ld	hl, tmpb_op
    7748/    281A : CD B8 28            	call	rstr_tpt
    7749/    281D :                     
    7750/    281D :                     ; check set break point
    7751/    281D :                     
    7752/    281D :                     chk_bp:
    7753/    281D : 3A 5C EF            	ld	a, (bpt2_f)
    7754/    2820 : B7                  	or	a
    7755/    2821 : 28 09               	jr	z, bp_chk1
    7756/    2823 : 11 EE 28            	ld	de, stpBrk_msg
    7757/    2826 : 21 5D EF            	ld	hl, bpt2_op
    7758/    2829 : CD C4 28            	call	rstr_bpt
    7759/    282C :                     
    7760/    282C :                     bp_chk1:
    7761/    282C : 3A 58 EF            	ld	a, (bpt1_f)
    7762/    282F : B7                  	or	a
    7763/    2830 : 28 09               	jr	z, tp_chk1
    7764/    2832 : 11 EE 28            	ld	de, stpBrk_msg
    7765/    2835 : 21 59 EF            	ld	hl, bpt1_op
    7766/    2838 : CD C4 28            	call	rstr_bpt
    7767/    283B :                     
    7768/    283B :                     ; check trace operation
    7769/    283B :                     tp_chk1:
    7770/    283B : 3A 50 EF            	ld	a, (tpt1_f)
    7771/    283E : B7                  	or	a
    7772/    283F : 28 09               	jr	z, tp_chk2
    7773/    2841 : 11 F7 28            	ld	de, trace_msg
    7774/    2844 : 21 51 EF            	ld	hl, tpt1_op
    7775/    2847 : CD B8 28            	call	rstr_tpt
    7776/    284A :                     
    7777/    284A :                     tp_chk2:
    7778/    284A : 3A 54 EF            	ld	a, (tpt2_f)
    7779/    284D : B7                  	or	a
    7780/    284E : 28 09               	jr	z, bp_chk_end
    7781/    2850 :                     
    7782/    2850 : 11 F7 28            	ld	de, trace_msg
    7783/    2853 : 21 55 EF            	ld	hl, tpt2_op
    7784/    2856 : CD B8 28            	call	rstr_tpt
    7785/    2859 :                     
    7786/    2859 :                     bp_chk_end:
    7787/    2859 : 7A                  	ld	a, d
    7788/    285A : B3                  	or	e
    7789/    285B : 20 03               	jr	nz, no_rst38_msg
    7790/    285D :                     
    7791/    285D :                     	; set RST 38H message
    7792/    285D : 11 E4 28            	LD	de,RST38MSG
    7793/    2860 :                     
    7794/    2860 :                     no_rst38_msg:
    7795/    2860 : 1A                  	ld	a, (de)		; get first char of message
    7796/    2861 : FE 54               	cp	'T'		; trace ?
    7797/    2863 : 28 0C               	jr	z, chk_ntrace
    7798/    2865 :                     	
    7799/    2865 : EB                  	ex	de, hl
    7800/    2866 : CD 02 26            	CALL	STROUT
    7801/    2869 :                     
    7802/    2869 :                     	;; R register adjustment
    7803/    2869 :                     
    7804/    2869 : CD E3 17            	CALL	RDUMP
    7805/    286C : CD CB 28            	call	dis_call	; list disassemble
    7806/    286F : 18 1D               	jr	backTomon	; goto WBOOT
    7807/    2871 :                     
    7808/    2871 :                     ;
    7809/    2871 :                     ; check continue trace operation
    7810/    2871 :                     ;
    7811/    2871 :                     chk_ntrace:
    7812/    2871 : 3A 49 EF            	ld	a, (TP_mode)
    7813/    2874 : FE 46               	cp	'F'		; chk
    7814/    2876 : 28 0A               	jr	z, skp_rmsg
    7815/    2878 :                     
    7816/    2878 :                     ;no_trace:
    7817/    2878 : EB                  	ex	de, hl
    7818/    2879 : CD 02 26            	CALL	STROUT
    7819/    287C :                     
    7820/    287C :                     	;; R register adjustment
    7821/    287C :                     
    7822/    287C : CD E3 17            	CALL	RDUMP
    7823/    287F : CD CB 28            	call	dis_call	; list disassemble
    7824/    2882 :                     
    7825/    2882 :                     skp_rmsg:
    7826/    2882 : CD DF 2E            	call	CONST
    7827/    2885 : 28 13               	jr	z, t_no_ky		; no key in
    7828/    2887 : CD D4 2E            	call	CONIN
    7829/    288A : FE 03               	cp	03h	; chk CTL+C
    7830/    288C : 20 0C               	jr	nz, t_no_ky
    7831/    288E :                     
    7832/    288E :                     	; stop_trace
    7833/    288E :                     backTomon:
    7834/    288E : AF                  	xor	a
    7835/    288F : 32 4F EF            	ld	(fever_t), a	; clear forever flag
    7836/    2892 : 67                  	ld	h, a
    7837/    2893 : 6F                  	ld	l, a
    7838/    2894 : 22 4B EF            	ld	(TC_cnt), hl
    7839/    2897 : C3 2C 01            	JP	WSTART
    7840/    289A :                     	
    7841/    289A :                     	; check trace forever
    7842/    289A :                     t_no_ky:
    7843/    289A : 3A 4F EF            	ld	a, (fever_t)
    7844/    289D : B7                  	or	a
    7845/    289E : C2 AF 28            	jp	nz, repeat_trace
    7846/    28A1 :                     
    7847/    28A1 : 2A 4B EF            	ld	hl, (TC_cnt)
    7848/    28A4 : 2B                  	dec	hl
    7849/    28A5 : 22 4B EF            	ld	(TC_cnt), hl
    7850/    28A8 : 7D                  	ld	a, l
    7851/    28A9 : B4                  	or	h
    7852/    28AA : 20 03               	jr	nz, repeat_trace
    7853/    28AC : C3 2C 01            	JP	WSTART
    7854/    28AF :                     
    7855/    28AF :                     repeat_trace:
    7856/    28AF : 2A 32 EF            	ld	hl, (REGPC)
    7857/    28B2 : 22 4D EF            	ld	(tmpT), hl
    7858/    28B5 : C3 DF 04            	jp	t_op_chk
    7859/    28B8 :                     
    7860/    28B8 :                     rstr_tpt:	; HL=buffer point
    7861/    28B8 : E5                  	push	hl
    7862/    28B9 : 7E                  	ld	a, (hl)
    7863/    28BA : 23                  	inc	hl
    7864/    28BB : 4E                  	ld	c, (hl)
    7865/    28BC : 23                  	inc	hl
    7866/    28BD : 46                  	ld	b, (hl)
    7867/    28BE :                     
    7868/    28BE : 02                  	ld	(bc), a		; restor OP CODE
    7869/    28BF : E1                  	pop	hl
    7870/    28C0 : AF                  	xor	a
    7871/    28C1 : 2B                  	dec	hl
    7872/    28C2 : 77                  	ld	(hl), a		; clear trace flag
    7873/    28C3 : C9                  	ret
    7874/    28C4 :                     
    7875/    28C4 :                     rstr_bpt:	; HL=buffer point
    7876/    28C4 : 7E                  	ld	a, (hl)
    7877/    28C5 : 23                  	inc	hl
    7878/    28C6 : 4E                  	ld	c, (hl)
    7879/    28C7 : 23                  	inc	hl
    7880/    28C8 : 46                  	ld	b, (hl)
    7881/    28C9 :                     
    7882/    28C9 : 02                  	ld	(bc), a		; restor OP CODE
    7883/    28CA : C9                  	ret
    7884/    28CB :                     
    7885/    28CB :                     dis_call:
    7886/    28CB : 2A 32 EF            	ld	hl, (REGPC)
    7887/    28CE : 22 86 EF            	ld	(dasm_adr), hl	; set disasm address
    7888/    28D1 : CD 46 09            	call	dis_analysis
    7889/    28D4 : CD 0B 09            	call	mk_adr_str	; conout address and machine code
    7890/    28D7 : 21 8D EF            	ld	hl, adr_mc_buf
    7891/    28DA : CD 02 26            	call	STROUT		; conout disassemble strings
    7892/    28DD : 2A 32 EF            	ld	hl, (REGPC)
    7893/    28E0 : 22 86 EF            	ld	(dasm_adr), hl	; restrore disasm address
    7894/    28E3 : C9                  	ret
    7895/    28E4 :                     
    7896/    28E4 :                     RST38MSG:
    7897/    28E4 : 52 53 54 20 33 38   	DB	"RST 38H",CR,LF,00H
             28EA : 48 0D 0A 00       
    7898/    28EE :                     stpBrk_msg:	
    7899/    28EE : 42 72 65 61 6B 21   	db	"Break!",CR,LF,00H
             28F4 : 0D 0A 00          
    7900/    28F7 :                     trace_msg:	
    7901/    28F7 : 54 72 61 63 65 21   	db	"Trace!",CR,LF,00H
             28FD : 0D 0A 00          
    7902/    2900 :                     
    7903/    2900 : =>TRUE              	IF RAM12K
    7904/    2900 :                     STOPW:
    7905/    2900 :                     	; (input) A = 0 : start timer, (output) none
    7906/    2900 :                     	; (input) A = 1 : stop timer,  (output) BC : msec time, DE : Sec time
    7907/    2900 :                     	; (input) A = 2 : lap timer,   (output) BC : msec time, DE : Sec time
    7908/    2900 :                     	; (input) A = 3 : clear timer counter,  (output) none
    7909/    2900 :                     
    7910/    2900 : F5                  	push	af
    7911/    2901 : E5                  	push	hl
    7912/    2902 : B7                  	or	a
    7913/    2903 : 28 0F               	jr	z, start_tim
    7914/    2905 : FE 01               	cp	1
    7915/    2907 : 28 14               	jr	z, stop_tim
    7916/    2909 : FE 02               	cp	2
    7917/    290B : 28 16               	jr	z, lap_tim
    7918/    290D : FE 03               	cp	3
    7919/    290F : 28 50               	jr	z, clr_tim
    7920/    2911 : E1                  	pop	hl
    7921/    2912 : F1                  	pop	af
    7922/    2913 : C9                  	ret
    7923/    2914 :                     
    7924/    2914 :                     start_tim:
    7925/    2914 : 21 00 F8            	ld	hl, TIM0_CTL0
    7926/    2917 : 3E 90               	ld	a, 90h
    7927/    2919 : 77                  	ld	(hl),a		; enable timer 0
    7928/    291A : E1                  	pop	hl
    7929/    291B : F1                  	pop	af
    7930/    291C : C9                  	ret
    7931/    291D :                     	
    7932/    291D :                     stop_tim:
    7933/    291D : 21 00 F8            	ld	hl, TIM0_CTL0
    7934/    2920 : 3E 10               	ld	a, 10h
    7935/    2922 : 77                  	ld	(hl), a		; disable timer 0
    7936/    2923 :                     
    7937/    2923 :                     	; save timer counter
    7938/    2923 :                     
    7939/    2923 :                     lap_tim:
    7940/    2923 : 3A 10 F8            	ld	a, (TIMER0_CNTL)
    7941/    2926 : 32 39 EF            	ld	(c16b), a
    7942/    2929 : 3A 11 F8            	ld	a, (TIMER0_CNTH)
    7943/    292C : 32 3A EF            	ld	(c16b+1), a
    7944/    292F :                     
    7945/    292F :                     ; adjust 16bit counter
    7946/    292F :                     
    7947/    292F : 01 E1 87            	ld	bc, TIMER0_INITC
    7948/    2932 : 2A 39 EF            	ld	hl, (c16b)
    7949/    2935 : 7C                  	ld	a, h
    7950/    2936 : B5                  	or	l	; HL = 0?
    7951/    2937 : 20 06               	jr	nz, adj_tim1
    7952/    2939 : ED 43 39 EF         	ld	(c16b), bc
    7953/    293D : 18 05               	jr	rd_sec
    7954/    293F :                     
    7955/    293F :                     adj_tim1:
    7956/    293F : ED 42               	sbc	hl, bc
    7957/    2941 : 22 39 EF            	ld	(c16b), hl
    7958/    2944 :                     
    7959/    2944 :                     ; read seconds counter
    7960/    2944 :                     
    7961/    2944 :                     rd_sec:
    7962/    2944 : 3A 20 F8            	ld	a, (TIMER0_SCTL)
    7963/    2947 : 32 3B EF            	ld	(secb), a
    7964/    294A : 3A 21 F8            	ld	a, (TIMER0_SCTH)
    7965/    294D : 32 3C EF            	ld	(secb+1), a
    7966/    2950 :                     
    7967/    2950 :                     	; convert msec from 16bit counter
    7968/    2950 :                     
    7969/    2950 : 2A 39 EF            	ld	hl,(c16b)
    7970/    2953 : CD 80 29            	call	chg_msec	; result BC
    7971/    2956 : ED 43 3D EF         	ld	(msecb),bc	; save result
    7972/    295A : ED 5B 3B EF         	ld	de,(secb)	; get sec counter
    7973/    295E : E1                  	pop	hl
    7974/    295F : F1                  	pop	af
    7975/    2960 : C9                  	ret
    7976/    2961 :                     
    7977/    2961 :                     clr_tim:
    7978/    2961 : AF                  	xor	a
    7979/    2962 : 67                  	ld	h, a
    7980/    2963 : 6F                  	ld	l, a
    7981/    2964 : 22 3D EF            	ld	(msecb), hl
    7982/    2967 : 22 3B EF            	ld	(secb), hl
    7983/    296A : 22 39 EF            	ld	(c16b), hl
    7984/    296D :                     	
    7985/    296D : 32 20 F8            	ld	(TIMER0_SCTL), a
    7986/    2970 : 32 21 F8            	ld	(TIMER0_SCTH), a
    7987/    2973 : 3E E8               	ld	a, 0e8h
    7988/    2975 : 32 10 F8            	ld	(TIMER0_CNTL), a
    7989/    2978 : 3E 86               	ld	a, 86H
    7990/    297A : 32 11 F8            	ld	(TIMER0_CNTH), a
    7991/    297D : E1                  	pop	hl
    7992/    297E : F1                  	pop	af
    7993/    297F : C9                  	ret
    7994/    2980 :                     
    7995/    2980 :                     chg_msec:
    7996/    2980 : AF                  	xor	a
    7997/    2981 : 47                  	ld	b, a
    7998/    2982 : 4F                  	ld	c ,a		;cear BC
    7999/    2983 : 2A 39 EF            	ld	hl, (c16b)	; get 16bit counter
    8000/    2986 : 7D                  	ld	a, l
    8001/    2987 :                     u_00:
    8002/    2987 : FE 1F               	cp	31
    8003/    2989 : 38 06               	jr	c, u_1
    8004/    298B : D6 1F               	sub	31
    8005/    298D :                     u_0:
    8006/    298D : 6F                  	ld	l, a
    8007/    298E : 03                  	inc	bc
    8008/    298F : 18 F6               	jr	u_00
    8009/    2991 :                     
    8010/    2991 :                     u_1:
    8011/    2991 : 7C                  	ld	a, h
    8012/    2992 : B7                  	or	a
    8013/    2993 : C8                  	ret	z	; can't sub
    8014/    2994 :                     
    8015/    2994 : 7D                  	ld	a, l
    8016/    2995 : D6 1F               	sub	31
    8017/    2997 : ED 44               	neg
    8018/    2999 : 25                  	dec	h
    8019/    299A : 18 F1               	jr	u_0
    8020/    299C :                     
    8021/    299C : [7903]              	ENDIF
    8022/    299C :                     
    8023/    299C :                     ;
    8024/    299C :                     ; make decimal string
    8025/    299C :                     ;
    8026/    299C :                     ; input HL : output string buffer
    8027/    299C :                     ;       DE : 16bit binary
    8028/    299C :                     ;
    8029/    299C :                     ; output (HL) : decimal strings
    8030/    299C :                     
    8031/    299C :                     DEC_STR:
    8032/    299C : F5                  	PUSH	AF
    8033/    299D : C5                  	PUSH	BC
    8034/    299E : D5                  	PUSH	DE
    8035/    299F : E5                  	push	hl
    8036/    29A0 : DD E5               	push	ix
    8037/    29A2 :                     
    8038/    29A2 : E5                  	push	hl
    8039/    29A3 : DD E1               	pop	ix		; ix: save buffer top address
    8040/    29A5 :                     
    8041/    29A5 : EB                  	ex	de, hl		; hl: 16bit binary, de: buffer
    8042/    29A6 : E5                  	push	hl		; save 16bit binary
    8043/    29A7 : 21 05 00            	ld	hl, 5
    8044/    29AA : 19                  	add	hl, de		; hl = buffer + 5
    8045/    29AB : AF                  	xor	a
    8046/    29AC : 77                  	ld	(hl), A
    8047/    29AD : EB                  	ex	de, hl		; de: buffer + 5, hl : buffer
    8048/    29AE : E1                  	pop	hl		; hl : 16bit binary
    8049/    29AF : 01 01 00            	LD	BC, 1
    8050/    29B2 :                     
    8051/    29B2 :                     LOOP_DEC:
    8052/    29B2 : 3E 0A               	LD	A, 10
    8053/    29B4 : CD D2 29            	CALL	DIV16_8
    8054/    29B7 : F6 30               	OR	30H
    8055/    29B9 : 1B                  	DEC	DE
    8056/    29BA : 12                  	LD	(DE), A
    8057/    29BB : 0C                  	INC	C
    8058/    29BC : 7C                  	LD	A, H
    8059/    29BD : B5                  	OR	L
    8060/    29BE : 20 F2               	JR	NZ, LOOP_DEC
    8061/    29C0 :                     
    8062/    29C0 : 79                  	LD	A, C
    8063/    29C1 : FE 06               	CP	6
    8064/    29C3 : 28 06               	JR	Z, END_DEC
    8065/    29C5 :                     
    8066/    29C5 : DD E5               	push	ix
    8067/    29C7 : E1                  	pop	hl		; hl : buffer top address
    8068/    29C8 : EB                  	EX	DE, HL
    8069/    29C9 : ED B0               	LDIR
    8070/    29CB :                     
    8071/    29CB :                     END_DEC:
    8072/    29CB : DD E1               	pop	ix
    8073/    29CD : E1                  	pop	hl
    8074/    29CE : D1                  	POP	DE
    8075/    29CF : C1                  	POP	BC
    8076/    29D0 : F1                  	POP	AF
    8077/    29D1 : C9                  	RET
    8078/    29D2 :                     
    8079/    29D2 :                     
    8080/    29D2 :                     ; DIV 16bit / 8 bit
    8081/    29D2 :                     ; input
    8082/    29D2 :                     ;	HL, A
    8083/    29D2 :                     ; output
    8084/    29D2 :                     ;	result = HL, mod = A
    8085/    29D2 :                     
    8086/    29D2 :                     DIV16_8:
    8087/    29D2 : C5                  	PUSH	BC
    8088/    29D3 : D5                  	PUSH	DE
    8089/    29D4 :                     
    8090/    29D4 : 4F                  	LD	C, A
    8091/    29D5 : 06 0F               	LD	B, 15
    8092/    29D7 : AF                  	XOR	A
    8093/    29D8 : 29                  	ADD	HL, HL
    8094/    29D9 : 17                  	RLA
    8095/    29DA : 91                  	SUB	C
    8096/    29DB : 38 0D               	JR	C, D16_MINUS_BEFORE
    8097/    29DD : 29                  	ADD	HL, HL
    8098/    29DE : 2C                  	INC	L
    8099/    29DF :                     
    8100/    29DF :                     D16_PLUS:
    8101/    29DF : 17                  	RLA
    8102/    29E0 : 91                  	SUB	C
    8103/    29E1 : 38 0C               	JR	C, D16_MINUS_AFTER
    8104/    29E3 :                     
    8105/    29E3 :                     D16_PLUS_AFTER:
    8106/    29E3 : 29                  	ADD	HL, HL
    8107/    29E4 : 2C                  	INC	L
    8108/    29E5 : 10 F8               	DJNZ	D16_PLUS
    8109/    29E7 : C3 F3 29            	JP	D16_END
    8110/    29EA :                     
    8111/    29EA :                     D16_MINUS_BEFORE:
    8112/    29EA : 29                  	ADD	HL, HL
    8113/    29EB :                     
    8114/    29EB :                     D16_MINUS:
    8115/    29EB : 17                  	RLA
    8116/    29EC : 81                  	ADD	A, C
    8117/    29ED : 38 F4               	JR	C, D16_PLUS_AFTER
    8118/    29EF :                     
    8119/    29EF :                     D16_MINUS_AFTER:
    8120/    29EF : 29                  	ADD	HL, HL
    8121/    29F0 : 10 F9               	DJNZ	D16_MINUS
    8122/    29F2 : 81                  	ADD	A,C
    8123/    29F3 :                     D16_END:
    8124/    29F3 : D1                  	POP	DE
    8125/    29F4 : C1                  	POP	BC
    8126/    29F5 : C9                  	RET
    8127/    29F6 :                     
    8128/    29F6 :                     ;
    8129/    29F6 :                     ; input : HL / DE
    8130/    29F6 :                     ; output : quotient HL
    8131/    29F6 :                     ;	   remainder DE
    8132/    29F6 :                     
    8133/    29F6 :                     DIV16:
    8134/    29F6 : 22 3F EF            	LD	(DIV16_NA), HL
    8135/    29F9 : ED 53 41 EF         	LD	(DIV16_NB), DE
    8136/    29FD :                     
    8137/    29FD : AF                  	XOR	A
    8138/    29FE : 32 43 EF            	LD	(DIV16_NC), A
    8139/    2A01 : 32 44 EF            	LD	(DIV16_NC+1), A
    8140/    2A04 : 32 45 EF            	LD	(DIV16_ND), A
    8141/    2A07 : 32 46 EF            	LD	(DIV16_ND+1), A
    8142/    2A0A : 06 10               	LD	B, 16
    8143/    2A0C :                     
    8144/    2A0C :                     DIV16_X2:
    8145/    2A0C : 21 43 EF            	LD	HL, DIV16_NC
    8146/    2A0F : CB 26               	SLA	(HL)
    8147/    2A11 : 23                  	INC	HL
    8148/    2A12 : CB 16               	RL	(HL)
    8149/    2A14 :                     
    8150/    2A14 : 21 3F EF            	LD	HL, DIV16_NA
    8151/    2A17 : CB 26               	SLA	(HL)
    8152/    2A19 : 23                  	INC	HL
    8153/    2A1A : CB 16               	RL	(HL)
    8154/    2A1C : 21 45 EF            	LD	HL, DIV16_ND
    8155/    2A1F : CB 16               	RL	(HL)
    8156/    2A21 : 23                  	INC	HL
    8157/    2A22 : CB 16               	RL	(HL)
    8158/    2A24 :                     
    8159/    2A24 : 2A 41 EF            	LD	HL, (DIV16_NB)
    8160/    2A27 : 5D                  	LD	E, L
    8161/    2A28 : 54                  	LD	D, H
    8162/    2A29 : 2A 45 EF            	LD	HL, (DIV16_ND)
    8163/    2A2C : AF                  	XOR	A
    8164/    2A2D : ED 52               	SBC	HL, DE
    8165/    2A2F : 30 02               	JR	NC, DIV16_X0
    8166/    2A31 : 18 0B               	JR	DIV16_X1
    8167/    2A33 :                     
    8168/    2A33 :                     DIV16_X0:
    8169/    2A33 : 22 45 EF            	LD	(DIV16_ND), HL
    8170/    2A36 :                     
    8171/    2A36 : 3A 43 EF            	LD	A, (DIV16_NC)
    8172/    2A39 : F6 01               	OR	1
    8173/    2A3B : 32 43 EF            	LD	(DIV16_NC), A
    8174/    2A3E :                     
    8175/    2A3E :                     DIV16_X1:
    8176/    2A3E : 10 CC               	DJNZ	DIV16_X2
    8177/    2A40 :                     
    8178/    2A40 : 2A 43 EF            	LD	HL,(DIV16_NC)
    8179/    2A43 : ED 5B 45 EF         	LD	DE,(DIV16_ND)
    8180/    2A47 : C9                  	RET
    8181/    2A48 :                     
    8182/    2A48 :                     ; 8bit * 8bit : ans = 16bit
    8183/    2A48 :                     ; input A , BC
    8184/    2A48 :                     ; output HL
    8185/    2A48 :                     
    8186/    2A48 :                     MUL_8:
    8187/    2A48 : F5                  	PUSH	AF
    8188/    2A49 : C5                  	PUSH	BC
    8189/    2A4A : B7                  	OR	A	; clear carry
    8190/    2A4B : 18 04               	JR	ST_MUL8
    8191/    2A4D :                     
    8192/    2A4D :                     LOOP_M8:
    8193/    2A4D : CB 21               	SLA	C
    8194/    2A4F : CB 10               	RL	B
    8195/    2A51 :                     
    8196/    2A51 :                     ST_MUL8:
    8197/    2A51 : 1F                  	RRA
    8198/    2A52 : 30 F9               	JR	NC, LOOP_M8
    8199/    2A54 : 09                  	ADD	HL, BC
    8200/    2A55 : 20 F6               	JR	NZ, LOOP_M8
    8201/    2A57 : C1                  	POP	BC
    8202/    2A58 : F1                  	POP	AF
    8203/    2A59 : C9                  	RET
    8204/    2A5A :                     ;;;
    8205/    2A5A :                     ;;; Messages
    8206/    2A5A :                     ;;;
    8207/    2A5A :                     
    8208/    2A5A : 3F 20 3A 43 6F 6D   cmd_hlp:	db	"? :Command Help", CR, LF
             2A60 : 6D 61 6E 64 20 48 
             2A66 : 65 6C 70 0D 0A    
    8209/    2A6B :                     
    8210/    2A6B : =>TRUE              	if (SuperMEZ80=0) || (SMEZ80Full=1)
    8211/    2A6B : 23 4C 7C 3C 6E 75   		db	"#L|<num> :Launch program", CR, LF
             2A71 : 6D 3E 20 3A 4C 61 
             2A77 : 75 6E 63 68 20 70 
             2A7D : 72 6F 67 72 61 6D 
             2A83 : 0D 0A             
    8212/    2A85 : [8210]              	endif
    8213/    2A85 : 41 5B 3C 61 64 64   		db	"A[<address>] : Mini Assemble mode", CR, LF
             2A8B : 72 65 73 73 3E 5D 
             2A91 : 20 3A 20 4D 69 6E 
             2A97 : 69 20 41 73 73 65 
             2A9D : 6D 62 6C 65 20 6D 
             2AA3 : 6F 64 65 0D 0A    
    8214/    2AA8 : 42 5B 31 7C 32 5B   		db	"B[1|2[,<adr>]] :Set or List Break Point", CR, LF
             2AAE : 2C 3C 61 64 72 3E 
             2AB4 : 5D 5D 20 3A 53 65 
             2ABA : 74 20 6F 72 20 4C 
             2AC0 : 69 73 74 20 42 72 
             2AC6 : 65 61 6B 20 50 6F 
             2ACC : 69 6E 74 0D 0A    
    8215/    2AD1 : 42 43 5B 31 7C 32   		db	"BC[1|2] :Clear Break Point", CR, LF
             2AD7 : 5D 20 3A 43 6C 65 
             2ADD : 61 72 20 42 72 65 
             2AE3 : 61 6B 20 50 6F 69 
             2AE9 : 6E 74 0D 0A       
    8216/    2AED : 44 5B 3C 61 64 72   		db	"D[<adr>] :Dump Memory", CR, LF
             2AF3 : 3E 5D 20 3A 44 75 
             2AF9 : 6D 70 20 4D 65 6D 
             2AFF : 6F 72 79 0D 0A    
    8217/    2B04 : 44 49 5B 3C 61 64   		db	"DI[<adr>][,s<steps>|<adr>] :Disassemble", CR, LF
             2B0A : 72 3E 5D 5B 2C 73 
             2B10 : 3C 73 74 65 70 73 
             2B16 : 3E 7C 3C 61 64 72 
             2B1C : 3E 5D 20 3A 44 69 
             2B22 : 73 61 73 73 65 6D 
             2B28 : 62 6C 65 0D 0A    
    8218/    2B2D : 47 5B 3C 61 64 72   		db	"G[<adr>][,<stop adr>] :Go and Stop", CR, LF
             2B33 : 3E 5D 5B 2C 3C 73 
             2B39 : 74 6F 70 20 61 64 
             2B3F : 72 3E 5D 20 3A 47 
             2B45 : 6F 20 61 6E 64 20 
             2B4B : 53 74 6F 70 0D 0A 
    8219/    2B51 : 4C 5B 47 7C 3C 6F   		db	"L[G|<offset>] :Load HexFile (and GO)", CR, LF
             2B57 : 66 66 73 65 74 3E 
             2B5D : 5D 20 3A 4C 6F 61 
             2B63 : 64 20 48 65 78 46 
             2B69 : 69 6C 65 20 28 61 
             2B6F : 6E 64 20 47 4F 29 
             2B75 : 0D 0A             
    8220/    2B77 : 50 5B 49 7C 53 5D   		db	"P[I|S] :Save HexFile(I:Intel,S:Motorola)", CR, LF
             2B7D : 20 3A 53 61 76 65 
             2B83 : 20 48 65 78 46 69 
             2B89 : 6C 65 28 49 3A 49 
             2B8F : 6E 74 65 6C 2C 53 
             2B95 : 3A 4D 6F 74 6F 72 
             2B9B : 6F 6C 61 29 0D 0A 
    8221/    2BA1 : 52 5B 3C 72 65 67   		db	"R[<reg>] :Set or Dump register", CR, LF
             2BA7 : 3E 5D 20 3A 53 65 
             2BAD : 74 20 6F 72 20 44 
             2BB3 : 75 6D 70 20 72 65 
             2BB9 : 67 69 73 74 65 72 
             2BBF : 0D 0A             
    8222/    2BC1 : 53 5B 3C 61 64 72   		db	"S[<adr>] :Set Memory", CR, LF
             2BC7 : 3E 5D 20 3A 53 65 
             2BCD : 74 20 4D 65 6D 6F 
             2BD3 : 72 79 0D 0A       
    8223/    2BD7 : 54 5B 3C 61 64 72   		db	"T[<adr>][,<steps>|-1] : Trace command", CR, LF
             2BDD : 3E 5D 5B 2C 3C 73 
             2BE3 : 74 65 70 73 3E 7C 
             2BE9 : 2D 31 5D 20 3A 20 
             2BEF : 54 72 61 63 65 20 
             2BF5 : 63 6F 6D 6D 61 6E 
             2BFB : 64 0D 0A          
    8224/    2BFE : 54 4D 5B 49 7C 53   		db	"TM[I|S] :Trace Option for CALL", CR, LF
             2C04 : 5D 20 3A 54 72 61 
             2C0A : 63 65 20 4F 70 74 
             2C10 : 69 6F 6E 20 66 6F 
             2C16 : 72 20 43 41 4C 4C 
             2C1C : 0D 0A             
    8225/    2C1E : 54 50 5B 4F 4E 7C   		db	"TP[ON|OFF] :Trace Print Mode", CR, LF, 00h
             2C24 : 4F 46 46 5D 20 3A 
             2C2A : 54 72 61 63 65 20 
             2C30 : 50 72 69 6E 74 20 
             2C36 : 4D 6F 64 65 0D 0A 
             2C3C : 00                
    8226/    2C3D :                     
    8227/    2C3D :                     OPNMSG:
    8228/    2C3D : 0D 0A               	DB	CR,LF
    8229/    2C3F :                     
    8230/    2C3F : =>FALSE             	if SuperMEZ80
    8231/    2C3F :                     	db	"EMUZ80 MONITOR Rev.B05 for SuperMEZ80",CR,LF
    8232/    2C3F : =>TRUE              	else
    8233/    2C3F : 45 4D 55 5A 38 30   	db	"EMUZ80 MONITOR Rev.B05",CR,LF
             2C45 : 20 4D 4F 4E 49 54 
             2C4B : 4F 52 20 52 65 76 
             2C51 : 2E 42 30 35 0D 0A 
    8234/    2C57 : [8230]              	endif
    8235/    2C57 :                     	
    8236/    2C57 : 54 68 69 73 20 6D   	db	"This monitor is based on unimon.",CR,LF,00H
             2C5D : 6F 6E 69 74 6F 72 
             2C63 : 20 69 73 20 62 61 
             2C69 : 73 65 64 20 6F 6E 
             2C6F : 20 75 6E 69 6D 6F 
             2C75 : 6E 2E 0D 0A 00    
    8237/    2C7A :                     
    8238/    2C7A :                     PROMPT:
    8239/    2C7A : 5D 20 00            	DB	"] ",00H
    8240/    2C7D :                     
    8241/    2C7D :                     IHEMSG:
    8242/    2C7D : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             2C83 : 69 68 65 78 0D 0A 
             2C89 : 00                
    8243/    2C8A :                     SHEMSG:
    8244/    2C8A : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             2C90 : 73 72 65 63 0D 0A 
             2C96 : 00                
    8245/    2C97 :                     ERRMSG:
    8246/    2C97 : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             2C9D : 0A 00             
    8247/    2C9F :                     
    8248/    2C9F :                     DSEP0:
    8249/    2C9F : 20 3A 00            	DB	" :",00H
    8250/    2CA2 :                     DSEP1:
    8251/    2CA2 : 20 7C 20 00         	DB	" | ",00H
    8252/    2CA6 :                     
    8253/    2CA6 : 20 20 00            dsap	db	"  ", 00
    8254/    2CA9 :                     
    8255/    2CA9 :                     IHEXER:
    8256/    2CA9 : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             2CAF : 30 30 31 46 46 0D 
             2CB5 : 0A 00             
    8257/    2CB7 :                     SRECER:
    8258/    2CB7 : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             2CBD : 30 30 46 43 0D 0A 
             2CC3 : 00                
    8259/    2CC4 :                     
    8260/    2CC4 :                     	;; Register dump table
    8261/    2CC4 : 19 2D 1D EF         RDTAB:	DW	RDSA,   REGAF+1
    8262/    2CC8 : 01                  	DB	1
    8263/    2CC9 : 1D 2D 1E EF         	DW	RDSBC,  REGBC
    8264/    2CCD : 02                  	DB	2
    8265/    2CCE : 23 2D 20 EF         	DW	RDSDE,  REGDE
    8266/    2CD2 : 02                  	DB	2
    8267/    2CD3 : 29 2D 22 EF         	DW	RDSHL,  REGHL
    8268/    2CD7 : 02                  	DB	2
    8269/    2CD8 : 2F 2D 1C EF         	DW	RDSF,   REGAF
    8270/    2CDC : 01                  	DB	1
    8271/    2CDD :                     
    8272/    2CDD : 34 2D 2C EF         	DW	RDSIX,  REGIX
    8273/    2CE1 : 02                  	DB	2
    8274/    2CE2 : 39 2D 2E EF         	DW	RDSIY,  REGIY
    8275/    2CE6 : 02                  	DB	2
    8276/    2CE7 :                     
    8277/    2CE7 : 3E 2D 25 EF         	DW	RDSAX,  REGAFX+1
    8278/    2CEB : 01                  	DB	1
    8279/    2CEC : 44 2D 26 EF         	DW	RDSBCX, REGBCX
    8280/    2CF0 : 02                  	DB	2
    8281/    2CF1 : 4A 2D 28 EF         	DW	RDSDEX, REGDEX
    8282/    2CF5 : 02                  	DB	2
    8283/    2CF6 : 50 2D 2A EF         	DW	RDSHLX, REGHLX
    8284/    2CFA : 02                  	DB	2
    8285/    2CFB : 56 2D 24 EF         	DW	RDSFX,  REGAFX
    8286/    2CFF : 01                  	DB	1
    8287/    2D00 :                     
    8288/    2D00 : 5B 2D 30 EF         	DW	RDSSP,  REGSP
    8289/    2D04 : 02                  	DB	2
    8290/    2D05 : 60 2D 32 EF         	DW	RDSPC,  REGPC
    8291/    2D09 : 02                  	DB	2
    8292/    2D0A : 65 2D 34 EF         	DW	RDSI,   REGI
    8293/    2D0E : 01                  	DB	1
    8294/    2D0F : 69 2D 35 EF         	DW	RDSR,   REGR
    8295/    2D13 : 01                  	DB	1
    8296/    2D14 :                     
    8297/    2D14 : 00 00 00 00         	DW	0000H,  0000H
    8298/    2D18 : 00                  	DB	0
    8299/    2D19 :                     
    8300/    2D19 : 41 20 3D 00         RDSA:	DB	"A =",00H
    8301/    2D1D : 20 42 43 20 3D 00   RDSBC:	DB	" BC =",00H
    8302/    2D23 : 20 44 45 20 3D 00   RDSDE:	DB	" DE =",00H
    8303/    2D29 : 20 48 4C 20 3D 00   RDSHL:	DB	" HL =",00H
    8304/    2D2F :                     
    8305/    2D2F : 20 46 20 3D 00      RDSF:	DB	" F =",00H
    8306/    2D34 :                     
    8307/    2D34 : =2DH                RDSF_H	equ	RDSF >> 8
    8308/    2D34 : =2FH                RDSF_L	equ	RDSF & 0FFh
    8309/    2D34 :                     
    8310/    2D34 :                     
    8311/    2D34 : 20 49 58 3D 00      RDSIX:	DB	" IX=",00H
    8312/    2D39 : 20 49 59 3D 00      RDSIY:	DB	" IY=",00H
    8313/    2D3E : 0D 0A 41 27 3D 00   RDSAX:	DB	CR,LF,"A'=",00H
    8314/    2D44 : 20 42 43 27 3D 00   RDSBCX:	DB	" BC'=",00H
    8315/    2D4A : 20 44 45 27 3D 00   RDSDEX:	DB	" DE'=",00H
    8316/    2D50 : 20 48 4C 27 3D 00   RDSHLX:	DB	" HL'=",00H
    8317/    2D56 :                     
    8318/    2D56 : 20 46 27 3D 00      RDSFX:	DB	" F'=",00H
    8319/    2D5B :                     
    8320/    2D5B : =2DH                RDSFX_H	equ	RDSFX >> 8
    8321/    2D5B : =56H                RDSFX_L	equ	RDSFX & 0FFh
    8322/    2D5B :                     
    8323/    2D5B : 20 53 50 3D 00      RDSSP:	DB	" SP=",00H
    8324/    2D60 : 20 50 43 3D 00      RDSPC:	DB	" PC=",00H
    8325/    2D65 : 20 49 3D 00         RDSI:	DB	" I=",00H
    8326/    2D69 : 20 52 3D 00         RDSR:	DB	" R=",00H
    8327/    2D6D :                     
    8328/    2D6D :                     RNTAB:
    8329/    2D6D : 41 0F               	DB	'A',0FH		; "A?"
    8330/    2D6F : B7 2D 00 00         	DW	RNTABA,0
    8331/    2D73 : 42 0F               	DB	'B',0FH		; "B?"
    8332/    2D75 : C5 2D 00 00         	DW	RNTABB,0
    8333/    2D79 : 43 0F               	DB	'C',0FH		; "C?"
    8334/    2D7B : E7 2D 00 00         	DW	RNTABC,0
    8335/    2D7F : 44 0F               	DB	'D',0FH		; "D?"
    8336/    2D81 : F5 2D 00 00         	DW	RNTABD,0
    8337/    2D85 : 45 0F               	DB	'E',0FH		; "E?"
    8338/    2D87 : 17 2E 00 00         	DW	RNTABE,0
    8339/    2D8B : 46 0F               	DB	'F',0FH		; "F?"
    8340/    2D8D : 25 2E 00 00         	DW	RNTABF,0
    8341/    2D91 : 48 0F               	DB	'H',0FH		; "H?"
    8342/    2D93 : 33 2E 00 00         	DW	RNTABH,0
    8343/    2D97 : 49 0F               	DB	'I',0FH		; "I?"
    8344/    2D99 : 63 2E 00 00         	DW	RNTABI,0
    8345/    2D9D : 4C 0F               	DB	'L',0FH		; "L?"
    8346/    2D9F : 55 2E 00 00         	DW	RNTABL,0
    8347/    2DA3 : 50 0F               	DB	'P',0FH		; "P?"
    8348/    2DA5 : 77 2E 00 00         	DW	RNTABP,0
    8349/    2DA9 : 52 01               	DB	'R',1		; "R"
    8350/    2DAB : 35 EF D2 2E         	DW	REGR,RNR
    8351/    2DAF : 53 0F               	DB	'S',0FH		; "S?"
    8352/    2DB1 : 7F 2E 00 00         	DW	RNTABS,0
    8353/    2DB5 :                     
    8354/    2DB5 : 00 00               	DB	00H,0		; End mark
    8355/    2DB7 :                     
    8356/    2DB7 :                     RNTABA:
    8357/    2DB7 : 00 01               	DB	00H,1		; "A"
    8358/    2DB9 : 1D EF 87 2E         	DW	REGAF+1,RNA
    8359/    2DBD : 27 01               	DB	27H,1		; "A'"
    8360/    2DBF :                     ;;	DB	'\'',1		; "A'"
    8361/    2DBF : 25 EF A0 2E         	DW	REGAFX+1,RNAX
    8362/    2DC3 :                     
    8363/    2DC3 : 00 00               	DB	00H,0
    8364/    2DC5 :                     	
    8365/    2DC5 :                     RNTABB:
    8366/    2DC5 : 00 01               	DB	00H,1		; "B"
    8367/    2DC7 : 1F EF 8C 2E         	DW	REGBC+1,RNB
    8368/    2DCB : 27 01               	DB	27H,1		; "B'"
    8369/    2DCD :                     ;;	DB	'\'',1		; "B'"
    8370/    2DCD : 27 EF A7 2E         	DW	REGBCX+1,RNBX
    8371/    2DD1 : 43 0F               	DB	'C',0FH		; "BC?"
    8372/    2DD3 : D9 2D 00 00         	DW	RNTABBC,0
    8373/    2DD7 :                     
    8374/    2DD7 : 00 00               	DB	00H,0		; End mark
    8375/    2DD9 :                     
    8376/    2DD9 :                     RNTABBC:
    8377/    2DD9 : 00 02               	DB	00H,2		; "BC"
    8378/    2DDB : 1E EF 89 2E         	DW	REGBC,RNBC
    8379/    2DDF : 27 02               	DB	27H,2		; "BC'"
    8380/    2DE1 :                     ;;	DB	'\'',2		; "BC'"
    8381/    2DE1 : 26 EF A3 2E         	DW	REGBCX,RNBCX
    8382/    2DE5 :                     
    8383/    2DE5 : 00 00               	DB	00H,0
    8384/    2DE7 :                     	
    8385/    2DE7 :                     RNTABC:
    8386/    2DE7 : 00 01               	DB	00H,1		; "C"
    8387/    2DE9 : 1E EF 8E 2E         	DW	REGBC,RNC
    8388/    2DED : 27 01               	DB	27H,1		; "C'"
    8389/    2DEF :                     ;;	DB	'\'',1		; "C'"
    8390/    2DEF : 26 EF AA 2E         	DW	REGBCX,RNCX
    8391/    2DF3 :                     
    8392/    2DF3 : 00 00               	DB	00H,0
    8393/    2DF5 :                     	
    8394/    2DF5 :                     RNTABD:
    8395/    2DF5 : 00 01               	DB	00H,1		; "D"
    8396/    2DF7 : 21 EF 93 2E         	DW	REGDE+1,RND
    8397/    2DFB : 27 01               	DB	27H,1		; "D'"
    8398/    2DFD :                     ;;	DB	'\'',1		; "D'"
    8399/    2DFD : 29 EF B1 2E         	DW	REGDEX+1,RNDX
    8400/    2E01 : 45 0F               	DB	'E',0FH		; "DE?"
    8401/    2E03 : 09 2E 00 00         	DW	RNTABDE,0
    8402/    2E07 :                     
    8403/    2E07 : 00 00               	DB	00H,0
    8404/    2E09 :                     
    8405/    2E09 :                     RNTABDE:
    8406/    2E09 : 00 02               	DB	00H,2		; "DE"
    8407/    2E0B : 20 EF 90 2E         	DW	REGDE,RNDE
    8408/    2E0F : 27 02               	DB	27H,2		; "DE'"
    8409/    2E11 :                     ;;	DB	'\'',2		; "DE'"
    8410/    2E11 : 28 EF AD 2E         	DW	REGDEX,RNDEX
    8411/    2E15 :                     
    8412/    2E15 : 00 00               	DB	00H,0
    8413/    2E17 :                     	
    8414/    2E17 :                     RNTABE:
    8415/    2E17 : 00 01               	DB	00H,1		; "E"
    8416/    2E19 : 20 EF 95 2E         	DW	REGDE,RNE
    8417/    2E1D : 27 01               	DB	27H,1		; "E'"
    8418/    2E1F :                     ;;	DB	'\'',1		; "E'"
    8419/    2E1F : 28 EF B4 2E         	DW	REGDEX,RNEX
    8420/    2E23 :                     
    8421/    2E23 : 00 00               	DB	00H,0
    8422/    2E25 :                     	
    8423/    2E25 :                     RNTABF:
    8424/    2E25 : 00 01               	DB	00H,1		; "F"
    8425/    2E27 : 1C EF 9E 2E         	DW	REGAF,RNF
    8426/    2E2B : 27 01               	DB	27H,1		; "F'"
    8427/    2E2D :                     ;;	DB	'\'',1		; "F'"
    8428/    2E2D : 24 EF C1 2E         	DW	REGAFX,RNFX
    8429/    2E31 :                     
    8430/    2E31 : 00 00               	DB	00H,0
    8431/    2E33 :                     	
    8432/    2E33 :                     RNTABH:
    8433/    2E33 : 00 01               	DB	00H,1		; "H"
    8434/    2E35 : 23 EF 9A 2E         	DW	REGHL+1,RNH
    8435/    2E39 : 27 01               	DB	27H,1		; "H'"
    8436/    2E3B :                     ;;	DB	'\'',1		; "H'"
    8437/    2E3B : 2B EF BB 2E         	DW	REGHLX+1,RNHX
    8438/    2E3F : 4C 0F               	DB	'L',0FH		; "HL?"
    8439/    2E41 : 47 2E 00 00         	DW	RNTABHL,0
    8440/    2E45 :                     
    8441/    2E45 : 00 00               	DB	00H,0
    8442/    2E47 :                     
    8443/    2E47 :                     RNTABHL:
    8444/    2E47 : 00 02               	DB	00H,2		; "HL"
    8445/    2E49 : 22 EF 97 2E         	DW	REGHL,RNHL
    8446/    2E4D : 27 02               	DB	27H,2		; "HL'"
    8447/    2E4F :                     ;;	DB	'\'',2		; "HL'"
    8448/    2E4F : 2A EF B7 2E         	DW	REGHLX,RNHLX
    8449/    2E53 :                     
    8450/    2E53 : 00 00               	DB	00H,0
    8451/    2E55 :                     	
    8452/    2E55 :                     RNTABL:
    8453/    2E55 : 00 01               	DB	00H,1		; "L"
    8454/    2E57 : 22 EF 9C 2E         	DW	REGHL,RNL
    8455/    2E5B : 27 01               	DB	27H,1		; "L'"
    8456/    2E5D :                     ;;	DB	'\'',1		; "L'"
    8457/    2E5D : 2A EF BE 2E         	DW	REGHLX,RNLX
    8458/    2E61 :                     
    8459/    2E61 : 00 00               	DB	00H,0
    8460/    2E63 :                     	
    8461/    2E63 :                     RNTABI:
    8462/    2E63 : 00 01               	DB	00H,1		; "I"
    8463/    2E65 : 34 EF D0 2E         	DW	REGI,RNI
    8464/    2E69 : 58 02               	DB	'X',2		; "IX"
    8465/    2E6B : 2C EF C4 2E         	DW	REGIX,RNIX
    8466/    2E6F : 59 02               	DB	'Y',2		; "IY"
    8467/    2E71 : 2E EF C7 2E         	DW	REGIY,RNIY
    8468/    2E75 :                     	
    8469/    2E75 : 00 00               	DB	00H,0
    8470/    2E77 :                     
    8471/    2E77 :                     RNTABP:
    8472/    2E77 : 43 02               	DB	'C',2		; "PC"
    8473/    2E79 : 32 EF CD 2E         	DW	REGPC,RNPC
    8474/    2E7D :                     
    8475/    2E7D : 00 00               	DB	00H,0
    8476/    2E7F :                     
    8477/    2E7F :                     RNTABS:
    8478/    2E7F : 50 02               	DB	'P',2		; "SP"
    8479/    2E81 : 30 EF CA 2E         	DW	REGSP,RNSP
    8480/    2E85 :                     
    8481/    2E85 : 00 00               	DB	00H,0
    8482/    2E87 :                     
    8483/    2E87 : 41 00               RNA:	DB	"A",00H
    8484/    2E89 : 42 43 00            RNBC:	DB	"BC",00H
    8485/    2E8C : 42 00               RNB:	DB	"B",00H
    8486/    2E8E : 43 00               RNC:	DB	"C",00H
    8487/    2E90 : 44 45 00            RNDE:	DB	"DE",00H
    8488/    2E93 : 44 00               RND:	DB	"D",00H
    8489/    2E95 : 45 00               RNE:	DB	"E",00H
    8490/    2E97 : 48 4C 00            RNHL:	DB	"HL",00H
    8491/    2E9A : 48 00               RNH:	DB	"H",00H
    8492/    2E9C : 4C 00               RNL:	DB	"L",00H
    8493/    2E9E : 46 00               RNF:	DB	"F",00H
    8494/    2EA0 : 41 27 00            RNAX:	DB	"A'",00H
    8495/    2EA3 : 42 43 27 00         RNBCX:	DB	"BC'",00H
    8496/    2EA7 : 42 27 00            RNBX:	DB	"B'",00H
    8497/    2EAA : 43 27 00            RNCX:	DB	"C'",00H
    8498/    2EAD : 44 45 27 00         RNDEX:	DB	"DE'",00H
    8499/    2EB1 : 44 27 00            RNDX:	DB	"D'",00H
    8500/    2EB4 : 45 27 00            RNEX:	DB	"E'",00H
    8501/    2EB7 : 48 4C 27 00         RNHLX:	DB	"HL'",00H
    8502/    2EBB : 48 27 00            RNHX:	DB	"H'",00H
    8503/    2EBE : 4C 27 00            RNLX:	DB	"L'",00H
    8504/    2EC1 : 46 27 00            RNFX:	DB	"F'",00H
    8505/    2EC4 : 49 58 00            RNIX:	DB	"IX",00H
    8506/    2EC7 : 49 59 00            RNIY:	DB	"IY",00H
    8507/    2ECA : 53 50 00            RNSP:	DB	"SP",00H
    8508/    2ECD : 50 43 00            RNPC:	DB	"PC",00H
    8509/    2ED0 : 49 00               RNI:	DB	"I",00H
    8510/    2ED2 : 52 00               RNR:	DB	"R",00H
    8511/    2ED4 :                     
    8512/    2ED4 :                     ;;;
    8513/    2ED4 :                     ;;; Console drivers
    8514/    2ED4 :                     ;;;
    8515/    2ED4 :                     
    8516/    2ED4 : =>FALSE             	IF	SuperMEZ80
    8517/    2ED4 :                     
    8518/    2ED4 :                     CONIN:
    8519/    2ED4 :                     	IN	A,(UARTCR)
    8520/    2ED4 :                     	BIT	0,A
    8521/    2ED4 :                     	JR	Z,CONIN
    8522/    2ED4 :                     	IN	A,(UARTDR)
    8523/    2ED4 :                     	RET
    8524/    2ED4 :                     
    8525/    2ED4 :                     CONST:
    8526/    2ED4 :                     	IN	A,(UARTCR)
    8527/    2ED4 :                     	BIT	0,A
    8528/    2ED4 :                     	RET
    8529/    2ED4 :                     
    8530/    2ED4 :                     CONOUT:
    8531/    2ED4 :                     	PUSH	AF
    8532/    2ED4 :                     PCST1:	IN	A,(UARTCR)
    8533/    2ED4 :                     	BIT	1,A
    8534/    2ED4 :                     	JR	Z,PCST1
    8535/    2ED4 :                     	POP	AF
    8536/    2ED4 :                     	OUT	(UARTDR),A
    8537/    2ED4 :                     	RET
    8538/    2ED4 :                     
    8539/    2ED4 :                     	IF	SMEZ80Full=0
    8540/    2ED4 :                     end_mon:
    8541/    2ED4 :                     	db	($ & 0FF00H)+100H-$ dup(0FFH)
    8542/    2ED4 : [8539]              	ENDIF
    8543/    2ED4 :                     
    8544/    2ED4 : =>TRUE              	ELSE
    8545/    2ED4 :                     
    8546/    2ED4 :                     CONIN:
    8547/    2ED4 : 3A 01 FF            	LD	A,(UARTCR)
    8548/    2ED7 : CB 47               	BIT	0,A
    8549/    2ED9 : 28 F9               	JR	Z,CONIN
    8550/    2EDB : 3A 00 FF            	LD	A,(UARTDR)
    8551/    2EDE : C9                  	RET
    8552/    2EDF :                     
    8553/    2EDF :                     CONST:
    8554/    2EDF : 3A 01 FF            	LD	A,(UARTCR)
    8555/    2EE2 : CB 47               	BIT	0,A
    8556/    2EE4 : C9                  	RET
    8557/    2EE5 :                     
    8558/    2EE5 :                     CONOUT:
    8559/    2EE5 : F5                  	PUSH	AF
    8560/    2EE6 : 3A 01 FF            PCST1:	LD	A,(UARTCR)
    8561/    2EE9 : CB 4F               	BIT	1,A
    8562/    2EEB : 28 F9               	JR	Z,PCST1
    8563/    2EED : F1                  	POP	AF
    8564/    2EEE : 32 00 FF            	LD	(UARTDR),A
    8565/    2EF1 : C9                  	RET
    8566/    2EF2 : [8516]              	ENDIF
    8567/    2EF2 :                     
    8568/    2EF2 : =>TRUE              	IF	(SuperMEZ80=0) || (SMEZ80Full=1)
    8569/    2EF2 : FF FF FF FF FF FF   	db	BASIC_TOP - $ dup(0ffH)
             2EF8 : FF FF FF FF FF FF 
             2EFE : FF FF             
    8570/    2F00 :                     ;	ORG	BASIC_TOP
    8571/    2F00 : [8568]              	ENDIF
    8572/    2F00 :                     
    8573/    2F00 :                     	;;
    8574/    2F00 :                     	;; Work Area
    8575/    2F00 :                     	;;
    8576/    2F00 :                     	
    8577/    EF00 :                     	ORG	WORK_B
    8578/    EF00 :                     
    8579/    EF00 : =>TRUE              	IF	BACKDOOR
    8580/    EF00 :                     stealRST08:	ds	2	; hacking RST 08H, set jump address
    8581/    EF02 :                     stealRST10:	ds	2	; hacking RST 10H, set jump address
    8582/    EF04 :                     stealRST18:	ds	2	; hacking RST 18H, set jump address
    8583/    EF06 :                     stealRST20:	ds	2	; hacking RST 20H, set jump address
    8584/    EF08 :                     stealRST28:	ds	2	; hacking RST 28H, set jump address
    8585/    EF0A :                     stealRST30:	ds	2	; hacking RST 30H, set jump address
    8586/    EF0C :                     stealRST38:	ds	2	; hacking RST 38H, set jump address
    8587/    EF0E :                     save_hl:	ds	2
    8588/    EF10 : [8579]              	ENDIF
    8589/    EF10 :                     	
    8590/    EF10 :                     DSADDR:	DS	2	; Dump start address
    8591/    EF12 :                     DEADDR:	DS	2	; Dump end address
    8592/    EF14 :                     DSTATE:	DS	1	; Dump state
    8593/    EF15 :                     GADDR:	DS	2	; Go address
    8594/    EF17 :                     SADDR:	DS	2	; Set address
    8595/    EF19 :                     HEXMOD:	DS	1	; HEX file mode
    8596/    EF1A :                     RECTYP:	DS	1	; Record type
    8597/    EF1B :                     SIZE:	DS	1	; I/O Size 00H,'W','S'
    8598/    EF1C :                     
    8599/    EF1C :                     REG_B:	
    8600/    EF1C :                     REGAF:	DS	2
    8601/    EF1E :                     REGBC:	DS	2
    8602/    EF20 :                     REGDE:	DS	2
    8603/    EF22 :                     REGHL:	DS	2
    8604/    EF24 :                     REGAFX:	DS	2		; Register AF'
    8605/    EF26 :                     REGBCX:	DS	2
    8606/    EF28 :                     REGDEX:	DS	2
    8607/    EF2A :                     REGHLX:	DS	2		; Register HL'
    8608/    EF2C :                     REGIX:	DS	2
    8609/    EF2E :                     REGIY:	DS	2
    8610/    EF30 :                     REGSP:	DS	2
    8611/    EF32 :                     REGPC:	DS	2
    8612/    EF34 :                     REGI:	DS	1
    8613/    EF35 :                     REGR:	DS	1
    8614/    EF36 :                     REG_E:
    8615/    EF36 :                     
    8616/    EF36 :                     l_jpflg	ds	1		; L command jp flag
    8617/    EF37 :                     ld_jmp	ds	2		; jump address after load
    8618/    EF39 :                     
    8619/    EF39 : =>TRUE              	IF RAM12K
    8620/    EF39 :                     ; stop watch timer
    8621/    EF39 :                     
    8622/    EF39 :                     c16b:	ds	2	; copy of TIMER0_CNT
    8623/    EF3B :                     secb:	ds	2	; copy of TIMER0_SCTT
    8624/    EF3D :                     msecb:	ds	2
    8625/    EF3F : [8619]              	ENDIF
    8626/    EF3F :                     
    8627/    EF3F :                     ; DIV 16 /16 buffer
    8628/    EF3F :                     DIV16_NA:	ds	2
    8629/    EF41 :                     DIV16_NB:	ds	2
    8630/    EF43 :                     DIV16_NC:	DS	2
    8631/    EF45 :                     DIV16_ND:	DS	2
    8632/    EF47 :                     
    8633/    EF47 :                     ; go command temp start address
    8634/    EF47 :                     goTmp:		ds	2
    8635/    EF49 :                     
    8636/    EF49 :                     ; trace mode switch
    8637/    EF49 :                     TP_mode:	ds	1	; N: display on, F: display off
    8638/    EF4A :                     TM_mode:	ds	1	; 'S':skip call, 'I':trace CALL IN
    8639/    EF4B :                     TC_cnt:		ds	2	; numbers of step
    8640/    EF4D :                     tmpT:		ds	2	; save temp buffer
    8641/    EF4F :                     fever_t:	ds	1	; flag trace forever
    8642/    EF50 :                     
    8643/    EF50 :                     ; break, trace point work area
    8644/    EF50 : =0EF50H             dbg_wtop	equ	$
    8645/    EF50 :                     tpt1_f:		ds	1
    8646/    EF51 :                     tpt1_op:	ds	1	; save trace point1 opcode
    8647/    EF52 :                     tpt1_adr:	ds	2
    8648/    EF54 :                     tpt2_f:		ds	1
    8649/    EF55 :                     tpt2_op:	ds	1	; save trace point2 opcode (for branch)
    8650/    EF56 :                     tpt2_adr:	ds	2
    8651/    EF58 :                     
    8652/    EF58 :                     ; break point work area
    8653/    EF58 :                     bpt1_f:		ds	1
    8654/    EF59 :                     bpt1_op:	ds	1
    8655/    EF5A :                     bpt1_adr:	ds	2
    8656/    EF5C :                     bpt2_f:		ds	1
    8657/    EF5D :                     bpt2_op:	ds	1
    8658/    EF5E :                     bpt2_adr:	ds	2
    8659/    EF60 :                     
    8660/    EF60 :                     tmpb_f:		ds	1
    8661/    EF61 :                     tmpb_op:	ds	1
    8662/    EF62 :                     tmpb_adr:	ds	2
    8663/    EF64 : =0EF64H             dbg_wend	equ	$
    8664/    EF64 :                     
    8665/    EF64 :                     ; minimal assembler
    8666/    EF64 :                     
    8667/    EF64 :                     asm_adr:	ds	2
    8668/    EF66 :                     tasm_adr:	ds	2
    8669/    EF68 :                     element_cnt:	ds	1	; Element count of input string
    8670/    EF69 :                     byte_count:	ds	1	; numbers of Machine code
    8671/    EF6A :                     opc_cd:		ds	1	; opecode number
    8672/    EF6B :                     opr1_cd:	ds	1	; 1st operand number
    8673/    EF6C :                     opr2_cd:	ds	1	; 2nd operand number
    8674/    EF6D :                     opr_num25:	ds	2	; save number nnnn
    8675/    EF6F :                     opr_num35:	ds	2	; save number (nnnn)
    8676/    EF71 :                     opr_num37:	ds	1	; save number (IY-nn)
    8677/    EF72 :                     opr_num34:	ds	1	; save number (IY+nn)
    8678/    EF73 :                     opr_num36:	ds	1	; save number (IX-nn)
    8679/    EF74 :                     opr_num33:	ds	1	; save number (IX+nn)
    8680/    EF75 :                     cb_mcw		ds	2	; use BIT, RES, SET
    8681/    EF77 :                     cb_xyw		ds	2	; use BIT, RES, SET
    8682/    EF79 :                     
    8683/    EF79 :                     F_bit:		ds	F_bitSize+1
    8684/    EF82 :                     ky_flg:		ds	1	; b00000ULC ( U: UPPER L: LF C: CR )
    8685/    EF83 :                     				; U=0: Lower To Upper
    8686/    EF83 :                     				; L=0: End of line is added LF
    8687/    EF83 :                     				; C=0: End of line is added CR
    8688/    EF83 :                     ;::::::::::::::::::::::::::
    8689/    EF83 :                     ; DISASEM work area
    8690/    EF83 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
    8691/    EF83 :                     dasm_ed:	ds	2
    8692/    EF85 :                     dasm_stpf:	ds	1
    8693/    EF86 :                     dasm_adr:	ds	2
    8694/    EF88 :                     reg_xy:		ds	2	; RNIX or RNIY
    8695/    EF8A :                     xy_srtp		ds	2	; strings pointer
    8696/    EF8C :                     
    8697/    EF8C :                     mc_Size:	ds	1
    8698/    EF8D :                     
    8699/    EF8D :                     ;;;;;;;;;;;;;;;;;;;
    8700/    EF8D :                     ; union area
    8701/    EF8D :                     ;;;;;;;;;;;;;;;;;;;
    8702/    EF8D :                     INBUF: ; Line input buffer
    8703/    EF8D :                     line_buf:
    8704/    EF8D :                     
    8705/    EF8D :                     ;  DidAsm string buffer
    8706/    EF8D :                     ; total 42 bytes
    8707/    EF8D :                     dasm_bs:
    8708/    EF8D :                     adr_mc_buf:	ds	19
    8709/    EFA0 :                     dasm_OpcStr:	ds	8
    8710/    EFA8 :                     dasm_OprStr:	ds	15 - NUMLEN
    8711/    EFB0 :                     num_string:	ds	NUMLEN	; max 65536 or 0FFFFH + null( max 7bytes )
    8712/    EFB7 :                     dasm_be:
    8713/    EFB7 :                     
    8714/    EFB7 :                     	END
 AS V1.42 Beta [Bld 246] - Source File emuz80mon_RevB05.asm - Page 2 - 9/2/2023 2:46:31


  Symbol Table (* = unused):
  --------------------------

 ACS_KN2K :                    0BCF C |  ADCSTR :                      1251 C |
 ADC_3MC :                        4 - |  ADC_A_ :                      1CF4 C |
 ADC_A_A :                     1D16 C |  ADC_A_N :                     1D0E C |
 ADC_A_X :                     1D0B C |  ADC_FD :                      1D32 C |
 ADC_HL_ :                     1CF0 C |  ADC_HL_BC :                   1CEF C |
 ADC_HL_DE :                   1CEB C |  ADC_HL_HL :                   1CE7 C |
*ADC_HL_SP :                   1CE3 C |  ADC_MC :                         9 - |
 ADDIXRP_TBL :                 13E2 C |  ADDIYRP_TBL :                 13EA C |
 ADDSTR :                      124D C |  ADD_HL_ :                     1D92 C |
 ADD_HL_BC :                   1DA9 C |  ADD_HL_DE :                   1DAE C |
 ADD_HL_HL :                   1DB3 C | *ADD_HL_SP :                   1DA4 C |
 ADD_IX_ :                     1D58 C |  ADD_IX_IX :                   1D80 C |
*ADD_IY_ :                     1D54 C |  ADD_IY_IY :                   1D8A C |
 ADD_OPSTR :                   1107 C |  ADD_RP_E :                    11B2 C |
 ADD_RP_S :                    11AE C |  ADD_XY_BC :                   1D78 C |
 ADD_XY_DE :                   1D7C C | *ADD_XY_SP :                   1D71 C |
 ADD_XY_XY :                   1D86 C |  ADJ_TIM1 :                    293F C |
 ADR_MC_BUF :                 0EF8D C |  ADR_OVR :                     25B9 C |
 ANALIZE_INPUT :               2445 C |  ANALIZE_OPR :                 2487 C |
 ANDSTR :                      125D C |  AND_CP :                      22BE C |
 AN_ERR :                      247C C |  APENDTBL :                     1D3 C |
 API01 :                       2787 C |  API06 :                       27C9 C |
 APITBL :                      275B C |  APITBL_E :                    2787 C |
*ARCHITECTURE :                                        "i386-unknown-win32" - |
 ASM_ADR :                    0EF64 C |  ASM_ERR :                     1A6D C |
*ASM_ERR1 :                    1A70 C |  A_COLON_SP :                  115A C |
 A_CRLF :                      1125 C |  BACKDOOR :                       1 - |
 BACKTOMON :                   288E C |  BASE1 :                       229F C |
 BASIC_CST :                   2F00 - |  BASIC_TOP :                   2F00 - |
 BASIC_WST :                   2F03 - |  BITSTR :                      12D0 C |
 BIT_IXM :                     1BF0 C |  BIT_IXP :                     1BDE C |
 BIT_IXP1 :                    1BE1 C |  BIT_IYM :                     1BFD C |
 BIT_IYP :                     1BF5 C |  BIT_IYP1 :                    1BF8 C |
 BIT_MCB :                     1B79 C |  BIT_MCBE :                    1B81 C |
 BIT_MCBN :                       8 - |  BIT_RES_SET :                 1B95 C |
 BIT_XYT :                     1B81 C |  BI_HEX :                      2561 C |
 BPT1_ADR :                   0EF5A C |  BPT1_F :                     0EF58 C |
 BPT1_OP :                    0EF59 C |  BPT2_ADR :                   0EF5E C |
 BPT2_F :                     0EF5C C |  BPT2_OP :                    0EF5D C |
 BP_CHK1 :                     282C C |  BP_CHK_END :                  2859 C |
 BP_CLR :                       377 C |  BP_CLR1 :                      38D C |
 BP_LOT :                       39E C |  BP_MSG1 :                      3B4 C |
 BP_MSG2 :                      3B8 C |  BRK_CMD :                      320 C |
 BS :                             8 - |  BUFLEN :                        28 - |
 BYTE_COUNT :                 0EF69 C |  B_ACLR :                       392 C |
 B_LIST :                       300 C |  B_LIST1 :                      30E C |
 B_MSG_OUT :                    3BB C |  C16B :                       0EF39 C |
 CALC_DIS_STEP :                8E2 C |  CALC_RELADR :                 258E C |
 CALLSTR :                     123C C |  CALL_MC1T :                   1C02 C |
 CAL_01 :                      25A8 C |  CAL_1 :                       25AB C |
*CASESENSITIVE :                  0 - |  CB_MCW :                     0EF75 C |
 CB_XYW :                     0EF77 C |  CC0 :                         134C C |
 CC1 :                         134F C |  CC2 :                         1351 C |
 CC3 :                         1354 C |  CC4 :                         1356 C |
 CC5 :                         1359 C |  CC6 :                         135C C |
 CC7 :                         135E C |  CCFSTR :                      12A5 C |
 CC_NNNN :                     0CB0 C |  CC_OPR :                      1370 C |
 CHG_MSEC :                    2980 C |  CHKERR :                       375 C |
 CHK_0CBH :                    0CCD C |  CHK_0DD3OP :                  0E1A C |
 CHK_0DD4OP :                  0E99 C |  CHK_0DDH :                    0D93 C |
 CHK_0DDH_1 :                  0DA6 C |  CHK_0EDH :                    0F39 C |
 CHK_0FDH :                    1036 C |  CHK_1MC_BNH :                 0B2C C |
 CHK_2MC :                     0B79 C |  CHK_3MC :                     0C29 C |
 CHK_ADC :                      9F2 C |  CHK_ADC3MC :                  1D19 C |
 CHK_ADD :                      9E6 C |  CHK_ADD_RP :                  0AAB C |
 CHK_AND :                     0A1C C |  CHK_BP :                      281D C |
 CHK_CALCC :                   0CBE C |  CHK_CALLN4 :                  0C97 C |
 CHK_CP :                      0A40 C |  CHK_DD_CB :                   0EE5 C |
 CHK_DEC :                     0A65 C |  CHK_DEC_RP :                  0A92 C |
 CHK_DI1 :                      88A C |  CHK_DJNZ :                    0BF4 C |
 CHK_EX :                      0AFB C |  CHK_FEVRE :                    4C9 C |
 CHK_INC :                     0A4D C |  CHK_INC_RP :                  0A79 C |
 CHK_JPCC :                    0CA3 C |  CHK_JPN4 :                    0C8B C |
 CHK_JRCC :                    0C0D C |  CHK_JRNN :                    0BFD C |
 CHK_LD :                       977 C |  CHK_LD1 :                      9B5 C |
 CHK_LD16 :                    0C4A C |  CHK_LOGOP2 :                  0BA0 C |
 CHK_NTRACE :                  2871 C |  CHK_OR :                      0A34 C |
 CHK_POP_RP :                  0AC9 C |  CHK_PUSH_RP :                 0AE2 C |
 CHK_RET :                     0B3F C |  CHK_RST :                     0B58 C |
 CHK_SBC :                     0A0D C |  CHK_STPDI :                    8A9 C |
 CHK_STRINGS :                 24E8 C |  CHK_SUB :                     0A01 C |
 CHK_XOR :                     0A28 C |  CK_ENDMK :                    254E C |
 CLCC_TBLE :                    699 C |  CLCC_TBLS :                    691 C |
 CLR_CRT :                     2655 C |  CLR_TIM :                     2961 C |
 CMD_HLP :                     2A5A C |  COLD_ST :                       40 C |
 COMMAND_HLP :                  17D C |  COM_ERRM :                    133F C |
 CONIN :                       2ED4 C |  CONOUT :                      2EE5 C |
 CONST :                       2EDF C | *CONSTPI :        3.141592653589793 - |
 CONT_ASM :                    1AEB C |  COUT_SP :                     1A7E C |
 COUT_SP1 :                    1A94 C |  COUT_SP2 :                    1AB0 C |
 CPDRSTR :                     1322 C |  CPDSTR :                      12FC C |
 CPIRSTR :                     130E C |  CPISTR :                      12EB C |
 CPLSTR :                      129D C |  CPSTR :                       1268 C |
 CPSTREND :                    219C C |  CPSTR_CRLF :                  1133 C |
 CP_IXIY :                     22EF C |  CP_IY :                       22F7 C |
 CP_XY1 :                      22FC C |  CR :                            0D - |
 CRLF :                        264B C |  CSTART :                        7E C |
 D16_END :                     29F3 C |  D16_MINUS :                   29EB C |
 D16_MINUS_AFTER :             29EF C |  D16_MINUS_BEFORE :            29EA C |
 D16_PLUS :                    29DF C |  D16_PLUS_AFTER :              29E3 C |
 DAASTR :                      1299 C |  DASM_ADR :                   0EF86 C |
 DASM_BE :                    0EFB7 C |  DASM_BS :                    0EF8D C |
 DASM_ED :                    0EF83 C |  DASM_OPCSTR :                0EFA0 C |
 DASM_OPRSTR :                0EFA8 C |  DASM_STPF :                  0EF85 C |
*DATE :                  "9/2/2023" - |  DBG_WEND :                   0EF64 - |
 DBG_WINI :                     0EC C |  DBG_WTOP :                   0EF50 - |
 DDLOGTBL :                    13F2 C |  DD_21 :                       0EBF C |
 DD_22 :                       0ECC C |  DD_2A :                       0ED5 C |
 DD_2A1 :                      0ED9 C |  DD_2NDTBL :                    754 C |
 DD_2NDTBL1 :                   758 C |  DD_2NDTBL2 :                   75C C |
 DD_2NDTBL_E :                  75E C |  DD_2OPT :                     13DA C |
 DD_BIT :                      0F29 C |  DD_BIT_OPTBL :                11D6 C |
 DD_BIT_OPTBLE :               11EE C |  DD_BSR :                      0F20 C |
 DD_CB_NN_XX :                 0F05 C |  DD_LD :                       0E59 C |
 DD_LD1 :                      0E71 C |  DD_LDTBL :                    1400 C |
 DD_LD_TBL :                   11BA C |  DD_LD_TBLE :                  11C8 C |
 DD_LOG_TBL :                  11C8 C |  DD_LOG_TBLE :                 11CF C |
 DD_MIX :                      0E84 C |  DD_MIX1 :                     0E8F C |
 DD_MIX2 :                     0E94 C |  DD_MIX3 :                     0E87 C |
 DD_MIX4 :                     0E7D C |  DD_RES :                      0F31 C |
 DD_RT_STR :                   1438 C |  DD_RT_TBLE :                  11D6 C |
 DD_RT_TBLES :                 11CF C |  DEADDR :                     0EF12 C |
 DECSTR :                      126F C |  DEC_CHR :                     2573 C |
 DEC_NUM :                     258C C |  DEC_OPCDTBLE :                11A6 C |
 DEC_OPCDTBLS :                119E C |  DEC_OPR :                     231A C |
 DEC_RP_E :                    11AE C |  DEC_RP_S :                    11AA C |
 DEC_STR :                     299C C |  DEL :                           7F - |
 DEX_SP_HL :                   0B24 C |  DIP_TM :                       40C C |
 DISASM_GO :                    8B7 C |  DISASSEMBLE :                  867 C |
 DISREGTBL :                   1360 C |  DISTR :                       12A9 C |
 DIS_ANALYSIS :                 946 C |  DIS_CALL :                    28CB C |
 DIS_GO1 :                      8C2 C | *DIV16 :                       29F6 C |
 DIV16_8 :                     29D2 C |  DIV16_NA :                   0EF3F C |
 DIV16_NB :                   0EF41 C |  DIV16_NC :                   0EF43 C |
 DIV16_ND :                   0EF45 C |  DIV16_X0 :                    2A33 C |
 DIV16_X1 :                    2A3E C |  DIV16_X2 :                    2A0C C |
 DIXN_TBL :                    2316 C |  DIX_TBL :                     2314 C |
 DIYN_TBL :                    2318 C |  DI_3MC :                      236E C |
 DI_3MC1 :                     2374 C |  DI_IXNNUM :                      4 - |
 DI_IXYNUM :                      6 - |  DI_IY :                       236A C |
 DI_IYNNUM :                      2 - |  DI_NBS :                        12 - |
 DI_NXT :                       870 C |  DJNZSTR :                     1237 C |
 DJPHL :                        59B C |  DMKST1 :                      111B C |
 DMKST2 :                      111D C |  DMKSTR0 :                     1111 C |
 DMP_DB :                      1AC1 C |  DMP_DW :                      1ACC C |
 DM_BIT :                        80 - |  DONOT_TRACE :                 14A9 C |
 DP0 :                          773 C |  DP00 :                         783 C |
 DP1 :                          798 C |  DPB :                          81B C |
 DPB0 :                         832 C |  DPB1 :                         841 C |
 DPB2 :                         846 C |  DPL :                          7E1 C |
 DPL0 :                         7F2 C |  DPL1 :                         802 C |
 DPL2 :                         811 C |  DPL3 :                         816 C |
 DPM :                          7B4 C |  DPM0 :                         7BF C |
 DPM1 :                         7DB C |  DPM_C :                        7AE C |
 DSADDR :                     0EF10 C |  DSAP :                        2CA6 C |
 DSEP0 :                       2C9F C |  DSEP1 :                       2CA2 C |
 DSTATE :                     0EF14 C |  DUMP :                         75E C |
 D_I_TB :                      2308 C |  D_I_TBE :                     231A C |
 E1S :                           0E - |  E1S1 :                          15 - |
 E1_E :                        208E C |  E1_E1 :                       20B1 C |
 E1_S :                        2080 C |  E1_S1 :                       209C C |
 E2S :                           1A - |  E2_E :                        211C C |
 E2_S :                        2102 C |  ED_4MC :                      1017 C |
 ED_ADC :                      0FC5 C |  ED_IM :                       0FF6 C |
 ED_LD_AI :                    0FDF C |  ED_LD_AR :                    0FD6 C |
 ED_LD_IA :                    0FF1 C |  ED_LD_RA :                    0FE8 C |
 ED_LD_RA1 :                   0FEB C |  ED_NOOPR :                    140E C |
 ED_NO_OPR :                   1009 C |  ED_OP_TBL :                   11EE C |
 ED_OP_TBLE :                  1226 C |  ED_OUT :                      0F94 C |
 ED_OUT1 :                     0FA8 C |  ED_RP_STR :                   13CE C |
 ED_SBC :                      0FAF C |  ED_SBC1 :                     0FBE C |
 EISTR :                       12AC C |  EL2_12 :                      23DB C |
 EL2_13 :                      23D1 C |  EL2_130 :                     23F1 C |
 EL2_16 :                      23D6 C |  EL2_17 :                      23CC C |
 EL2_18 :                      23C7 C |  EL2_19 :                      23C2 C |
 EL2_20 :                      23BD C |  EL2_23 :                      2343 C |
 EL2_24 :                      22BC C |  EL2_26 :                      233E C |
 EL2_27 :                      22B8 C |  EL2_28 :                      22B4 C |
 EL2_29 :                      22B0 C |  EL2_41 :                      22AC C |
 EL2_410 :                     22DD C |  EL2_411 :                     22EA C |
 EL2_42 :                      2272 C |  EL2_43 :                      2211 C |
 EL2_44 :                      21F6 C |  EL2_441 :                     2207 C |
 EL2_45 :                      21DB C |  EL2_451 :                     21E5 C |
 EL2_46 :                      224E C |  EL2_49 :                      2224 C |
 EL2_54 :                      2423 C |  EL2_541 :                     243E C |
 EL2_5411 :                    243F C |  EL2_68 :                      21B2 C |
 EL2_69 :                      2179 C |  EL2_691 :                     21A0 C |
 EL2_692 :                     218E C |  EL2_70 :                      2164 C |
 EL2_8 :                       2389 C |  EL2_81 :                      238B C |
 EL2_82 :                      23AF C |  EL2_9 :                       2385 C |
 EL2_DI :                      2346 C |  EL3_1 :                       1E42 C |
 EL3_11 :                      1EE0 C |  EL3_12 :                      1E6A C |
 EL3_121 :                     1F70 C |  EL3_125 :                     1E6E C |
 EL3_126 :                     1E84 C |  EL3_13 :                      1FA1 C |
 EL3_14 :                      1FAF C |  EL3_1_2 :                     1F5B C |
 EL3_21 :                      1D36 C |  EL3_211 :                     1D5A C |
 EL3_212 :                     1D73 C |  EL3_22 :                      1CBD C |
 EL3_221 :                     1CC3 C |  EL3_25 :                      1CB5 C |
 EL3_34 :                      1B89 C |  EL3_341 :                     1BDA C |
 EL3_342 :                     1BE4 C |  EL3_35 :                      1B4D C |
 EL3_36 :                      1B6B C |  EL3_42 :                      1C17 C |
 EL3_421 :                     1C1A C |  EL3_43 :                      1C80 C |
 EL3_431 :                     1CA1 C |  EL3_45 :                      1C0A C |
 EL3_55 :                      1C40 C |  EL3_550 :                     1C4B C |
 EL3_551 :                     1C69 C |  EL3_552 :                     1C6C C |
 EL3_6 :                       1DB8 C |  EL3_60 :                      1C37 C |
 EL3_61 :                      1DFB C |  EL3_JTB :                     1B23 C |
 EL3_S13 :                     207B C |  EL3_S16 :                     202F C |
 EL3_S161 :                    2053 C |  EL3_S162 :                    2057 C |
 EL3_S163 :                    205B C |  EL3_S1631 :                   205D C |
 EL3_S164 :                    2064 C |  EL3_S17 :                     2076 C |
 EL3_S26 :                     2071 C |  EL3_S261 :                    2073 C |
 EL3_S27 :                     206D C |  EL3_S28 :                     2000 C |
 EL3_S281 :                    2020 C |  EL3_S282 :                    201C C |
 EL3_S283 :                    2019 C |  EL3_S35 :                     1FCB C |
 EL3_S351 :                    1FEB C |  EL3_S352 :                    1FF7 C |
 EL3_S353 :                    1FF1 C |  EL3_STB :                     1B16 C |
 EL3_STBE :                    1B23 C |  EL3_UM :                        0D - |
 ELEM1_CD :                    2080 C |  ELEM1_CD1 :                   209C C |
 ELEM1_OPCD :                  208E C |  ELEM1_OPCD1 :                 20B1 C |
 ELEM2_CD :                    2102 C |  ELEMENT_CNT :                0EF68 C |
 END_DEC :                     29CB C |  END_INS_TC :                   601 C |
 ENTRY :                         40 - |  ENT_EL2 :                     211C C |
 ERR :                          175 C |  ERRMSG :                      2C97 C |
 ERR_TRACE_SEQ :                604 C |  ER_OPMSG :                    133F C |
 ESC :                           1B - |  ESC_CRT_CLR :                 265E C |
 EXP_MSB :                      623 C |  EXSTR :                       127C C |
 EXT_ASM :                     1A5C C |  EXXSTR :                      127F C |
 EX_AF_ :                      1DE9 C |  EX_AF_AF :                    0B16 C |
 EX_DE_ :                      1DF3 C |  EX_SP_HL :                    1DE6 C |
 EX_SP_IX :                    1DE0 C |  EX_SR_ :                      1E1E C |
 EX_SR_NUM :                      4 - | *E_CSTART :                       0 C |
*E_WSTART :                       3 C | *FALSE :                          0 - |
 FEVER_T :                    0EF4F C |  FLG_LOOP :                    183C C |
 FLG_NXT :                     184B C |  FLG_OFF :                     1847 C |
*FULLPMMU :                       1 - |  F_BIT :                      0EF79 C |
 F_BITSIZE :                      8 - |  F_BIT_OFF :                   1867 C |
 F_BIT_ON :                    185F C |  G0 :                          1489 C |
 GADDR :                      0EF15 C |  GETLIN :                      2662 C |
 GET_BI :                       2DD C |  GET_DI1 :                      884 C |
 GET_DISASM_ST :                8F0 C |  GET_DNUM :                     2B3 C |
 GET_N4 :                      0C72 C |  GET_N4CRLF :                  0C44 C |
 GET_NNNN :                    1075 C |  GET_NUM :                      2BB C |
 GET_NUM0 :                     2BE C |  GET_NUMBER :                  2531 C |
 GET_RSTG_OFF :                1089 C |  GET_R_NUM :                    96E C |
 GET_STRBUFPOINT :             108C C |  GL0 :                         2667 C |
 GL00 :                        266D C |  GL001 :                       268E C |
 GL1 :                         26B3 C |  GLB :                         26B7 C |
 GLE :                         26CE C |  GLE_END :                     25DD C |
 GLE_END1 :                    25DB C |  GM80_CST :                    5400 - |
 GM80_WST :                    5403 - |  GO :                          1446 C |
 GO1 :                         1483 C |  GOSTMP :                      145A C |
 GOTMP :                      0EF47 C |  G_STPADR :                    1464 C |
 H2SA_1 :                      10E1 C |  H2S_N1 :                      10F7 C |
 H2S_N2 :                      10FB C |  H4SA_1 :                      10D0 C |
 H4SA_2 :                      10D3 C | *HAS64 :                          0 - |
*HASFPU :                         0 - | *HASPMMU :                        0 - |
 HEX2STR :                     10EE C |  HEX2STR_ASM :                 10D8 C |
 HEX4STR :                     10E6 C |  HEX4STR_ASM :                 10C7 C |
 HEXIN :                       2627 C |  HEXMOD :                     0EF19 C |
 HEXOUT1 :                     2619 C |  HEXOUT2 :                     2610 C |
 HEXOUT4 :                     260B C |  HEX_CHR :                     257D C |
 HI0 :                         262F C |  HI1 :                         2646 C |
 HIR :                         2649 C |  HLTSTR :                      1248 C |
 HL_CRLF :                     1130 C |  IB1 :                          634 C |
 IB2 :                          633 C |  IB3 :                          632 C |
 ICKA1 :                        66D C |  ICKA_END :                     678 C |
 IHEMSG :                      2C7D C |  IHEXER :                      2CA9 C |
 IKK_1 :                       1173 C |  IMSTR :                       12DC C |
 INADR_CHK_AND_WRT :            652 C |  INBUF :                      0EF8D C |
 INCSTR :                      126B C |  INC_DEC :                     0A5F C |
 INC_DEC_ADDRP :               1388 C |  INC_ELEMENT :                 247F C |
 INC_OPCDTBLE :                119E C |  INC_OPCDTBLS :                1196 C |
 INC_OPR :                     232C C |  INC_RP_E :                    11AA C |
 INC_RP_S :                    11A6 C |  INDRSTR :                     1327 C |
 INDSTR :                      1300 C |  INIRSTR :                     1313 C |
 INISTR :                      12EF C |  INS2 :                         6A1 C |
 INSBRK_1OP :                   625 C |  INSBRK_2OP :                   62A C |
 INSBRK_3OP :                   62F C |  INSBRK_BRP :                   639 C |
 INSBRK_SP :                    645 C |  INSPOSTSTR :                  1136 C |
 INSTC1 :                       555 C | *INSTC2 :                       4E3 C |
 INSTR :                       12B3 C | *INSUPMODE :                      0 - |
 INS_EX_OPC :                  0B10 C |  INS_HLKK :                    0C7C C |
 INS_HL_OPR :                  0B0D C |  INS_IXRP :                    0E05 C |
 INS_JPIX :                    0DDB C | *INS_JPIX1 :                   0DDF C |
 INS_KAKKOL :                  116D C |  INS_KAKKOR :                  1171 C |
 INS_KKA :                     0C66 C |  INS_KKHL :                    0C60 C |
 INS_KMR :                     1182 C |  INS_KN2K :                    0BD8 C |
 INS_KN4KCS :                  10A1 C |  INS_KSPKIX :                  0DED C |
 INS_MISR :                    117E C |  INS_N2CRLF :                  0BC5 C |
 INS_PLSR :                    117A C |  INS_RSTG :                    0D78 C |
 INS_SPCR :                    1176 C |  INS_SPIX :                    0DFC C |
 IN_A_NN :                     1C6F C |  IN_SELM :                        6 - |
 IN_SELT :                     1DFF C |  IO_B :                       0F000 - |
 IR0 :                          0C9 C |  IR00 :                         0E0 C |
 IX_CRLF :                     112A C |  JMP_RST :                       79 C |
 JPCC_TBLE :                    691 C |  JPCC_TBLS :                    689 C |
 JPHL :                        2296 C |  JPIX :                        228F C |
 JPNNNN :                      229A C |  JPSTR :                       1231 C |
 JP_EACH :                     1B0F C |  JP_MC1T :                     1C0F C |
 JP_MC1TE :                    1C17 C |  JP_MC1TM :                       8 - |
 JRCC_OPR1 :                   1380 C |  JRCC_TBLE :                    689 C |
 JRCC_TBLS :                    684 C |  JRCC_TBLS1 :                   685 C |
 JRSTR :                       1234 C |  JR_CCT :                      1C7C C |
 JR_N4CRLF :                   0C04 C |  KCKSTR :                      1343 C |
 KIXYPNK_CRLF :                1050 C |  KIXYPNK_CS :                  1047 C |
 KN2K :                        0BE4 C |  KN4HK :                       0C6C C |
 KN4KCRLF :                    0C82 C |  KRNHL :                       1347 C |
 KY_FLG :                     0EF82 C |  LANCH1 :                       1F3 C |
 LANCH10 :                      2B1 C |  LANCH11 :                      2B1 C |
 LANCH12 :                      2B1 C |  LANCH13 :                      2B1 C |
 LANCH14 :                      2B1 C |  LANCH15 :                      2B1 C |
 LANCH16 :                      2B1 C |  LANCH2 :                       207 C |
 LANCH3 :                       21D C |  LANCH4 :                       23F C |
 LANCH5 :                       263 C |  LANCH6 :                       277 C |
 LANCH7 :                       28D C |  LANCH8 :                       29E C |
 LANCH9 :                       2B1 C |  LAP_TIM :                     2923 C |
 LAUNCHER :                     185 C |  LD1OP :                        9C8 C |
 LD1_BASE :                    1E27 C | *LDA_SP :                      1E22 C |
 LDA_SPE :                     1E27 C |  LDDRSTR :                     131D C |
 LDDSTR :                      12F8 C |  LDIRSTR :                     1309 C |
 LDISTR :                      12E7 C |  LDNR_C :                      1FC4 C |
 LDNR_N :                         7 - |  LDNR_T :                      1FBD C |
 LDSTR :                       1245 C |  LD_A_KBCK :                    994 C |
 LD_A_KDEK :                    9A2 C |  LD_A_KXXK :                    997 C |
*LD_BC_N4 :                    1EF7 C |  LD_BC_N40 :                   1EFD C |
 LD_BC_N41 :                   1F0E C |  LD_BC_N42 :                   1F15 C |
 LD_DE_N4 :                    1F20 C |  LD_E2_TBL :                   1DFE C |
 LD_E2_TBL1 :                  1E05 C |  LD_E2_TBL2 :                  1E0A C |
 LD_E2_TBL3 :                  1E0E C |  LD_E2_TBLE :                  1E15 C |
 LD_EN1 :                         7 - |  LD_EN2 :                         5 - |
 LD_EN3 :                         4 - |  LD_EN4 :                         7 - |
 LD_HL_N4 :                    1F28 C |  LD_IX_N4 :                    1F3D C |
 LD_IX_N40 :                   1F3F C |  LD_IX_N42 :                   1F50 C |
 LD_IY_N4 :                    1F57 C |  LD_JMP :                     0EF37 C |
 LD_KBCK_A :                    9A7 C |  LD_KDEK_A :                    9B0 C |
 LD_KXXK_A :                    9AA C |  LD_R13 :                      1EA0 C |
 LD_R17 :                      1E9B C |  LD_R171 :                     1E9D C |
 LD_R25 :                      1ECE C |  LD_R251 :                     1ED2 C |
 LD_R26 :                      1EA9 C |  LD_R27 :                      1EA4 C |
 LD_R33 :                      1EC9 C |  LD_R34 :                      1EBC C |
 LD_R35 :                      1E8A C |  LD_R36 :                      1EC1 C |
 LD_R361 :                     1EC4 C |  LD_R37 :                      1EAE C |
 LD_R371 :                     1EB1 C |  LD_R372 :                     1EB4 C |
 LD_RRN :                         8 - |  LD_RR_ :                      1E1D C |
 LD_RXYN_SP :                    0A - |  LD_R_JT :                     1E2E C |
 LD_R_NN_E :                    742 C |  LD_R_NN_S :                    73A C |
 LD_XYNLN :                    1F91 C |  LF :                            0A - |
 LF_OUT :                      1A68 C |  LG_JUMP :                     160C C |
 LH0 :                         15AD C |  LH00 :                        159C C |
 LH000 :                       159F C | *LH1 :                         15B9 C |
 LH2 :                         15BD C |  LH3 :                         15C5 C |
 LHI0 :                        15CA C |  LHI1 :                        15EB C |
 LHI2 :                        15FD C |  LHI20 :                       15FC C |
 LHI3 :                        15FF C |  LHIE :                        1619 C |
 LHS0 :                        1631 C |  LHS1 :                        1651 C |
 LHS2 :                        1663 C |  LHS20 :                       1664 C |
 LHS3 :                        1666 C |  LHSE :                        1680 C |
 LHSR :                        161C C |  LINE_ASM :                    1A01 C |
 LINE_BUF :                   0EF8D C | *LISTON :                         1 - |
 LOADH :                       1583 C |  LOGOP2STR :                   13B2 C |
 LOGOP3STR :                   13C6 C |  LOG_OP_E :                     74C C |
 LOG_OP_S :                     742 C |  LOOP_DEC :                    29B2 C |
 LOOP_M8 :                     2A4D C |  LOP_GNUM :                    253E C |
 LST_END :                      1D0 C |  LST_PRG :                      1B5 C |
 LST_PRG1 :                     1B8 C |  L_B2 :                         3AE C |
 L_END :                       161F C |  L_JPFLG :                    0EF36 C |
*MACEXP :                         7 - |  MAS_1 :                        921 C |
 MAS_2 :                        932 C |  MAS_3 :                        93E C |
 MC2_77 :                      1F8C C |  MC_END :                      20DF C |
 MC_END2 :                     20FE C |  MC_END3 :                     21F1 C |
*MC_END4 :                     241E C |  MC_END41 :                    2414 C |
 MC_SIZE :                    0EF8C C |  MEET_DD :                      6CC C |
 MEET_ED :                      6EE C |  MEET_OP1 :                     70A C |
 MEET_OP2 :                     715 C |  MEET_OP3 :                     720 C |
 MEET_OP4 :                     72B C |  MKMC_SH :                     1CA4 C |
 MKMC_SHED :                   1CB4 C |  MKOPCSTR :                    110A C |
 MKREL_STR :                   10B9 C |  MK_2NDOPR :                    9D4 C |
 MK_2NDOPR1 :                   9DE C |  MK_ADR_STR :                   90B C |
 MK_BITR :                     0D5B C |  MK_BITR_STR :                 0D73 C |
 MK_E1 :                       20C6 C |  MK_E11 :                      20E5 C |
 MK_E2 :                       2150 C | *MK_E3 :                       1AFE C |
 MK_KIXPNK :                   0E4F C |  MK_KIXYPNK :                  1056 C |
*MK_KIYPNK :                   0E53 C |  MK_KN4K :                     10B0 C |
 MK_KRK :                      1144 C |  MK_KRKCS :                    114C C |
 MK_KRK_1 :                    1141 C |  MK_N2CRLF :                   1095 C |
 MK_N4CRLF :                   109B C |  MK_RCS :                      115D C |
 MK_RESR :                     0D64 C |  MK_RLCR :                     0D1C C |
 MK_RLR :                      0D2E C |  MK_RRCR :                     0D25 C |
 MK_RRR :                      0D37 C |  MK_SLAR :                     0D40 C |
 MK_SRAR :                     0D49 C |  MK_SRLR :                     0D52 C |
 MK_STR :                      1080 C | *MOMCPU :                        80 - |
*MOMCPUNAME :                 "Z80" - |  MSECB :                      0EF3D C |
 MUL_10 :                       2EC C |  MUL_8 :                       2A48 C |
 M_NUM :                          5 - |  NEGSTR :                      12D8 C |
*NESTMAX :                      100 - |  NEXT_ASM :                    1A1F C |
 NEXT_BC1 :                     500 C |  NEXT_BC10 :                    5DA C |
 NEXT_BC11 :                    5E7 C |  NEXT_BC111 :                   5FC C |
 NEXT_BC2 :                     523 C |  NEXT_BC21 :                    531 C |
 NEXT_BC22 :                    54C C | *NEXT_BC221 :                   54A C |
 NEXT_BC222 :                   544 C |  NEXT_BC3 :                     564 C |
 NEXT_BC4 :                     579 C |  NEXT_BC5 :                     590 C |
 NEXT_BC6 :                     587 C |  NEXT_BC7 :                     5A4 C |
 NEXT_BC8 :                     5B3 C |  NEXT_BC9 :                     5C6 C |
 NEXT_CHAR :                   25E9 C |  NOPSTR :                      1283 C |
 NO_API :                      2758 C |  NO_CR :                          1 - |
 NO_LF :                          2 - |  NO_NUM :                      257B C |
*NO_OPERATE :                  2757 C |  NO_RAM_AREA :                  67A C |
 NO_RST38_MSG :                2860 C |  NO_UPPER :                       4 - |
 NUMLEN :                         7 - |  NUMPLUS :                     1070 C |
 NUM_STRING :                 0EFB0 C |  NXCHR :                       25F3 C |
 NXT_A1 :                      24D1 C |  NXT_A2 :                      24AD C |
 NXT_A21 :                     24B4 C |  NXT_A22 :                     24B9 C |
 NXT_A3 :                      24BC C |  NXT_A31 :                     24C3 C |
 NXT_A4 :                      24CC C |  NXT_SR :                      23F7 C |
 N_END :                       252E C | *OKRAM :                       21D1 C |
 OK_MATCH :                    2529 C |  ONLY_NUM :                    24F3 C |
 OPC_CD :                     0EF6A C |  OPERAND_CDS :                 198C C |
 OPE_CDS :                     186F C |  OPNMSG :                      2C3D C |
 OPR1_CD :                    0EF6B C |  OPR2_CD :                    0EF6C C |
 OPR_CD1 :                     19EC C |  OPR_NUM25 :                  0EF6D C |
 OPR_NUM33 :                  0EF74 C |  OPR_NUM34 :                  0EF72 C |
 OPR_NUM35 :                  0EF6F C |  OPR_NUM36 :                  0EF73 C |
 OPR_NUM37 :                  0EF71 C |  OP_ERR :                      0D6D C |
 ORSTR :                       1265 C |  OTDRSTR :                     132C C |
 OTH_1OP_E :                   1196 C |  OTH_1OP_S :                   1189 C |
 OTH_1OP_TBL :                 1398 C |  OTIRSTR :                     1318 C |
 OUTDSTR :                     1304 C |  OUTISTR :                     12F3 C |
 OUTSTR :                      12AF C | *PADDING :                        1 - |
 PATB_CST :                    4C00 - | *PATB_TOP :                    4C00 - |
 PATB_WST :                    4C03 - |  PCST1 :                       2EE6 C |
 POPSTR :                      1273 C |  POP_PUSHRP :                  1390 C |
 POP_RP_E :                    11B6 C |  POP_RP_S :                    11B2 C |
 PP_BASE :                     237F C |  PP_IXIY :                        2 - |
 PP_IXY :                      237D C |  PP_NO :                          6 - |
 PP_TBL :                      2379 C |  PP_TBLE :                     237F C |
 PROMPT :                      2C7A C |  PRTDMP :                      1AD4 C |
 PUSHSTR :                     1277 C |  PUSH_RP_E :                   11BA C |
 PUSH_RP_S :                   11B6 C |  RAM12K :                         1 - |
 RAM8K :                          0 - |  RAM_B :                      0C000 - |
 RAM_E :                      0EFFF - |  RAM_SIZ :                     3000 - |
 RD0 :                         17E6 C |  RD1 :                         181E C |
 RD10 :                        180C C |  RD101 :                       1802 C |
 RD20 :                        182B C |  RDHEX :                       26FC C |
 RDSA :                        2D19 C |  RDSAX :                       2D3E C |
 RDSBC :                       2D1D C |  RDSBCX :                      2D44 C |
 RDSDE :                       2D23 C |  RDSDEX :                      2D4A C |
 RDSF :                        2D2F C |  RDSFX :                       2D56 C |
 RDSFX_H :                       2D - |  RDSFX_L :                       56 - |
 RDSF_H :                        2D - |  RDSF_L :                        2F - |
 RDSHL :                       2D29 C |  RDSHLX :                      2D50 C |
 RDSI :                        2D65 C |  RDSIX :                       2D34 C |
 RDSIY :                       2D39 C |  RDSPC :                       2D60 C |
 RDSR :                        2D69 C |  RDSSP :                       2D5B C |
 RDTAB :                       2CC4 C |  RDUMP :                       17E3 C |
 RD_SEC :                      2944 C |  RECORR :                      25E1 C |
 RECORR1 :                     25E3 C |  RECORRECT :                   25BC C |
 RECTYP :                     0EF1A C |  REG :                         175D C |
 REGAF :                      0EF1C C |  REGAFX :                     0EF24 C |
 REGBC :                      0EF1E C |  REGBCX :                     0EF26 C |
 REGDE :                      0EF20 C |  REGDEX :                     0EF28 C |
 REGHL :                      0EF22 C |  REGHLX :                     0EF2A C |
 REGI :                       0EF34 C |  REGIX :                      0EF2C C |
 REGIY :                      0EF2E C |  REGPC :                      0EF32 C |
 REGR :                       0EF35 C |  REGSP :                      0EF30 C |
 REG_B :                      0EF1C C |  REG_E :                      0EF36 C |
 REG_XY :                     0EF88 C | *RELAXED :                        0 - |
 REL_ADR_C :                    618 C |  REPEAT_TRACE :                28AF C |
 RESSTR :                      12D4 C |  RES_MCB :                     1B5B C |
 RES_XYT :                     1B63 C |  RETCC_TBLE :                   684 C |
 RETCC_TBLS :                   67C C |  RETISTR :                     1331 C |
 RETNSTR :                     1336 C |  RETSTR :                      122D C |
 RET_CD :                      226A C |  RET_NO :                      2262 C |
 RG0 :                         176A C |  RG1 :                         176E C |
 RG2 :                         177E C |  RG3 :                         178D C |
 RG4 :                         17B2 C |  RG5 :                         17BE C |
 RG6 :                         17DA C |  RG7 :                         17DD C |
 RGE :                         17E0 C |  RGR :                         17DD C |
 RH0 :                         2701 C |  RH1 :                         2714 C |
 RHE :                         2732 C |  RHE1 :                        273C C |
 RHLNNXY :                       0D - |  RLASTR :                      1291 C |
 RLCASTR :                     1287 C |  RLCSTR :                      12B6 C |
 RLC_OR :                         0 - |  RLDSTR :                      12E3 C |
 RLSTR :                       12BE C |  RL_OR :                         10 - |
 RNA :                         2E87 C |  RNAF :                        1226 C |
 RNAFX :                       1229 C |  RNAX :                        2EA0 C |
 RNB :                         2E8C C |  RNBC :                        2E89 C |
 RNBCX :                       2EA3 C |  RNBX :                        2EA7 C |
 RNC :                         2E8E C |  RNCX :                        2EAA C |
 RND :                         2E93 C |  RNDE :                        2E90 C |
 RNDEX :                       2EAD C |  RNDX :                        2EB1 C |
 RNE :                         2E95 C |  RNEX :                        2EB4 C |
 RNF :                         2E9E C |  RNFX :                        2EC1 C |
 RNH :                         2E9A C |  RNHL :                        2E97 C |
 RNHLX :                       2EB7 C |  RNHX :                        2EBB C |
 RNI :                         2ED0 C |  RNIX :                        2EC4 C |
 RNIY :                        2EC7 C |  RNL :                         2E9C C |
 RNLX :                        2EBE C |  RNPC :                        2ECD C |
 RNR :                         2ED2 C |  RNSP :                        2ECA C |
 RNTAB :                       2D6D C |  RNTABA :                      2DB7 C |
 RNTABB :                      2DC5 C |  RNTABBC :                     2DD9 C |
 RNTABC :                      2DE7 C |  RNTABD :                      2DF5 C |
 RNTABDE :                     2E09 C |  RNTABE :                      2E17 C |
 RNTABF :                      2E25 C |  RNTABH :                      2E33 C |
 RNTABHL :                     2E47 C |  RNTABI :                      2E63 C |
 RNTABL :                      2E55 C |  RNTABP :                      2E77 C |
 RNTABS :                      2E7F C |  ROM_B :                          0 - |
 RRASTR :                      1295 C |  RRCASTR :                     128C C |
 RRCSTR :                      12BA C |  RRC_OR :                         8 - |
 RRDSTR :                      12DF C |  RRSTR :                       12C1 C |
 RR_OR :                         18 - |  RST08H :                        43 C |
 RST10H :                        4B C |  RST18H :                        53 C |
 RST20H :                        5B C |  RST20H_IN :                     7D C |
*RST28H :                        63 C |  RST28H_IN :                     7D C |
 RST30H :                        6B C |  RST30H_IN :                   273E C |
 RST38H :                        73 C |  RST38H_IN :                   27CB C |
 RST38MSG :                    28E4 C |  RSTR_BPT :                    28C4 C |
 RSTR_TPT :                    28B8 C |  RSTSTR :                      1241 C |
 RST_CD :                      2246 C |  RST_NO :                      223E C |
 RST_TBLE :                     6A1 C |  RST_TBLS :                     699 C |
 R_HL_NN :                     1E15 C |  R_HL_NNE :                    1E22 C |
 SADDR :                      0EF17 C |  SAVEH :                       1685 C |
 SAVE_HL :                    0EF0E C |  SBCSTR :                      1259 C |
 SCFSTR :                      12A1 C |  SCH_NEXT :                    2517 C |
 SCH_OPECODE :                 2508 C |  SCH_OPERAND1 :                24FE C |
 SCH_OPERAND1_1 :              2503 C |  SECB :                       0EF3B C |
 SETBPADR :                     35E C |  SETBYTEC :                    1AE3 C |
 SETDSADR :                    1AD9 C |  SETM :                        150D C |
 SETSTR :                      133B C |  SET_BITNO :                   0D85 C |
 SET_BP :                      1501 C |  SET_BP1 :                      33C C |
 SET_MCB :                     1B3D C |  SET_TM :                       423 C |
 SET_XYT :                     1B45 C |  SH0 :                         168F C |
 SH1 :                         1693 C |  SH2 :                         16BB C |
 SH3 :                         16C3 C |  SH4 :                         16DA C |
 SHE :                         16B8 C |  SHEMSG :                      2C8A C |
 SHL0 :                        16EE C |  SHL00 :                       16E3 C |
 SHLI0 :                       1717 C |  SHLS :                        172B C |
 SHLS0 :                       174A C |  SH_0 :                        250E C |
 SH_1 :                        250F C | *SIZE :                       0EF1B C |
 SKIPSP :                      26EC C |  SKIP_CR :                     26DB C |
 SKIP_LF :                     26E4 C |  SKIP_NEXT :                   251B C |
 SKIP_UPPER :                  26B2 C |  SKPA_ADR :                    1A19 C |
 SKP_OUTM :                    1ABC C |  SKP_RMSG :                    2882 C |
 SKP_SP :                      256C C |  SKP_TBP :                     14C4 C |
 SLASTR :                      12C4 C |  SLA_OR :                        20 - |
 SM0 :                         1527 C |  SM1 :                         1528 C |
 SM2 :                         154E C |  SM3 :                         1559 C |
 SM4 :                         1564 C |  SMEZ80FULL :                     0 - |
 SRASTR :                      12C8 C |  SRA_OR :                        28 - |
 SRECER :                      2CB7 C |  SRLSTR :                      12CC C |
 SRL_OR :                        38 - |  SR_BASE :                     23B5 C |
 SR_IY1 :                      240B C |  SR_LOOKFOR :                  23DE C |
 SR_NUM :                         8 - |  STACK :                      0EEC0 - |
 STACKM :                     0EF00 - | *START :                          0 C |
 START_TIM :                   2914 C |  STEALRST08 :                 0EF00 C |
 STEALRST10 :                 0EF02 C |  STEALRST18 :                 0EF04 C |
 STEALRST20 :                 0EF06 C |  STEALRST28 :                 0EF08 C |
 STEALRST30 :                 0EF0A C |  STEALRST38 :                 0EF0C C |
 STOPW :                       2900 C |  STOP_TIM :                    291D C |
 STPBRK_MSG :                  28EE C |  STP_CHK :                      4AC C |
 STROUT :                      2602 C |  ST_COPY :                     1165 C |
 ST_MC1 :                      20D7 C |  ST_MC11 :                     20D9 C |
 ST_MUL8 :                     2A51 C |  SUBSTR :                      1255 C |
 SUPERMEZ80 :                     0 - |  SV_1STADDR :                  1622 C |
 SV_NNKR :                     106A C |  SX_ERR :                      247D C |
 TADR_CHK :                     49B C |  TASM_ADR :                   0EF66 C |
 TC_CNT :                     0EF4B C |  TERR_MSG :                     60E C |
 THREE_OPTBL :                  74C C |  THREE_OPTBLE :                 750 C |
 THREE_OPTBL_E :                754 C |  TIM0_CTL0 :                  0F800 - |
*TIM0_CTL1 :                  0F801 - | *TIME :                   "2:46:31" - |
 TIMER0_CNTH :                0F811 - |  TIMER0_CNTL :                0F810 - |
 TIMER0_INITC :                87E1 - |  TIMER0_SCTH :                0F821 - |
 TIMER0_SCTL :                0F820 - |  TMPB_ADR :                   0EF62 C |
 TMPB_F :                     0EF60 C |  TMPB_OP :                    0EF61 C |
 TMPT :                       0EF4D C |  TM_MODE :                    0EF4A C |
 TM_MSG_0 :                     434 C |  TM_MSG_I :                     443 C |
 TM_MSG_S :                     449 C |  TPT1_ADR :                   0EF52 C |
 TPT1_F :                     0EF50 C |  TPT1_OP :                    0EF51 C |
 TPT2_ADR :                   0EF56 C |  TPT2_F :                     0EF54 C |
 TPT2_OP :                    0EF55 C |  TP_CHK1 :                     283B C |
 TP_CHK2 :                     284A C |  TP_CMD :                       451 C |
 TP_MD_ON :                     475 C |  TP_MODE :                    0EF49 C |
 TP_MSG_0 :                     486 C |  TP_MSG_OFF :                   495 C |
 TP_MSG_ON :                    490 C |  TP_N1 :                        45D C |
 TP_N2 :                        466 C |  TRACE_CMD :                    3D5 C |
 TRACE_MSG :                   28F7 C | *TRUE :                           1 - |
 TWO_OPTBL :                    73A C |  TWO_OPTBL_E :                  74C C |
 T_NO_KY :                     289A C |  T_OP1 :                        4C4 C |
 T_OP11 :                       4BE C |  T_OP_CHK :                     4DF C |
 UARTCR :                     0FF01 - |  UARTDR :                     0FF00 - |
 UPPER :                       26F3 C |  UP_BI :                        2EA C |
 U_0 :                         298D C |  U_00 :                        2987 C |
 U_1 :                         2991 C | *VERSION :                     142F - |
 VTL_CST :                     7500 - |  VTL_WST :                     7503 - |
 WORK_B :                     0EF00 - |  WSTART :                       12C C |
 WS_CHK1 :                     2796 C |  WS_CHK2 :                     27A2 C |
 WS_CHK3 :                     27AE C |  WS_CHK4 :                     27BA C |
 WS_CHK5 :                     27C6 C |  XORSTR :                      1261 C |
 XY_SRTP :                    0EF8A C |

   1196 symbols
     44 unused symbols

 AS V1.42 Beta [Bld 246] - Source File emuz80mon_RevB05.asm - Page 3 - 9/2/2023 2:46:31


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.11 seconds assembly time

   8715 lines source file
      2 passes
      0 errors
      0 warnings
